1542545075124:most.freq
1542545092587:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup() %>%  mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545092587:most.freq
1542545092617:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup()  %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545092632:leastfreq
1542545099397:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup() %>%  mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545099713:most.freq
1542545099724:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup()  %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545099737:leastfreq
1542545099745:rbind(most.freq, leastfreq) %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))# %>% select(service_id, Service, Classification, Freq, Route, Route.name) #%>% arrange(., service_id, Freq)
1542545137560:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup() %>%  mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545137560:most.freq
1542545137575:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup()  %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545137771:leastfreq
1542545137778:rbind(most.freq, leastfreq)# %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))# %>% select(service_id, Service, Classification, Freq, Route, Route.name) #%>% arrange(., service_id, Freq)
1542545193585:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup()# %>%  mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545193585:most.freq
1542545193600:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup()  #%>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545193775:leastfreq
1542545193784:rbind(most.freq, leastfreq) %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))# %>% select(service_id, Service, Classification, Freq, Route, Route.name) #%>% arrange(., service_id, Freq)
1542545228731:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') #%>% select(Classification, Route=route_short_name, Route.name=route_long_name, service_id, Freq) %>% ungroup()
1542545228746:leastfreq
1542545323904:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542545323904:most.freq
1542545324090:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542545324099:leastfreq
1542545324106:freq <- rbind(most.freq, leastfreq) %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(service_id, Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., service_id, Freq)
1542545324119:freq
1542545353035:bus.freq %>% summarise(Freq=mean(Freq))
1542545364762:bus.freq %>% summarise(Freq=mean(Freq))[1]
1542545370328:bus.freq %>% summarise(Freq=mean(Freq))
1542545388042:bus.freq %>% summarise(Freq=mean(Freq))[1,1]
1542545623834:#common join that used at multiple points in the code
1542545623843:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by="trip_id") %>% left_join(., stops.df, by='stop_id')
1542545624228:#calculating the unit of distance in the dataset
1542545624231:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542545624279:#calculating the route lengths
1542545624285:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542545624537:# base df that most and least frequent routes and mean length is based on
1542545624537:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, service_id, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, service_id, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, service_id, Freq) %>% group_by(service_id)
1542545624823:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542545624929:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542545625051:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542545625051:extreme.freq <- rbind(most.freq, leastfreq) %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(service_id, Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., service_id, Freq)
1542545631979:freq.mean
1542545656878:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))%>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542545658763:freq.mean
1542545669676:freq.mean[1]
1542545673443:freq.mean[,1]
1542545680333:freq.mean[[1]]
1542545688046:freq.mean[[,1]]
1542545748351:slice(freq.mean,1)
1542545752080:slice(freq.mean,2)
1542545755941:slice(freq.mean,2)[1]
1542545758324:slice(freq.mean,2)[2]
1542545765277:slice(freq.mean,2)$Service
1542545798083:freq.mean
1542545806892:slice(freq.mean,1)$Service
1542545836154:freq.mean
1542545980612:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542545980627:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542545980643:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542545980658:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542545980680:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542545980687:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542545980689:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542545980691:bottom = (min(stops.df$stop_lat) - 0.01),
1542545980693:right = (max(stops.df$stop_lon) + 0.01),
1542545980695:top = (max(stops.df$stop_lat) + 0.01))
1542545980699:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = "toner-lite")
1542545981478:ggmap(dublin_stamen, legend = "right") + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x="Longitude", y="Latitude")
1542546052736:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542546057805:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542546062302:lat.long.combo
1542546319562:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542546319562:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542546319692:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542546319705:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat)
1542546319722:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542546319727:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542546319729:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542546319732:bottom = (min(stops.df$stop_lat) - 0.01),
1542546319734:right = (max(stops.df$stop_lon) + 0.01),
1542546319736:top = (max(stops.df$stop_lat) + 0.01))
1542546319740:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = "toner-lite")
1542546320557:ggmap(dublin_stamen, legend = "right") + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x="Longitude", y="Latitude")
1542546385097:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542546385108:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542546385122:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542546385137:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat)
1542546385154:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542546385160:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542546385161:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542546385164:bottom = (min(stops.df$stop_lat) - 0.01),
1542546385166:right = (max(stops.df$stop_lon) + 0.01),
1542546385219:top = (max(stops.df$stop_lat) + 0.01))
1542546385227:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = "toner-lite")
1542546386132:ggmap(dublin_stamen, legend = "right") + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x="Longitude", y="Latitude")
1542547178637:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542547178640:options(digits=2)
1542547178803:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542547178815:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542547178829:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542547178845:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat)
1542547178863:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542547178868:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542547178870:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542547178872:bottom = (min(stops.df$stop_lat) - 0.01),
1542547178874:right = (max(stops.df$stop_lon) + 0.01),
1542547178876:top = (max(stops.df$stop_lat) + 0.01))
1542547178880:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = "toner-lite")
1542547179918:ggmap(dublin_stamen, legend = "right") + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x="Longitude", y="Latitude")
1542547194112:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542547194123:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542547194137:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542547194152:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat)
1542547194170:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542547194175:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542547194177:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542547194179:bottom = (min(stops.df$stop_lat) - 0.01),
1542547194181:right = (max(stops.df$stop_lon) + 0.01),
1542547194183:top = (max(stops.df$stop_lat) + 0.01))
1542547194188:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = "toner-lite")
1542547195007:ggmap(dublin_stamen, legend = "right") + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x="Longitude", y="Latitude")
1542547204551:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542547204563:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542547204578:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542547204594:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat)
1542547204612:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542547204616:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542547204618:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542547204621:bottom = (min(stops.df$stop_lat) - 0.01),
1542547204623:right = (max(stops.df$stop_lon) + 0.01),
1542547204626:top = (max(stops.df$stop_lat) + 0.01))
1542547204630:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = "toner-lite")
1542547205421:ggmap(dublin_stamen, legend = "right") + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x="Longitude", y="Latitude")
1542547224648:kable(extreme.freq)
1542547256257:bus.join
1542547389708:count(left_join(trips.df, routes.df, by = 'route_id'), route_short_name, route_long_name, sort = TRUE)
1542547397557:bus.join
1542547397676:count(left_join(trips.df, routes.df, by = 'route_id'), route_short_name, route_long_name, sort = TRUE)
1542547455643:bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542547468619:bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542547468742:count(left_join(trips.df, routes.df, by = 'route_id'), route_short_name, route_long_name, sort = TRUE)
1542549980552:count(left_join(trips.df, routes.df, by = 'route_id'), service_id route_short_name, route_long_name, sort = TRUE)
1542549987738:count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, route_long_name, sort = TRUE)
1542550024055:hist(count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, route_long_name, sort = TRUE))
1542550032533:count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, route_long_name, sort = TRUE)
1542550044194:count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542550063185:c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542550063198:c
1542550128568:hist(select(c, route_shot_name, n))
1542550132802:hist(select(c, route_short_name, n))
1542550149120:cs <- select(c, route_short_name, n)
1542550152690:cs
1542550162988:hist(cs
1542550166479:hist(cs)
1542550222924:qplot(csE, geom="histogram")
1542550228189:qplot(cs, geom="histogram")
1542550256522:qplot(cs)
1542550279654:left_join(trips.df, routes.df, by = 'route_id')
1542550311838:left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, route_id)
1542550322578:left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, route_id) %>% distinct()
1542550339600:left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, route_id) %>% distinct() %>% arrange(route_short_name)
1542550354550:left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, trip_id) %>% distinct() %>% arrange(route_short_name)
1542550365179:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, trip_id) %>% distinct() %>% arrange(route_short_name)
1542550368640:qplot(cv)
1542550393345:qplot(cv$route_short_name)
1542550746538:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, trip_id) %>% distinct()
1542550748549:qplot(cv$route_short_name)
1542550778487:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, trip_id) %>% distinct()
1542550778497:#bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542550778500:#c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542550778502:#cs <- select(c, route_short_name, n)
1542550778504:#cs
1542550778608:qplot(cv$route_short_name)
1542550872151:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, trip_id) %>% distinct()
1542550872165:#bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542550872167:#c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542550872170:#cs <- select(c, route_short_name, n)
1542550872173:#cs
1542550872175:ggplot(data=cv, aes(cv$route_short_name)) + geom_histogram()
1542550918052:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, trip_id) %>% distinct()
1542550918062:#bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542550918065:#c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542550918067:#cs <- select(c, route_short_name, n)
1542550918070:#cs
1542550918073:qplot(cv$route_short_name, geom="histogram")
1542550948553:qplot(cv$route_short_name)
1542550957469:ggplot(data=cv, aes(cv$route_short_name))
1542550978666:ggplot(data=cv, aes(cv$route_short_name)) + geom_histogram()
1542550988242:ggplot(data=cv, aes(cv$route_short_name)) + geom_histogram(stat="count")
1542551067987:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% select(route_short_name, trip_id, service_id) %>% distinct()
1542551067998:#bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542551068000:#c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542551068003:#cs <- select(c, route_short_name, n)
1542551068005:cs
1542551068014:#qplot(cv$route_short_name)
1542551068017:#qplot(cv$route_short_name, geom="histogram")
1542551068020:ggplot(data=cv, aes(cv$route_short_name, colour=service_id)) + geom_histogram(stat="count")
1542551132083:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% distinct()
1542551132107:#bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542551132110:#c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542551132112:#cs <- select(c, route_short_name, n)
1542551132115:cs
1542551132124:#qplot(cv$route_short_name)
1542551132127:#qplot(cv$route_short_name, geom="histogram")
1542551132129:ggplot(data=cv, aes(cv$route_short_name, colour=Service)) + geom_histogram(stat="count")
1542551153615:#qplot(cv$route_short_name, geom="histogram")
1542551153617:ggplot(data=cv, aes(cv$route_short_name, colour=Service)) + geom_histogram(stat="count" colour=Service)
1542551166149:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% distinct()
1542551166163:#bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542551166316:#c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542551166319:#cs <- select(c, route_short_name, n)
1542551166321:cs
1542551166330:#qplot(cv$route_short_name)
1542551166333:#qplot(cv$route_short_name, geom="histogram")
1542551166336:ggplot(data=cv, aes(cv$route_short_name, colour=Service)) + geom_histogram(stat="count", colour=Service)
1542551178179:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% distinct()
1542551178197:#bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542551178200:#c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542551178202:#cs <- select(c, route_short_name, n)
1542551178205:cs
1542551178215:#qplot(cv$route_short_name)
1542551178218:#qplot(cv$route_short_name, geom="histogram")
1542551178220:ggplot(data=cv, aes(cv$route_short_name, colour=Service)) + geom_histogram(stat="count")
1542551301036:#qplot(cv$route_short_name, geom="histogram")
1542551301038:ggplot(data=cv, aes(cv$route_short_name)) + facet_grid(Service) + geom_histogram(stat="count")
1542551310342:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% distinct()
1542551310345:#bus.join %>% group_by(service_id) %>% count(., route_short_name, route_long_name, sort = TRUE)
1542551310345:#c <- count(left_join(trips.df, routes.df, by = 'route_id'), service_id, route_short_name, sort = TRUE)
1542551310361:#cs <- select(c, route_short_name, n)
1542551310363:cs
1542551310372:#qplot(cv$route_short_name)
1542551310375:#qplot(cv$route_short_name, geom="histogram")
1542551310378:ggplot(data=cv, aes(cv$route_short_name)) + facet_grid(Service) + geom_histogram(stat="count")
1542551341035:#qplot(cv$route_short_name, geom="histogram")
1542551341037:ggplot(data=cv, aes(cv$route_short_name)) + facet_grid(rows=vars(Service)) + geom_histogram(stat="count")
1542551536644:#qplot(cv$route_short_name, geom="histogram")
1542551536644:ggplot(data=cv, aes(cv$route_short_name, ct_infreq(factor(route_short_name)))) + facet_grid(rows=vars(Service)) + geom_histogram(stat="count")
1542551634890:#qplot(cv$route_short_name, geom="histogram")
1542551634892:ggplot(data=cv, aes(reorder(cv$route_short_name))) + facet_grid(rows=vars(Service)) + geom_histogram(stat="count")
1542551642118:#qplot(cv$route_short_name, geom="histogram")
1542551642120:ggplot(data=cv, aes(cv$route_short_name)) + facet_grid(rows=vars(Service)) + geom_histogram(stat="count")
1542551652400:#qplot(cv$route_short_name, geom="histogram")
1542551652402:ggplot(data=cv, aes(reorder(cv$route_short_name, count))) + facet_grid(rows=vars(Service)) + geom_histogram(stat="count")
1542551680207:cv
1542551710549:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542551711841:cv
1542551745870:#qplot(cv$route_short_name)
1542551745872:#qplot(cv$route_short_name, geom="histogram")
1542551745874:ggplot(data=cv, aes(x=reorder(cv$route_short_name, n), y=n)) + facet_grid(rows=vars(Service)) + geom_histogram(stat="count")
1542551755491:#qplot(cv$route_short_name)
1542551755493:#qplot(cv$route_short_name, geom="histogram")
1542551755495:ggplot(data=cv, aes(x=reorder(cv$route_short_name, n), y=n)) + facet_grid(rows=vars(Service)) + geom_histogram()
1542551779455:#qplot(cv$route_short_name)
1542551779457:#qplot(cv$route_short_name, geom="histogram")
1542551779562:ggplot(data=cv, aes(x=reorder(route_short_name, n), y=n)) + facet_grid(rows=vars(Service)) + geom_histogram()
1542551800385:#qplot(cv$route_short_name)
1542551800387:#qplot(cv$route_short_name, geom="histogram")
1542551800389:ggplot(data=cv, aes(x=reorder(route_short_name, n), y=n)) + facet_grid(rows=vars(Service)) + geom_histogram(stat = "identity")
1542551810676:#qplot(cv$route_short_name)
1542551810678:#qplot(cv$route_short_name, geom="histogram")
1542551810680:ggplot(data=cv, aes(x=reorder(route_short_name, n), y=-n)) + facet_grid(rows=vars(Service)) + geom_histogram(stat = "identity")
1542551830304:#qplot(cv$route_short_name)
1542551830312:#qplot(cv$route_short_name, geom="histogram")
1542551830317:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service)) + geom_histogram(stat = "identity")
1542551906054:#qplot(cv$route_short_name)
1542551906054:#qplot(cv$route_short_name, geom="histogram")
1542551906058:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service)) + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542551987915:#qplot(cv$route_short_name)
1542551987982:#qplot(cv$route_short_name, geom="histogram")
1542551987984:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service)) + facet_grid(.~size_f) + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552004825:#qplot(cv$route_short_name)
1542552004827:#qplot(cv$route_short_name, geom="histogram")
1542552004829:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), .~size_f) + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552068581:#qplot(cv$route_short_name)
1542552068588:#qplot(cv$route_short_name, geom="histogram")
1542552068590:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service)) + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552078534:#qplot(cv$route_short_name)
1542552078537:#qplot(cv$route_short_name, geom="histogram")
1542552078641:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service)) + facet_grid( ~ fct_rev(group), scale = "free") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552084244:#qplot(cv$route_short_name)
1542552084246:#qplot(cv$route_short_name, geom="histogram")
1542552084348:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service)) + facet_grid( ~ fct_rev(Service), scale = "free") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552118065:?facet_grid
1542552154691:#qplot(cv$route_short_name)
1542552154694:#qplot(cv$route_short_name, geom="histogram")
1542552154696:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), ~ fct_rev(Service), , scale = "free") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552188383:#qplot(cv$route_short_name)
1542552188383:#qplot(cv$route_short_name, geom="histogram")
1542552188386:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), ~ fct_rev(Service), scale = "free") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552192760:#qplot(cv$route_short_name)
1542552192762:#qplot(cv$route_short_name, geom="histogram")
1542552192764:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), fct_rev(Service), scale = "free") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552207609:fct_rev(Service),
1542552212270:fct_rev(Service),
1542552218678:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552292630:?fct_rev
1542552325578:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(~ fct_rev(Service), rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552449407:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
1542552460035:?ggplot
1542552550256:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Routes", y = "Number of Trips")
1542552657740:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity", fill="#FF9999", colour="black") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Routes", y = "Number of Trips")
1542552688523:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity", fill="#violetred1", colour="black") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Routes", y = "Number of Trips")
1542552698083:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity", fill="violetred1", colour="black") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Routes", y = "Number of Trips")
1542552721804:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity", fill="darkorcid3", colour="black") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Routes", y = "Number of Trips")
1542552731284:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = "fixed") + geom_histogram(stat = "identity", fill="darkorchid3", colour="black") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Routes", y = "Number of Trips")
1542552857638:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542552887647:kable(head(count(left_join(trips.df, routes.df, by = 'route_id'), route_short_name, route_long_name, sort = TRUE), 10))
1542552977835:cv <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542552977851:ggplot(data=cv, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542553006897:route.num.trip <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542553006914:ggplot(data=route.num.trip, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542553192528:bus.freq
1542553196927:bus.freq
1542553210112:bus.join
1542553279585:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) #%>% group_by()
1542553853228:kable(extreme.freq)
1542553920883:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>%  filter(arrival_time == min(arrival_time))
1542553926907:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service)# %>%  filter(arrival_time == min(arrival_time))
1542553937226:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>%  filter(.,arrival_time == min(arrival_time))
1542553949211:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>%  summarise(min(arrival_time))
1542553976942:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% na.omit() %>% group_by(Service) %>% summarise(min(arrival_time))
1542553981815:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% na.omit() %>% group_by(Service)# %>% summarise(min(arrival_time))
1542554001382:?na.omit
1542554014064:?summarise
1542554149943:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% %>% group_by(Service) %>% summarise(min(arrival_time, na.rm=TRUE))
1542554155892:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>% summarise(min(arrival_time, na.rm=TRUE))
1542554184089:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE)) #%>% summarise(min(arrival_time, na.rm=TRUE))
1542554212617:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) || arrival_time==max(arrival_time, na.rm=TRUE)) #%>% summarise(min(arrival_time, na.rm=TRUE))
1542554217079:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) #%>% summarise(min(arrival_time, na.rm=TRUE))
1542554237490:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, arrival_time)
1542554259407:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542554468360:bus.join %>% filter(route_short_name == 41)
1542554533997:bus.join %>% filter(route_short_name == 41) %>% select(route_short_name, service_id, arrival_time, departure_time)
1542554546390:bus.join %>% filter(route_short_name == 41) %>% select(route_short_name, service_id, arrival_time, departure_time) %>% distinct()
1542554592119:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542554656858:bus.join %>% filter(route_short_name == 41) %>% select(route_short_name, service_id, arrival_time, departure_time) %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% distinct()
1542554721171:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% select(route_short_name, service_id, arrival_time, departure_time)  %>% distinct()
1542554730465:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% select(Service, route_short_name, service_id, arrival_time, departure_time)  %>% distinct()
1542554766981:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% select(Service, route_short_name, service_id, arrival_time, departure_time)  %>% distinct() %>% arrange(arrival_time)
1542554787571:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41) %>% select(Service, route_short_name, service_id, arrival_time, departure_time)  %>% distinct() %>% arrange(arrival_time)
1542554926744:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542554945987:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% group_by(Service)
1542554975904:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542555049205:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% mutate(actual.time=case_when(arrival_time<4) ~ arrival_time+24)
1542555103802:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% mutate(actual.time=case_when(arrival_time < 4 ~ arrival_time+24))
1542555128394:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% mutate(actual.time=case_when(arrival_time < 4 ~ arrival_time+24))  %>% filter(route_short_name == 41)
1542555161425:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% mutate(actual.time=case_when(arrival_time < 4 ~ arrival_time+24))  %>% filter(route_short_name == 41, Service=='Sunday/Bank Holiday')
1542555198111:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% mutate(actual.time=case_when(arrival_time < 4 ~ arrival_time+24))  %>% filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% arrange(arrival_time)
1542555319940:hms(seconds = 0, minutes = 0, hours = 4, days = NULL)
1542555329489:x <- hms(seconds = 0, minutes = 0, hours = 4, days = NULL)
1542555329639:x
1542555340822:x <- as.hms(seconds = 0, minutes = 0, hours = 4, days = NULL)
1542555356921:library(hms)
1542555361984:x <- as.hms(seconds = 0, minutes = 0, hours = 4, days = NULL)
1542555402867:as.hms(04:00:00)
1542555411215:as.hms('04:00:00')
1542555420779:typeof(as.hms('04:00:00'))
1542555435092:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% mutate(actual.time=case_when(arrival_time < as.hms('04:00:00') ~ arrival_time+24))  %>% filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% arrange(arrival_time)
1542555452071:bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% mutate(actual.time=case_when(arrival_time < as.hms('04:00:00') ~ arrival_time+as.hms('24:00:00')))  %>% filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% arrange(arrival_time)
1542555763577:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542555763592:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542555763624:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542555763655:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat)
1542555763686:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542555763707:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542555763709:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542555763712:bottom = (min(stops.df$stop_lat) - 0.01),
1542555763714:right = (max(stops.df$stop_lon) + 0.01),
1542555763717:top = (max(stops.df$stop_lat) + 0.01))
1542555763722:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542555765083:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542555775336:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542555775336:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542555775352:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542555775478:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat)
1542555775501:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542555775506:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542555775508:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542555775510:bottom = (min(stops.df$stop_lat) - 0.01),
1542555775512:right = (max(stops.df$stop_lon) + 0.01),
1542555775515:top = (max(stops.df$stop_lat) + 0.01))
1542555775519:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542555776255:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542555794432:routes.16 <- filter(routes.df, route_short_name == 16)
1542555794447:routes.16
1542556188277:bus.join
1542556219301:bus.join %>% filter(route_short_name==16)
1542556400652:#common join used at multiple points in the code
1542556400652:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542556401220:#calculating the unit of distance in the dataset
1542556401223:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542556401325:#calculating the route lengths
1542556401325:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542556401573:# base df that most and least frequent routes and mean length is based on
1542556401573:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, service_id, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, service_id, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, service_id, Freq) %>% group_by(service_id)
1542556401732:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542556401732:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542556401862:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542556401862:extreme.freq <- rbind(most.freq, leastfreq) %>% select(service_id, Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., service_id, Freq)
1542556480217:#common join used at multiple points in the code
1542556480217:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542556480641:#calculating the unit of distance in the dataset
1542556480643:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542556480695:#calculating the route lengths
1542556480698:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542556480984:# base df that most and least frequent routes and mean length is based on
1542556480984:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, Service, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, Service, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, Service, Freq) %>% group_by(Service)
1542556481201:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542556481217:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542556481217:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542556481353:extreme.freq <- rbind(most.freq, leastfreq) %>% select(Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., Service, Freq)
1542556537333:bus.join %>% filter(route_short_name==16)
1542556812948:bus.join
1542556886734:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_long)
1542556890847:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon)
1542556940050:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% left_join(bus.join, suffix = ('.16', '.all'))
1542556960784:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% left_join(bus.join, by='stop_id', suffix = ('.16', '.all'))
1542556978104:?left_join
1542556987619:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% left_join(bus.join, by='stop_id', suffix = c('.16', '.all'))
1542557114762:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon)
1542557125919:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557132349:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct() %>% left_join(bus.join, by='stop_id', suffix = c('.16', '.all'))
1542557170039:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557209855:bus.join %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557265763:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct() %>% left_join(bus.join %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()), by='stop_id', suffix = c('.16', '.all'))
1542557272735:bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct() %>% left_join(bus.join %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()), by='stop_id', suffix = c('.16', '.all')))
1542557316531:stops.61 <- bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557316578:stops.all <- bus.join %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557329566:stops.16 <- bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557329662:stops.all <- bus.join %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557329765:stops.16
1542557329765:stops.all
1542557360445:left_join(stops.16, stops.all, by='stop_id', suffix = c('.16', '.all')))
1542557368371:left_join(stops.16, stops.all, by='stop_id', suffix = c('.16', '.all'))
1542557426986:stops.crossover %>% select(route_short_name.all) %>% distinct()
1542557431770:stops.crossover <- left_join(stops.16, stops.all, by='stop_id', suffix = c('.16', '.all'))
1542557431783:stops.crossover %>% select(route_short_name.all) %>% distinct()
1542557467923:stops.16 <- bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557467959:stops.all <- bus.join %>% filter(Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557468105:stops.16
1542557468116:stops.all
1542557468143:stops.crossover <- left_join(stops.16, stops.all, by='stop_id', suffix = c('.16', '.all'))
1542557468155:stops.crossover %>% select(route_short_name.all) %>% distinct()
1542557517208:stops.crossover
1542557712995:stops.16 <- bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(route_short_name, stop_id, stop_lat, stop_lon) %>% distinct()
1542557713023:stops.16
1542557734639:stops.16 <- bus.join %>% filter(route_short_name==16, Service== 'Saturday') %>% select(stop_id) %>% distinct()
1542557734837:stops.16
1542557779927:inner_join(stops.16, bus.join, by='stop_id')
1542557822505:inner_join(stops.16, bus.join, by='stop_id') %>% select(route_short_name)
1542557830795:inner_join(stops.16, bus.join, by='stop_id') %>% select(route_short_name) %>% distinct()
1542557945908:inner_join(stops.16, bus.join, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join, by='route_short_name')
1542558006949:inner_join(stops.16, filter(bus.join, Service='Saturday'), by='stop_id') #%>% select(route_short_name) %>% distinct() %>% inner_join(bus.join, by='route_short_name') %>% select()
1542558012845:inner_join(stops.16, filter(bus.join, Service=='Saturday'), by='stop_id') #%>% select(route_short_name) %>% distinct() %>% inner_join(bus.join, by='route_short_name') %>% select()
1542558033770:inner_join(stops.16, filter(bus.join, Service=='Saturday'), by='stop_id') %>% select(route_short_name) %>% distinct() #%>% inner_join(bus.join, by='route_short_name') %>% select()
1542558050806:inner_join(stops.16, filter(bus.join, Service=='Saturday'), by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(filter(bus.join, Service=='Saturday'), by='route_short_name') #%>% select()
1542558088415:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542558088650:bus.join.sat
1542558129749:inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') #%>% select()
1542558165928:inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(stop.lon, stop.lat) %>% distinct()
1542558173857:inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') #%>% select(stop.lon, stop.lat) %>% distinct()
1542558191319:inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(stop_lon, stop_lat) %>% distinct()
1542558214136:stops.intersect.16 <- inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(stop_lon, stop_lat) %>% distinct()
1542558232098:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558232098:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542558232098:bottom = (min(stops.df$stop_lat) - 0.01),
1542558232098:right = (max(stops.df$stop_lon) + 0.01),
1542558232098:top = (max(stops.df$stop_lat) + 0.01))
1542558232114:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558232914:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.16, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558243711:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.16, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558284651:stops.intersect.16 <- inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558284708:stops.intersect.16
1542558291462:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.16, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558335175:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558335175:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542558335175:bottom = (min(stops.df$stop_lat) - 0.01),
1542558335175:right = (max(stops.df$stop_lon) + 0.01),
1542558335175:top = (max(stops.df$stop_lat) + 0.01))
1542558335190:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558335924:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.16, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558355217:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542558355217:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542558355298:bus.join.sat
1542558355416:stops.16 <- bus.join.sat %>% filter(route_short_name==9) %>% select(stop_id) %>% distinct()
1542558355437:stops.16
1542558355444:stops.intersect.16 <- inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558355506:stops.intersect.16
1542558360553:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558360553:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542558360553:bottom = (min(stops.df$stop_lat) - 0.01),
1542558360553:right = (max(stops.df$stop_lon) + 0.01),
1542558360553:top = (max(stops.df$stop_lat) + 0.01))
1542558360553:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558361354:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.16, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558374964:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542558374964:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542558375042:bus.join.sat
1542558375164:stops.16 <- bus.join.sat %>% filter(route_short_name==49) %>% select(stop_id) %>% distinct()
1542558375176:stops.16
1542558375186:stops.intersect.16 <- inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558375336:stops.intersect.16
1542558383554:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558383555:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542558383555:bottom = (min(stops.df$stop_lat) - 0.01),
1542558383555:right = (max(stops.df$stop_lon) + 0.01),
1542558383555:top = (max(stops.df$stop_lat) + 0.01))
1542558383555:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558384391:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.16, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558486206:home.route <- 16
1542558490086:home.route
1542558499673:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542558499673:home.route <- 16
1542558499673:home.route
1542558499688:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542558499864:bus.join.sat
1542558499985:stops.16 <- bus.join.sat %>% filter(route_short_name==home.route) %>% select(stop_id) %>% distinct()
1542558499999:stops.16
1542558500009:stops.intersect.16 <- inner_join(stops.16, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558500064:stops.intersect.16
1542558506297:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558506297:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542558506297:bottom = (min(stops.df$stop_lat) - 0.01),
1542558506297:right = (max(stops.df$stop_lon) + 0.01),
1542558506297:top = (max(stops.df$stop_lat) + 0.01))
1542558506313:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558507092:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.16, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558558930:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542558558945:home.route <- 16
1542558558945:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542558559021:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% select(stop_id) %>% distinct()
1542558559034:stops.intersect.home <- inner_join(stops.home, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558578329:unzip('DublinBus.zip')
1542558579003:trips.df <- read_csv('googletransitdublinbusp20130315-1546\\trips.txt')
1542558579113:routes.df <- read_csv('googletransitdublinbusp20130315-1546\\routes.txt')
1542558579135:calendar.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar.txt')
1542558579209:calendar_dates.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar_dates.txt')
1542558579209:shapes.df <- read_csv('googletransitdublinbusp20130315-1546\\shapes.txt')
1542558579319:stops.df <- read_csv('googletransitdublinbusp20130315-1546\\stops.txt')
1542558579350:transfers.df <- read_csv('googletransitdublinbusp20130315-1546\\transfers.txt')
1542558579366:agency.df <- read_csv('googletransitdublinbusp20130315-1546\\agency.txt')
1542558579366:stop_times.df <- read_csv('googletransitdublinbusp20130315-1546\\stop_times.txt')
1542558593991:route.num.trip <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542558594007:ggplot(data=route.num.trip, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542558597956:#common join used at multiple points in the code
1542558597956:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542558598672:#calculating the unit of distance in the dataset
1542558598675:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542558598729:#calculating the route lengths
1542558598732:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542558598924:# base df that most and least frequent routes and mean length is based on
1542558598924:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, Service, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, Service, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, Service, Freq) %>% group_by(Service)
1542558599194:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542558599204:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542558599212:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542558599220:extreme.freq <- rbind(most.freq, leastfreq) %>% select(Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., Service, Freq)
1542558611755:route.num.trip <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542558611770:ggplot(data=route.num.trip, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542558618226:#common join used at multiple points in the code
1542558618226:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542558618646:#calculating the unit of distance in the dataset
1542558618648:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542558618806:#calculating the route lengths
1542558618806:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542558619011:# base df that most and least frequent routes and mean length is based on
1542558619011:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, Service, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, Service, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, Service, Freq) %>% group_by(Service)
1542558619147:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542558619154:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542558619155:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542558619155:extreme.freq <- rbind(most.freq, leastfreq) %>% select(Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., Service, Freq)
1542558622879:kable(extreme.freq)
1542558629049:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542558629049:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558629064:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558629080:lat.long.16 <- filter(bus.join, route_short_name==16) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat)
1542558629095:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest, lat.long.16)
1542558629111:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558629111:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542558629111:bottom = (min(stops.df$stop_lat) - 0.01),
1542558629111:right = (max(stops.df$stop_lon) + 0.01),
1542558629111:top = (max(stops.df$stop_lat) + 0.01))
1542558629126:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558630042:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558641999:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542558641999:home.route <- 16
1542558641999:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542558642085:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% select(stop_id) %>% distinct()
1542558642097:stops.intersect.home <- inner_join(stops.home, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558644429:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558644429:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542558644429:bottom = (min(stops.df$stop_lat) - 0.01),
1542558644429:right = (max(stops.df$stop_lon) + 0.01),
1542558644429:top = (max(stops.df$stop_lat) + 0.01))
1542558644429:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558645208:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.16, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558655201:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558655201:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542558655201:bottom = (min(stops.df$stop_lat) - 0.01),
1542558655201:right = (max(stops.df$stop_lon) + 0.01),
1542558655201:top = (max(stops.df$stop_lat) + 0.01))
1542558655216:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558656036:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect.home, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558711886:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558711886:dublin_bb <- c(left = (min(stops.intersect$stop_lon) - 0.01),
1542558711886:bottom = (min(stops.intersect$stop_lat) - 0.01),
1542558711886:right = (max(stops.intersect$stop_lon) + 0.01),
1542558711886:top = (max(stops.intersect$stop_lat) + 0.01))
1542558717378:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542558717378:home.route <- 16
1542558717378:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542558717447:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% select(stop_id) %>% distinct()
1542558717463:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558721005:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558721005:dublin_bb <- c(left = (min(stops.intersect$stop_lon) - 0.01),
1542558721005:bottom = (min(stops.intersect$stop_lat) - 0.01),
1542558721005:right = (max(stops.intersect$stop_lon) + 0.01),
1542558721005:top = (max(stops.intersect$stop_lat) + 0.01))
1542558721021:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558734585:dublin_bb
1542558741972:stops.intersect
1542558782688:stops.intersect %>% na.omit()
1542558806322:dublin_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542558806322:bottom = (min(stops.intersect$Latitude) - 0.01),
1542558806322:right = (max(stops.intersect$Longitude) + 0.01),
1542558806322:top = (max(stops.intersect$Latitude) + 0.01))
1542558806322:dublin_bb
1542558812560:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558812560:dublin_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542558812560:bottom = (min(stops.intersect$Latitude) - 0.01),
1542558812560:right = (max(stops.intersect$Longitude) + 0.01),
1542558812560:top = (max(stops.intersect$Latitude) + 0.01))
1542558812560:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558813383:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558825533:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542558825533:home.route <- 49
1542558825540:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542558825619:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% select(stop_id) %>% distinct()
1542558825630:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542558825778:stops.intersect %>% na.omit()
1542558829521:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542558829521:dublin_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542558829521:bottom = (min(stops.intersect$Latitude) - 0.01),
1542558829521:right = (max(stops.intersect$Longitude) + 0.01),
1542558829521:top = (max(stops.intersect$Latitude) + 0.01))
1542558829537:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542558836065:ggmap(dublin_stamen, legend = 'right') + geom_point(data = stops.intersect, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542558889603:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% select(stop_id) %>% distinct() %>% mumtate(Route=home.route)
1542558896375:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% select(stop_id) %>% distinct() %>% mutate(Route=home.route)
1542558896388:stops.home
1542558923042:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% mutate(Route=home.route) %>% select(Route, stop_id) %>% distinct()
1542558923056:stops.home
1542558994345:stops.intersect %>% na.omit()
1542561029229:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542561029239:home.route <- 49
1542561029255:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542561029863:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% distinct()
1542561030085:stops.home
1542561030444:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561077480:#first get list of all stops on 16 route on a Saturday, then we inner join with the main dataset to get all routes that intercect with the 16 route. We then join again to the main dataset to get all stops on these routes.
1542561077491:home.route <- 49
1542561077504:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542561077658:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% select(stop_id) %>% distinct()
1542561077677:stops.home
1542561077688:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561077786:stops.intersect %>% na.omit()
1542561127443:stops.intersect
1542561162070:stops.intersect %>% mutate(Route='All Intersecting Routes')
1542561177661:stops.home %>% mutate(Route='All Intersecting Routes')
1542561193414:?concat
1542561232916:stops.home %>% mutate(Route=paste('Routes', home.route))
1542561282164:stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))
1542561282463:stops.home %>% mutate(Route=paste('Route', home.route))
1542561328241:intersect.routes <- rbind(stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))
1542561328245:, stops.home %>% mutate(Route=paste('Route', home.route)))
1542561338265:stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))
1542561338671:stops.home %>% mutate(Route=paste('Route', home.route))
1542561432126:home.route <- 49
1542561432132:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542561432300:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% distinct()
1542561432355:stops.home
1542561432573:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561514135:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id') %>% select(route_short_name) %>% distinct() #%>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561522961:stops.home
1542561547710:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id') #%>% select(route_short_name) %>% distinct() #%>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561547990:stops.intersect
1542561585853:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) #%>% select(route_short_name) %>% distinct() #%>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561586064:stops.intersect
1542561621739:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() #%>% inner_join(bus.join.sat, by='route_short_name') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561621987:stops.intersect
1542561646316:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by='route_short_name.intersect') %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561782061:?inner_join
1542561873735:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by = c("route_short_name.intersect" = "route_short_name"))) %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561888821:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by = c("route_short_name.intersect" = "route_short_name")) %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542561889026:stops.intersect
1542561898875:stops.home
1542561937608:stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))
1542561937705:stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route))
1542561992448:intersect.routes <- rbind((stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))), (stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route))))
1542561992491:intersect.routes
1542562027986:intersect.routes <- rbind((stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))), (stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route)))) %>% select(Route, Longitude, Latitude)
1542562028275:intersect.routes
1542562070679:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542562070688:dublin_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542562070696:bottom = (min(stops.intersect$Latitude) - 0.01),
1542562070703:right = (max(stops.intersect$Longitude) + 0.01),
1542562070711:top = (max(stops.intersect$Latitude) + 0.01))
1542562070726:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542562071859:ggmap(dublin_stamen, legend = 'right') + geom_point(data = intersect.routes, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542562650118:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542562650429:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% distinct()
1542562650482:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by = c("route_short_name.intersect" = "route_short_name")) %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542562650868:intersect.routes <- rbind((stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))), (stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route)))) %>% select(Route, Longitude, Latitude)
1542562674696:home.route <- 49
1542562674708:stops.home <- bus.join.sat %>% filter(route_short_name==home.route) %>% distinct()
1542562674806:stops.home
1542562683508:home.route <- 49
1542562683518:stops.home <- bus.join.sat %>% filter(route_short_name==home.route)
1542562683778:stops.home
1542562983425:bus.join %>% filter(route_short_name==home.route)
1542563034884:bus.join %>% filter(route_short_name==home.route, stop_id=='8220DB001295')
1542563064394:bus.join %>% filter(route_short_name==home.route)#, stop_id=='8220DB001295')
1542563120184:bus.join %>% filter(route_short_name==home.route), stop_id=='8220DB001295' | stop_id=='8220DB004521')
1542563128963:bus.join %>% filter(route_short_name==home.route, stop_id=='8220DB001295' | stop_id=='8220DB004521')
1542563265163:bus.join %>% filter(route_short_name==home.route, stop_id=='8220DB001295' | stop_id=='8220DB004521') %>% arrange(stop_id, arrival_time)
1542563293691:calendar.df
1542563314657:bus.join %>% filter(route_short_name==home.route, Service=='Weekday', stop_id=='8220DB001295' | stop_id=='8220DB004521') %>% arrange(stop_id, arrival_time)
1542563363513:bus.join %>% filter(route_short_name==home.route, Service=='Weekday', stop_id=='8220DB001295' | stop_id=='8220DB004521') %>% arrange(trip_id, arrival_time)
1542563427348:bus.join %>% filter(route_short_name==home.route, Service=='Weekday', direction_id==0)
1542563449539:bus.join %>% filter(route_short_name==home.route, Service=='Weekday', direction_id==1)
1542563449729:#, stop_id=='8220DB001295' | stop_id=='8220DB004521') %>% arrange(trip_id, arrival_time)
1542563611818:bus.home %>% select(direction_id, stop_headsign) %>% distinct()
1542563616405:bus.home <- bus.join %>% filter(route_short_name==home.route, Service=='Weekday')#
1542563616430:bus.home %>% select(direction_id, stop_headsign) %>% distinct()
1542563727631:bus.home %>% filter(direction_id==0) %>% select(stop_headsign) %>% distinct()
1542563816456:bus.home %>% filter(direction_id==1) %>% select(stop_headsign) %>% distinct()
1542563849301:#
1542563849303:bus.home
1542563939003:bus.home %>% select(route_long_name)
1542563950641:bus.home %>% select(route_long_name) %>% distinct()
1542563977925:bus.home
1542564038822:bus.home %>% select(trip_id, direction_id, arrival_time, stop_id, shape_dist_traveledstop_name)
1542564044415:bus.home %>% select(trip_id, direction_id, arrival_time, stop_id, shape_dist_traveled, stop_name)
1542564239325:bus.home %>% select(direction_id, stop_id, stop_name) %>% distinct()
1542564312236:bus.home %>% filter(stop_id=='8220DB001296' | stop_id == '8220DB004521', stop_id=='8220DB001339', stop_id=='8220DB005192')
1542564327947:bus.home %>% filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542564354725:bus.home %>% select(direction_id, stop_id, stop_name) %>% filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542564368516:bus.home %>% select(direction_id, stop_id, stop_name) %>% filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192') %>% distinct()
1542564375871:bus.home
1542564402710:bus.home %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192') %>% distinct()
1542564413948:bus.home
1542564426883:bus.home %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192') %>% distinct()
1542564583662:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542564583759:home.stops
1542564602066:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542564602204:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name)) %>%distinct()
1542564614816:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542564614953:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542564648565:home.stops
1542564697487:home.stops %>% filter(direction_id==1)
1542564727281:home.stops %>% filter(direction_id==1, stop_id=='8220DB005192')
1542564824921:home.stops %>% filter(direction_id==1, stop_id=='8220DB005192', arrival_time<as.hms('09:00:00'))
1542564878636:home.stops %>% filter(direction_id==1, stop_id=='8220DB005192', arrival_time>as.hms('08:15:00'), arrival_time<as.hms('09:00:00'))
1542565416623:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542565416763:home.stops
1542565469682:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542565469821:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542565534022:home.stops %>% filter(direction_id==1, stop_id=='8220DB005192', arrival_time>as.hms('08:15:00'), arrival_time<as.hms('09:00:00'))
1542565534022:home.stops %>% filter(direction_id==0, stop_id=='8220DB004521', arrival_time>as.hms('17::00'), arrival_time<as.hms('17:30:00'))
1542565542094:home.stops %>% filter(direction_id==1, stop_id=='8220DB005192', arrival_time>as.hms('08:15:00'), arrival_time<as.hms('09:00:00'))
1542565545926:home.stops %>% filter(direction_id==0, stop_id=='8220DB004521', arrival_time>as.hms('17::00'), arrival_time<as.hms('17:30:00'))
1542565557784:home.stops %>% filter(direction_id==0, stop_id=='8220DB004521', arrival_time>as.hms('17:00:00'), arrival_time<as.hms('17:30:00'))
1542565580526:home.stops %>% filter(direction_id==1, stop_id=='8220DB005192', arrival_time>as.hms('08:15:00'), arrival_time<as.hms('09:00:00'))
1542565580539:home.stops %>% filter(direction_id==0, stop_id=='8220DB004521', arrival_time>as.hms('17:00:00'), arrival_time<as.hms('17:45:00'))
1542565619977:home.stops %>% filter(direction_id==1, stop_id=='8220DB005192', arrival_time>as.hms('08:15:00'), arrival_time<as.hms('09:00:00')) %>% select(trip_id)
1542565619986:home.stops %>% filter(direction_id==0, stop_id=='8220DB004521', arrival_time>as.hms('17:00:00'), arrival_time<as.hms('17:45:00')) %>% select(trip_id)
1542565736991:home.stops %>% filter((direction_id==1, stop_id=='8220DB005192', arrival_time>as.hms('08:15:00'), arrival_time<as.hms('09:00:00')) | (direction_id==0, stop_id=='8220DB004521', arrival_time>as.hms('17:00:00'), arrival_time<as.hms('17:45:00')))
1542565788475:home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00')))
1542565828642:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542565871635:home.stops %>% inner_join(commute.trips, by='trip_id')
1542565909193:4291-287
1542565918823:15876-11565
1542567483413:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' )
1542567483620:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542567483788:home.stops <- bus.home %>%  filter( stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542567483817:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542567724413:home.stops <- bus.home %>%  filter( stop_id=='8220DB001339' | stop_id=='8220DB005192') %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct()
1542567741064:bus.home %>%  filter( stop_id=='8220DB001339' | stop_id=='8220DB005192') %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct()
1542567755223:bus.home %>%  filter( stop_id=='8220DB001339' | stop_id=='8220DB005192') %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name, arrival_time) %>% distinct()
1542567772003:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542567772142:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542567780644:home.stops %>% inner_join(commute.trips, by='trip_id')
1542567805907:bus.home
1542567839117:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542567839117:home.stops %>% inner_join(commute.trips, by='trip_id')
1542567877494:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence)
1542567964431:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% mutate(length.time=arrival_time-lead(arrival_time))
1542568000353:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% mutate(length.time=arrival_time-lead(arrival_time)) %>% mutate(length.dist=shape_dist_traveled-lead(shape_dist_traveled))
1542568030629:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(trip_id) mutate(length.time=arrival_time-lead(arrival_time)) %>% mutate(length.dist=shape_dist_traveled-lead(shape_dist_traveled))
1542568037232:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(trip_id) %>% mutate(length.time=arrival_time-lead(arrival_time)) %>% mutate(length.dist=shape_dist_traveled-lead(shape_dist_traveled))
1542568151112:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/1000) %>% mutate(length.dist=shape_dist_traveled-lead(shape_dist_traveled))
1542568181243:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000)
1542568357642:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000)
1542568442459:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() #%>% select(direction_id, )
1542568458405:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() #%>% select(direction_id, )
1542568476417:1595/60
1542568487720:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() #%>% select(direction_id, )
1542568531999:home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% distinct()
1542568572616:length.route
1542568576747:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% distinct()
1542568576912:length.route
1542568619687:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(is.na(length.dist)) %>% distinct()
1542568619702:length.route
1542568627229:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542568627242:length.route
1542568658151:length.route
1542568658331:filter(length.route, direction_id==1)
1542568674813:filter(length.route, direction_id==1)$length.time
1542568703209:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542568703395:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542568733409:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542568733424:length.route
1542568733478:filter(length.route, direction_id==1)$length.time
1542568733485:filter(length.route, direction_id==1)$length.dist
1542568733490:filter(length.route, direction_id==0)$length.time
1542568733498:filter(length.route, direction_id==0)$length.dist
1542568852188:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542568852188:commute.trips
1542568861335:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00')))
1542568861504:commute.trips
1542569112161:commute.time.work <- home.stops %>% filter(direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00'))
1542569112175:commute.time.work
1542569112176:commute.time.home <- home.stops %>% filter(direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))
1542569112194:commute.time.home
1542569142778:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542569142788:commute.trips
1542569159036:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(arrival_time-lead(arrival_time))/60) %>% mutate(length.dist=(shape_dist_traveled-lead(shape_dist_traveled))/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542569159055:length.route
1542569179594:commute.trips
1542569179729:home.stops
1542569211611:inner_join(home.stops, commute.trips, by='trip_id')
1542569454386:inner_join(home.stops, commute.trips, by='trip_id') %>% select(Service, trip_id, stop_headsign, arrival_time, stop_name)
1542569552152:inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) #%>% select(Service, trip_id, stop_headsign, arrival_time, stop_name)
1542569569858:inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, trip_id, Journey, stop_headsign, arrival_time, stop_name)
1542569619032:inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, trip_id, Journey, stop_headsign, arrival_time, stop_name)
1542569668169:inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, trip_id, Journey, Direction=stop_headsign, arrival_time, stop_name)
1542569679685:inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, trip_id, Journey, Direction=stop_headsign, stop_name, arrival_time)
1542569700908:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, trip_id, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542569714838:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542569904957:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when((stop_headsign=='Pearse St' & stop_name=='Harold\'s Cross Road') ~ 'Leave home for work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542569921952:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when((stop_headsign=='Pearse St' && stop_name=='Harold\'s Cross Road') ~ 'Leave home for work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542569944639:?case_when
1542570008064:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when((stop_headsign=='Pearse St' & stop_name=='Harold\'s Cross Road') ~ 'Leave home for work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542570020972:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542570314227:?as.hms
1542570482713:length.route
1542570552295:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(lead(arrival_time) - arrival_time)/60) %>% mutate(length.dist=(lead(shape_dist_traveled) - shape_dist_traveled)/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542570552308:length.route
1542570677999:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542570677999:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542570678014:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542570678030:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest)
1542570678045:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542570678045:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542570678045:bottom = (min(stops.df$stop_lat) - 0.01),
1542570678045:right = (max(stops.df$stop_lon) + 0.01),
1542570678045:top = (max(stops.df$stop_lat) + 0.01))
1542570678061:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542570678989:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542570750363:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542570750363:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(lead(arrival_time) - arrival_time)/60) %>% mutate(length.dist=(lead(shape_dist_traveled) - shape_dist_traveled)/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542570750543:length.route
1542570910816:bus.join %>% filter(route_short_name==home.route)
1542570978860:bus.join %>% group_by(Service) %>% filter(route_short_name==home.route, (arrival_time==min(arrival_time) | arrival_time==max(arrival_time)))
1542570989836:bus.join %>% group_by(Service)# %>% filter(route_short_name==home.route, (arrival_time==min(arrival_time) | arrival_time==max(arrival_time)))
1542570992901:bus.join %>% group_by(Service) %>% filter(route_short_name==home.route, (arrival_time==min(arrival_time) | arrival_time==max(arrival_time)))
1542571007789:bus.join %>% group_by(Service) %>% filter(route_short_name==home.route, arrival_time==min(arrival_time))# | arrival_time==max(arrival_time)))
1542571044656:bus.join %>% group_by(Service) %>% filter(arrival_time==min(arrival_time))# | arrival_time==max(arrival_time)))
1542571051884:bus.join %>% group_by(Service)# %>% filter(arrival_time==min(arrival_time))# | arrival_time==max(arrival_time)))
1542571087974:bus.join %>% group_by(Service) %>% filter(arrival_time==max(arrival_time))# | arrival_time==max(arrival_time)))
1542571165658:bus.join %>% group_by(Service) %>% filter(route_short_name==home.route)#, arrival_time==min(arrival_time) | arrival_time==max(arrival_time)))
1542571189457:bus.join %>% group_by(Service) %>% select(arrival_time)#filter(route_short_name==home.route)#, arrival_time==min(arrival_time) | arrival_time==max(arrival_time)))
1542571220708:bus.join %>% group_by(Service) %>% summarise(max(arrival_time), min(arrival_time))
1542571254961:#  summarise(max(arrival_time), min(arrival_time))
1542571254963:#filter(route_short_name==home.route)#, arrival_time==min(arrival_time) | arrival_time==max(arrival_time)))
1542571259567:bus.join %>% group_by(Service) %>% filter(!is.na(arrival_time))
1542571266313:bus.join %>% group_by(Service) %>% filter(!is.na(arrival_time)) %>% summarise(max(arrival_time), min(arrival_time))
1542571410109:bus.join %>% group_by(Service) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(max(arrival_time), min(arrival_time))
1542571427196:bus.join %>% group_by(Service) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(min(arrival_time), max(arrival_time))
1542571448786:bus.join %>% group_by(Service) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(earliest.bus=min(arrival_time), latest.bus= max(arrival_time))
1542571510195:kable(bus.join %>% group_by(Service, direction_id) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(earliest.bus=min(arrival_time), latest.bus= max(arrival_time)))
1542571525629:kable(bus.join %>% group_by(Service, stop_headsign) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(earliest.bus=min(arrival_time), latest.bus= max(arrival_time)))
1542573222477:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542573222477:download.file(url.footfall, 'footfall_ods.ods')
1542573229159:read_ods('pedestrianfootfall2013.ods')
1542573350471:x
1542573353339:x <- read_ods('pedestrianfootfall2013.ods')
1542573357478:x
1542573424977:x[1]
1542573448052:slice(x[1] %like% 'Entrance Name')
1542573477034:slice(like(x[1]'Entrance Name'))
1542573484518:slice(like(x[1],'Entrance Name'))
1542573514956:x[1]
1542573550986:?startsWith
1542573598887:slice(startsWith(x[1],'Entrance Name'))
1542573619564:slice(startsWith(x[1],'E'))
1542573645479:slice(startsWith(x[1],"E"))
1542573659660:type(of(x[1])
1542573666315:typeof(x[1])
1542573672567:typeof(x[1])
1542573832448:ptn='Entrance Name*'
1542573832448:ndx = grep(ptn, x[1], perl=T)
1542573837755:ndx
1542573866206:ptn='Entrance Name*'
1542573866206:ndx = grep(ptn, x[1], perl=T)
1542573866206:ndx
1542573866206:selected_rows = x[ndx,1]
1542573866223:selected_rows
1542573878929:?grep
1542573899350:x[1]
1542573911174:?read_ods
1542574078099:?readxl
1542574140551:library(readxl)
1542574157020:read_excel('pedestrianfootfall2013.ods')
1542574164738:read_excel(pedestrianfootfall2013.ods)
1542574216520:get_num_sheet_in_ods('pedestrianfootfall2013.ods')
1542574230271:ods_sheets('pedestrianfootfall2013.ods')
1542574255288:x
1542574355276:filter(x, grepl("Entrance", x[1], fixed = TRUE))
1542574367614:x
1542574424167:colnames(x) #%>% select()
1542574430032:x
1542574551446:colnames(x) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542574551478:x
1542574571783:filter(x, grepl("Entrance", Time, fixed = TRUE))
1542574580356:filter(x, grepl("Entrance Name", Time, fixed = TRUE))
1542574682175:footfall.wk1 <- read_ods('pedestrianfootfall2013.ods')
1542574686665:colnames(footfall.wk1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542574686680:filter(footfall.wk1, grepl("Entrance Name", Time, fixed = TRUE))
1542574686696:#Entrance Name: O'Connell Street at Easons
1542574686696:#Entrance Name: South Great Georges
1542574686696:footfall.wk1
1542574733448:filter(footfall.wk1, grepl("Entrance Name", Time, fixed = TRUE))
1542574741059:footfall.wk1
1542574779085:?slice
1542574814707:?row_number
1542574894277:which(grepl('Entrance Name: South Great Georges', footfall.wk1$Time))
1542574948328:which(grepl('Entrance Name: O\'Connell Street at Easons', footfall.wk1$Time))
1542574948330:which(grepl('Entrance Name: South Great Georges', footfall.wk1$Time))
1542574980392:north.row <- which(grepl('Entrance Name: O\'Connell Street at Easons', footfall.wk1$Time))
1542574980394:south.row <- which(grepl('Entrance Name: South Great Georges', footfall.wk1$Time))
1542574982144:footfall.wk1
1542575047598:library(readxl)
1542575047598:read_excel(pedestrianfootfall2013.ods)
1542575072013:slice(footfall.wk1, (north.row+3):(north.row+26))
1542575473578:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542575473578:camera2.name <- 'Entrance Name: South Great Georges'
1542575473578:camera1.row <- which(grepl(camera1.name, footfall.wk1$Time))
1542575473578:camera2.row <- which(grepl(camera2.name, footfall.wk1$Time))
1542575473592:camera1.slice <- slice(footfall.wk1, (north.row+3):(north.row+26))
1542575473592:camera2.slice <- slice(footfall.wk1, (south.row+3):(south.row+26))
1542575548402:ods_sheets('pedestrianfootfall2013.ods')
1542575602953:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542575603677:footfall.wk1 <- read_ods('pedestrianfootfall2013.ods',sheet.names)
1542575722709:sheet.names[1]
1542575767600:paste(footfall, sheet.names[1]) <- read_ods('pedestrianfootfall2013.ods',sheet.names)
1542575779968:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542575780774:sheet.names[1]
1542575780774:paste(footfall, sheet.names[1]) <- read_ods('pedestrianfootfall2013.ods')
1542575788710:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542575789349:sheet.names[1]
1542575789349:paste(footfall, sheet.names[1]) <- read_ods('pedestrianfootfall2013.ods')
1542575809665:paste('footfall', sheet.names[1]) <- read_ods('pedestrianfootfall2013.ods')
1542575866735:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542575875201:f1
1542575889682:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542575889697:f1
1542575965415:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542575965420:camera2.name <- 'Entrance Name: South Great Georges'
1542575965420:camera1.row <- which(grepl(camera1.name, f1$Time))
1542575965420:camera2.row <- which(grepl(camera2.name, f1$Time))
1542575965420:camera1.slice <- slice(f1, (north.row+3):(north.row+26))
1542575965561:camera2.slice <- slice(f1, (south.row+3):(south.row+26))
1542575977666:camera1.slice
1542575977666:camera2.slice
1542576054081:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542576054081:camera2.name <- 'Entrance Name: South Great Georges'
1542576054081:camera1.row <- which(grepl(camera1.name, f1[1]))
1542576054252:camera2.row <- which(grepl(camera2.name, f1[1]))
1542576054255:camera1.slice <- slice(f1, (north.row+3):(north.row+26))
1542576054267:camera2.slice <- slice(f1, (south.row+3):(south.row+26))
1542576054278:camera1.slice
1542576054291:camera2.slice
1542576084420:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542576085126:sheet.names[1]
1542576085126:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542576089739:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542576089739:camera2.name <- 'Entrance Name: South Great Georges'
1542576089739:camera1.row <- which(grepl(camera1.name, f1[1]))
1542576089802:camera2.row <- which(grepl(camera2.name, f1[1]))
1542576089802:camera1.slice <- slice(f1, (north.row+3):(north.row+26))
1542576115845:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542576116601:sheet.names[1]
1542576116608:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542576121470:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542576121472:camera2.name <- 'Entrance Name: South Great Georges'
1542576121527:camera1.row <- which(grepl(camera1.name, f1[1]))
1542576121532:camera2.row <- which(grepl(camera2.name, f1[1]))
1542576121535:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26))
1542576138467:camera1.row
1542576155607:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542576174947:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576174974:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542576174977:camera2.name <- 'Entrance Name: South Great Georges'
1542576174979:camera1.row <- which(grepl(camera1.name, f1[1]))
1542576174979:camera1.row
1542576189590:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542576193625:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576193648:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542576193651:camera2.name <- 'Entrance Name: South Great Georges'
1542576193651:camera1.row <- which(grepl(camera1.name, f1$Time))
1542576193707:camera1.row
1542576213455:f1[1]
1542576230414:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542576234656:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576234656:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542576234673:camera2.name <- 'Entrance Name: South Great Georges'
1542576234677:camera1.row <- which(grepl(camera1.name, f1$Time))
1542576234679:camera1.row
1542576234683:camera2.row <- which(grepl(camera2.name, f1$Time))
1542576234683:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26))
1542576234750:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26))
1542576234761:camera1.slice
1542576234771:camera2.slice
1542576279530:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[1])
1542576279545:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[1])
1542576279561:camera1.slice
1542576279576:camera2.slice
1542576483502:for(i in 1:2)
1542576483502:{
1542576483502:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542576483502:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576483517:camera1.row <- which(grepl(camera1.name, f1$Time))
1542576483517:camera2.row <- which(grepl(camera2.name, f1$Time))
1542576483517:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542576483517:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542576483517:camera1.all <- rbind(camera1.all, camera1.slice)
1542576483517:camera2.all <- rbind(camera2.all, camera2.slice)
1542576483517:}
1542576664156:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542576664156:camera2.name <- 'Entrance Name: South Great Georges'
1542576664156:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542576664942:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542576664950:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576665016:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542576665032:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576665098:for(i in 1:2)
1542576665098:{
1542576665098:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542576665098:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576665098:camera1.row <- which(grepl(camera1.name, f1$Time))
1542576665113:camera2.row <- which(grepl(camera2.name, f1$Time))
1542576665113:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542576665113:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542576665129:camera1.all <- rbind(camera1.all, camera1.slice)
1542576665129:camera2.all <- rbind(camera2.all, camera2.slice)
1542576665129:}
1542576673857:camera1.all
1542576673858:camera2.all
1542576673874:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542576701518:length(sheet.names)
1542576710114:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542576710114:camera2.name <- 'Entrance Name: South Great Georges'
1542576710114:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542576710845:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542576710860:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576710860:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542576710876:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576710892:for(i in 1:length(sheet.names))
1542576710892:{
1542576710892:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542576710892:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542576710892:camera1.row <- which(grepl(camera1.name, f1$Time))
1542576710907:camera2.row <- which(grepl(camera2.name, f1$Time))
1542576710907:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542576710907:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542576710907:camera1.all <- rbind(camera1.all, camera1.slice)
1542576710907:camera2.all <- rbind(camera2.all, camera2.slice)
1542576710923:}
1542577398408:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542577398408:options(digits=2)
1542577398548:i=1
1542577398552:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577409446:library(devtools)
1542577409870:library(readr)
1542577409963:library(ggplot2)
1542577409963:library(ggmap)
1542577410124:devtools::install_github('hadley/ggplot2')
1542577411063:devtools::install_github('dkahle/ggmap')
1542577411642:library(rnoaa)
1542577412224:library(httr)
1542577412234:library(plyr)
1542577412244:library(jsonlite)
1542577412253:library(dplyr)
1542577412270:library(readODS)
1542577412337:library(knitr)
1542577412346:library(hms)
1542577431637:i=1
1542577431637:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577453466:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542577453468:camera2.name <- 'Entrance Name: South Great Georges'
1542577453468:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542577454412:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577454423:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577454493:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577454509:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577454610:i=1
1542577454617:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577458856:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577458912:camera1.row <- which(grepl(camera1.name, f1$Time))
1542577458912:camera2.row <- which(grepl(camera2.name, f1$Time))
1542577458912:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542577458994:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542577459009:camera1.all <- rbind(camera1.all, camera1.slice)
1542577459009:camera2.all <- rbind(camera2.all, camera2.slice)
1542577459025:i
1542577482060:camera1.all
1542577482198:camera2.all
1542577502915:i=2
1542577502915:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542577502915:camera2.name <- 'Entrance Name: South Great Georges'
1542577502915:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542577503681:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577503684:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577503684:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577503706:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577503718:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577507835:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577507851:camera1.row <- which(grepl(camera1.name, f1$Time))
1542577507851:camera2.row <- which(grepl(camera2.name, f1$Time))
1542577507851:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542577507867:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542577507887:camera1.all <- rbind(camera1.all, camera1.slice)
1542577507887:camera2.all <- rbind(camera2.all, camera2.slice)
1542577507903:camera1.all
1542577507918:camera2.all
1542577507918:i
1542577546689:i=3
1542577546693:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542577546697:camera2.name <- 'Entrance Name: South Great Georges'
1542577546700:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542577547408:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577547408:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577547423:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577547597:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577547612:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577551532:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577551608:camera1.row <- which(grepl(camera1.name, f1$Time))
1542577551608:camera2.row <- which(grepl(camera2.name, f1$Time))
1542577551608:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542577551622:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542577551638:rbind(camera1.all, camera1.slice)
1542577551653:rbind(camera2.all, camera2.slice)
1542577551671:camera1.all
1542577551680:camera2.all
1542577551688:i
1542577566021:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542577566021:camera2.name <- 'Entrance Name: South Great Georges'
1542577566021:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542577566716:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577566726:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577566787:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577566939:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577582491:i=3
1542577582491:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577586643:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577586712:camera1.row <- which(grepl(camera1.name, f1$Time))
1542577586716:camera2.row <- which(grepl(camera2.name, f1$Time))
1542577586771:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542577586826:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542577586833:camera1.all <- rbind(camera1.all, camera1.slice)
1542577586912:camera2.all <- rbind(camera2.all, camera2.slice)
1542577586964:camera1.all
1542577586964:camera2.all
1542577586980:i
1542577599386:i=4
1542577599515:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577604241:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577604311:camera1.row <- which(grepl(camera1.name, f1$Time))
1542577604315:camera2.row <- which(grepl(camera2.name, f1$Time))
1542577604315:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542577604455:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542577604470:camera1.all <- rbind(camera1.all, camera1.slice)
1542577604470:camera2.all <- rbind(camera2.all, camera2.slice)
1542577604486:camera1.all
1542577604503:camera2.all
1542577604585:i
1542577637622:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542577637622:camera2.name <- 'Entrance Name: South Great Georges'
1542577637622:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542577638311:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577638484:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577638499:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577638499:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577638617:#1:length(sheet.names)
1542577638622:for(i in 1:52)
1542577638623:{
1542577638623:i=1
1542577638623:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577638623:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577638623:camera1.row <- which(grepl(camera1.name, f1$Time))
1542577638639:camera2.row <- which(grepl(camera2.name, f1$Time))
1542577638639:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542577638639:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542577638639:camera1.all <- rbind(camera1.all, camera1.slice)
1542577638639:camera2.all <- rbind(camera2.all, camera2.slice)
1542577638639:i
1542577638655:}
1542577846407:camera1.all
1542577846478:camera2.all
1542577846549:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542577992472:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542577992476:camera2.name <- 'Entrance Name: South Great Georges'
1542577992480:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542577993245:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577993254:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577993263:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542577993272:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577993281:#1:length(sheet.names)
1542577993286:for(i in 1:52)
1542577993288:{
1542577993290:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542577993293:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542577993297:camera1.row <- which(grepl(camera1.name, f1$Time))
1542577993299:camera2.row <- which(grepl(camera2.name, f1$Time))
1542577993302:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542577993304:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542577993308:camera1.all <- rbind(camera1.all, camera1.slice)
1542577993310:camera2.all <- rbind(camera2.all, camera2.slice)
1542577993313:}
1542580265125:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542580265139:camera2.name <- 'Entrance Name: South Great Georges'
1542580265148:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542580266225:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542580266245:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542580266319:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542580266560:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542580266588:#1:length(sheet.names)
1542580266600:for(i in 1:10)
1542580266607:{
1542580266614:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542580267038:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542580267053:camera1.row <- which(grepl(camera1.name, f1$Time))
1542580267060:camera2.row <- which(grepl(camera2.name, f1$Time))
1542580267133:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542580267251:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542580267265:camera1.all <- rbind(camera1.all, camera1.slice)
1542580267276:camera2.all <- rbind(camera2.all, camera2.slice)
1542580267336:}
1542580381932:camera1.all
1542649855472:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542649855477:options(digits=2)
1542649856160:library(devtools)
1542649857148:library(readr)
1542649857226:library(ggplot2)
1542649857436:library(ggmap)
1542649857488:devtools::install_github('hadley/ggplot2')
1542649882703:devtools::install_github('dkahle/ggmap')
1542649883166:library(rnoaa)
1542649883661:library(httr)
1542649883670:library(plyr)
1542649883680:library(jsonlite)
1542649883690:library(dplyr)
1542649883748:library(readODS)
1542649883767:library(knitr)
1542649883776:library(hms)
1542649883794:employ.read <- read_delim('dublin employment trends.txt', ':')
1542649884320:qplot(data = employ.read , x = Time , y = Employment, geom = 'line', xlab = 'Quarterly Figures', ylab = 'Trend', main = 'Dublin Employment Trends Per Sector: 2006 - 2016') + facet_grid ( .~ Sector)
1542649884940:min.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == min(Employment))
1542649885164:max.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == max(Employment))
1542649885187:employ.extreme <- left_join(min.employ, max.employ, by = 'Sector', suffix = c('.min', '.max'))[c('Sector', 'QuarterYear.min', 'Employment.min', 'Time.min', 'QuarterYear.max', 'Employment.max', 'Time.max')]
1542649885202:employ.extreme <- employ.extreme %>% mutate(Employment.diff = Employment.max-Employment.min)
1542649885216:kable(employ.extreme, digits = 2)
1542649885586:prop.read <- read_tsv('dublin property trends.txt')
1542649885612:qplot(data = prop.read , x = Time , y = Trend, geom = 'line', colour = Category, xlab = 'Time', ylab = 'Trend', main = 'Dublin Property Trends: 2007 - 2016')
1542649886257:prop.split <- split(prop.read, prop.read$Category)
1542649886324:prop.apt.rent <- select(prop.split[[1]], Time, Year, Trend, Category)
1542649886333:prop.house.price <- select(prop.split[[2]], Time, Year, Trend, Category)
1542649886340:prop.house.rent <- select(prop.split[[3]], Time, Year, Trend, Category)
1542649886346:prop.house.built <- select(prop.split[[4]], Time, Year, Trend, Category)
1542649886354:prop.cols <- prop.apt.rent %>% left_join(prop.house.price, by = c('Time', 'Year'), suffix = c('.apt.rent', '.house.price')) %>% left_join( prop.house.built, by = c('Time', 'Year'), suffix = c('.', '.house.built')) %>% left_join(., prop.house.rent, by = c('Time', 'Year'), suffix = c('.', '.house.rent'))
1542649886369:prop.filter.buy <- filter(prop.cols, (Trend.house.price > Trend.house.rent & Trend.house.price > Trend.apt.rent & Trend. > Trend.house.rent & Trend. > Trend.apt.rent))
1542649886378:prop.filter.rent <- filter(prop.cols, (Trend.house.price < Trend.house.rent & Trend.house.price < Trend.apt.rent & Trend. < Trend.house.rent & Trend. < Trend.apt.rent))
1542649886411:min.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == min(Trend))
1542649886429:max.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == max(Trend))
1542649886447:prop.extreme <- left_join(min.prop, max.prop, by = 'Category', suffix = c('.min', '.max'))[c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max', 'Trend.max', 'Time.max')]
1542649886459:prop.extreme <- prop.extreme %>% mutate(Trend.diff = Trend.max-Trend.min)
1542649886470:employ.extreme.con <- employ.extreme %>% filter(., Sector == 'Construction') %>% setNames(c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max',  'Trend.max', 'Time.max', 'Trend.diff'))
1542649886480:kable(bind_rows(prop.extreme, employ.extreme.con), digits = 2)
1542649886598:stations <- GET('https://api.jcdecaux.com/vls/v1/stations?apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542649886994:http_type(stations)
1542649887000:stations.df <- jsonlite::fromJSON(content(stations, 'text'), simplifyVector = TRUE)
1542649887129:#count(stations.df, vars = 'contract_name')
1542649887137:bike <- GET('https://api.jcdecaux.com/vls/v1/stations?contract=Dublin&apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542649887286:http_type(bike)
1542649887292:bike.df <- jsonlite::fromJSON(content(bike, 'text'), simplifyVector = TRUE)
1542649887325:sum.bike <- summary(bike.df)
1542649887347:#filter(bike.df, banking==FALSE)
1542649887555:#bike.df[bike.df$banking==F]
1542649887557:#bike.df[bike.df$address=='Smithfield North']
1542649887561:#bike.df$address=='Smithfield North'
1542649887563:#bike.df$banking
1542649887571:bike.df <- bike.df[order(bike.df$number),]
1542649887587:#bike.df
1542649887594:str(bike.df)
1542649887750:qplot(available_bikes, name, data = bike.df , colour = banking, size=I(3))
1542649888094:unzip('DublinBus.zip')
1542649889143:trips.df <- read_csv('googletransitdublinbusp20130315-1546\\trips.txt')
1542649889174:routes.df <- read_csv('googletransitdublinbusp20130315-1546\\routes.txt')
1542649889198:calendar.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar.txt')
1542649889229:calendar_dates.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar_dates.txt')
1542649889344:shapes.df <- read_csv('googletransitdublinbusp20130315-1546\\shapes.txt')
1542649889485:stops.df <- read_csv('googletransitdublinbusp20130315-1546\\stops.txt')
1542649889565:transfers.df <- read_csv('googletransitdublinbusp20130315-1546\\transfers.txt')
1542649889631:agency.df <- read_csv('googletransitdublinbusp20130315-1546\\agency.txt')
1542649889698:stop_times.df <- read_csv('googletransitdublinbusp20130315-1546\\stop_times.txt')
1542649895751:route.num.trip <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542649895817:ggplot(data=route.num.trip, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542649896709:#common join used at multiple points in the code
1542649896712:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542649897626:#calculating the unit of distance in the dataset
1542649897628:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542649897687:#calculating the route lengths
1542649897690:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542649897930:# base df that most and least frequent routes and mean length is based on
1542649897933:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, Service, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, Service, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, Service, Freq) %>% group_by(Service)
1542649898106:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542649898113:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542649898189:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542649898197:extreme.freq <- rbind(most.freq, leastfreq) %>% select(Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., Service, Freq)
1542649898262:kable(extreme.freq)
1542649898432:##trying to figure out first and last bus - getting bogged down
1542649898434:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 #~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% #mutate(actual.time=case_when(arrival_time < as.hms('04:00:00') ~ arrival_time+as.hms('24:00:00')))  %>% #filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% arrange(arrival_time)
1542649898437:#library(hms)
1542649898440:#typeof(as.hms('04:00:00'))
1542649898446:#%>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542649898449:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41) %>% select(Service, route_short_name, service_id, arrival_time, departure_time)  %>% distinct() %>% arrange(arrival_time)
1542649898457:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542649898467:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542649898481:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542649898494:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest)
1542649898501:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542649898503:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542649898506:bottom = (min(stops.df$stop_lat) - 0.01),
1542649898508:right = (max(stops.df$stop_lon) + 0.01),
1542649898510:top = (max(stops.df$stop_lat) + 0.01))
1542649898514:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542649900914:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542649901645:home.route <- 49
1542649901650:bus.home <- bus.join %>% filter(route_short_name==home.route, Service=='Weekday')
1542649901960:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542649901999:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542649902122:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542649902132:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(lead(arrival_time) - arrival_time)/60) %>% mutate(length.dist=(lead(shape_dist_traveled) - shape_dist_traveled)/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542649902157:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542649902288:kable(bus.join %>% group_by(Service, stop_headsign) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(earliest.bus=min(arrival_time), latest.bus= max(arrival_time)))
1542649902591:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542649902756:stops.home <- bus.join.sat %>% filter(route_short_name==home.route)
1542649903215:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by = c("route_short_name.intersect" = "route_short_name")) %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542649903352:intersect.routes <- rbind((stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))), (stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route)))) %>% select(Route, Longitude, Latitude)
1542649903429:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542649903433:dublin_intersect_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542649903436:bottom = (min(stops.intersect$Latitude) - 0.01),
1542649903440:right = (max(stops.intersect$Longitude) + 0.01),
1542649903443:top = (max(stops.intersect$Latitude) + 0.01))
1542649903448:dublin_intersect_stamen <- get_stamenmap(bbox = dublin_intersect_bb, zoom = 11,  maptype = 'toner-lite')
1542649904299:ggmap(dublin_intersect_stamen, legend = 'right') + geom_point(data = intersect.routes, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542649905030:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542649905327:download.file(url.footfall, 'footfall_ods.ods')
1542649906392:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542649906396:camera2.name <- 'Entrance Name: South Great Georges'
1542649906403:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542649907191:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542649907200:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649907210:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542649907220:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649907229:#1:length(sheet.names)
1542649907232:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542649907237:colnames(i.length) <- c('i')
1542649907242:for(i in 1:10)
1542649907244:{
1542649907245:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542649907249:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649907253:camera1.row <- which(grepl(camera1.name, f1$Time))
1542649907256:camera2.row <- which(grepl(camera2.name, f1$Time))
1542649907260:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542649907262:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542649907267:camera1.all <- rbind(camera1.all, camera1.slice)
1542649907269:camera2.all <- rbind(camera2.all, camera2.slice)
1542649907272:}
1542649955922:camera1.all
1542649955949:camera2.all
1542649956080:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542649956087:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542649956090:camera2.name <- 'Entrance Name: South Great Georges'
1542649956094:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542649957063:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542649957077:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649957087:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542649957097:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649957111:i=4
1542649957115:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542649963122:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649963190:camera1.row <- which(grepl(camera1.name, f1$Time))
1542649963194:camera2.row <- which(grepl(camera2.name, f1$Time))
1542649963200:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542649963269:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542649963384:camera1.all <- rbind(camera1.all, camera1.slice)
1542649963396:camera2.all <- rbind(camera2.all, camera2.slice)
1542649963407:camera1.all
1542649963468:camera2.all
1542649963479:i
1542649963489:x[1]
1542649995847:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542649995851:camera2.name <- 'Entrance Name: South Great Georges'
1542649995855:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542649996618:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542649996627:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649996636:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542649996645:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649996654:#1:length(sheet.names)
1542649996660:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542649996843:colnames(i.length) <- c('i')
1542649996848:for(i in 11:20)
1542649996850:{
1542649996852:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542649996856:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542649996859:camera1.row <- which(grepl(camera1.name, f1$Time))
1542649996861:camera2.row <- which(grepl(camera2.name, f1$Time))
1542649996865:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542649996867:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542649996872:camera1.all <- rbind(camera1.all, camera1.slice)
1542649996874:camera2.all <- rbind(camera2.all, camera2.slice)
1542649996876:}
1542650037255:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542650037259:camera2.name <- 'Entrance Name: South Great Georges'
1542650037263:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542650038068:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542650038078:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650038087:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542650038268:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650038277:#1:length(sheet.names)
1542650038283:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542650038287:colnames(i.length) <- c('i')
1542650038292:for(i in 1:26)
1542650038294:{
1542650038296:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542650038351:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650038355:camera1.row <- which(grepl(camera1.name, f1$Time))
1542650038357:camera2.row <- which(grepl(camera2.name, f1$Time))
1542650038362:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542650038364:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542650038369:camera1.all <- rbind(camera1.all, camera1.slice)
1542650038371:camera2.all <- rbind(camera2.all, camera2.slice)
1542650038374:}
1542650154537:camera1.all
1542650154644:camera2.all
1542650154752:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542650236053:sheet.names
1542650280331:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542650280336:camera2.name <- 'Entrance Name: South Great Georges'
1542650280340:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542650281008:#change sheet 13 to week 13
1542650281011:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542650281020:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650281055:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542650281065:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650281074:#1:length(sheet.names)
1542650281076:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542650281080:colnames(i.length) <- c('i')
1542650281086:for(i in 27:52)
1542650281088:{
1542650281090:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542650281094:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650281098:camera1.row <- which(grepl(camera1.name, f1$Time))
1542650281100:camera2.row <- which(grepl(camera2.name, f1$Time))
1542650281103:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542650281105:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542650281109:camera1.all <- rbind(camera1.all, camera1.slice)
1542650281111:camera2.all <- rbind(camera2.all, camera2.slice)
1542650281115:i.length <- bind(i.length, i)
1542650281117:}
1542650302457:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542650302461:camera2.name <- 'Entrance Name: South Great Georges'
1542650302465:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542650303179:#change sheet 13 to week 13
1542650303181:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542650303192:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650303201:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542650303210:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650303359:#1:length(sheet.names)
1542650303362:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542650303367:colnames(i.length) <- c('i')
1542650303371:for(i in 27:52)
1542650303374:{
1542650303376:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542650303380:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650303434:camera1.row <- which(grepl(camera1.name, f1$Time))
1542650303437:camera2.row <- which(grepl(camera2.name, f1$Time))
1542650303441:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542650303443:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542650303447:camera1.all <- rbind(camera1.all, camera1.slice)
1542650303449:camera2.all <- rbind(camera2.all, camera2.slice)
1542650303453:i.length <- rbind(i.length, i)
1542650303455:}
1542650454492:(52-27)/2
1542650458391:27+12
1542650470451:i.length
1542650490363:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542650490367:camera2.name <- 'Entrance Name: South Great Georges'
1542650490372:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542650491086:#change sheet 13 to week 13
1542650491088:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542650491097:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650491106:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542650491115:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650491127:#1:length(sheet.names)
1542650491130:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542650491134:colnames(i.length) <- c('i')
1542650491138:for(i in 27:35)
1542650491141:{
1542650491193:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542650491198:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542650491202:camera1.row <- which(grepl(camera1.name, f1$Time))
1542650491204:camera2.row <- which(grepl(camera2.name, f1$Time))
1542650491209:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542650491211:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542650491216:camera1.all <- rbind(camera1.all, camera1.slice)
1542650491218:camera2.all <- rbind(camera2.all, camera2.slice)
1542650491222:i.length <- rbind(i.length, i)
1542650491225:}
1542650537665:camera1.all
1542651073612:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542651073616:options(digits=2)
1542651073681:library(devtools)
1542651074402:library(readr)
1542651074474:library(ggplot2)
1542651074666:library(ggmap)
1542651074782:devtools::install_github('hadley/ggplot2')
1542651075970:devtools::install_github('dkahle/ggmap')
1542651076478:library(rnoaa)
1542651076867:library(httr)
1542651076876:library(plyr)
1542651076886:library(jsonlite)
1542651076895:library(dplyr)
1542651077054:library(readODS)
1542651077079:library(knitr)
1542651077088:library(hms)
1542651107895:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542651107899:download.file(url.footfall, 'footfall_ods.ods')
1542651112895:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651112899:camera2.name <- 'Entrance Name: South Great Georges'
1542651112903:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651113617:#change sheet 13 to week 13
1542651113620:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651113631:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651113640:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651113649:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651113711:#1:length(sheet.names)
1542651113715:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651113720:colnames(i.length) <- c('i')
1542651113725:for(i in 1:10)
1542651113727:{
1542651113730:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651113784:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651113788:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651113791:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651113795:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651113797:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651113801:camera1.all <- rbind(camera1.all, camera1.slice)
1542651113803:camera2.all <- rbind(camera2.all, camera2.slice)
1542651113807:i.length <- rbind(i.length, i)
1542651113809:}
1542651155749:camera1.all
1542651155774:camera2.all
1542651155861:i.length
1542651155867:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542651196836:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651196840:camera2.name <- 'Entrance Name: South Great Georges'
1542651196845:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651197571:#change sheet 13 to week 13
1542651197574:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651197582:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651197592:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651197601:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651197888:#1:length(sheet.names)
1542651197892:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651197897:colnames(i.length) <- c('i')
1542651197902:for(i in 1:52)
1542651197904:{
1542651197907:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651197911:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651197915:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651197918:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651197922:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651197924:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651197927:camera1.all <- rbind(camera1.all, camera1.slice)
1542651197930:camera2.all <- rbind(camera2.all, camera2.slice)
1542651197934:i.length <- rbind(i.length, i)
1542651197936:}
1542651457455:i.length
1542651482306:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651482310:camera2.name <- 'Entrance Name: South Great Georges'
1542651482315:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651483079:#change sheet 13 to week 13
1542651483082:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651483145:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651483158:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651483170:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651483183:#1:length(sheet.names)
1542651483186:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651483240:colnames(i.length) <- c('i')
1542651483439:for(i in 44:45)
1542651483442:{
1542651483444:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651483449:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651483453:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651483455:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651483459:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651483461:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651483465:camera1.all <- rbind(camera1.all, camera1.slice)
1542651483467:camera2.all <- rbind(camera2.all, camera2.slice)
1542651483471:i.length <- rbind(i.length, i)
1542651483473:}
1542651491868:camera1.all
1542651491879:camera2.all
1542651491900:i.length
1542651491907:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542651525336:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651525339:camera2.name <- 'Entrance Name: South Great Georges'
1542651525343:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651526091:#change sheet 13 to week 13
1542651526094:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651526104:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651526113:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651526122:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651526184:#1:length(sheet.names)
1542651526187:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651526192:colnames(i.length) <- c('i')
1542651526197:for(i in 46:52)
1542651526199:{
1542651526202:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651526206:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651526210:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651526212:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651526216:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651526219:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651526222:camera1.all <- rbind(camera1.all, camera1.slice)
1542651526225:camera2.all <- rbind(camera2.all, camera2.slice)
1542651526279:i.length <- rbind(i.length, i)
1542651526281:}
1542651539676:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651539679:camera2.name <- 'Entrance Name: South Great Georges'
1542651539683:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651540398:#change sheet 13 to week 13
1542651540400:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651540410:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651540418:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651540426:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651540437:#1:length(sheet.names)
1542651540441:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651540445:colnames(i.length) <- c('i')
1542651540449:for(i in 47:52)
1542651540452:{
1542651540454:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651540510:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651540515:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651540517:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651540521:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651540524:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651540529:camera1.all <- rbind(camera1.all, camera1.slice)
1542651540531:camera2.all <- rbind(camera2.all, camera2.slice)
1542651540536:i.length <- rbind(i.length, i)
1542651540538:}
1542651591496:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651591500:camera2.name <- 'Entrance Name: South Great Georges'
1542651591504:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651592288:#change sheet 13 to week 13
1542651592290:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651592301:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651592310:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651592371:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651592384:#1:length(sheet.names)
1542651592387:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651592391:colnames(i.length) <- c('i')
1542651592396:for(i in 48:52)
1542651592398:{
1542651592401:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651592405:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651592459:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651592461:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651592466:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651592469:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651592473:camera1.all <- rbind(camera1.all, camera1.slice)
1542651592475:camera2.all <- rbind(camera2.all, camera2.slice)
1542651592480:i.length <- rbind(i.length, i)
1542651592482:}
1542651614682:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651614691:camera2.name <- 'Entrance Name: South Great Georges'
1542651614695:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651615462:#change sheet 13 to week 13
1542651615465:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651615474:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651615483:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651615492:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651615505:#1:length(sheet.names)
1542651615508:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651615563:colnames(i.length) <- c('i')
1542651615568:for(i in 52:45)
1542651615570:{
1542651615572:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651615577:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651615581:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651615584:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651615587:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651615590:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651615594:camera1.all <- rbind(camera1.all, camera1.slice)
1542651615596:camera2.all <- rbind(camera2.all, camera2.slice)
1542651615600:i.length <- rbind(i.length, i)
1542651615603:}
1542651636325:i.length
1542651650332:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651650336:camera2.name <- 'Entrance Name: South Great Georges'
1542651650340:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651651055:#change sheet 13 to week 13
1542651651058:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651651068:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651651077:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651651086:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651651148:#1:length(sheet.names)
1542651651151:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651651156:colnames(i.length) <- c('i')
1542651651161:for(i in 50)
1542651651163:{
1542651651166:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651651170:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651651174:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651651176:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651651181:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651651183:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651651187:camera1.all <- rbind(camera1.all, camera1.slice)
1542651651189:camera2.all <- rbind(camera2.all, camera2.slice)
1542651651193:i.length <- rbind(i.length, i)
1542651651246:}
1542651665581:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651665585:camera2.name <- 'Entrance Name: South Great Georges'
1542651665589:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651666303:#change sheet 13 to week 13
1542651666305:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651666314:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651666505:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651666615:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651666628:#1:length(sheet.names)
1542651666631:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651666635:colnames(i.length) <- c('i')
1542651666640:for(i in 51)
1542651666642:{
1542651666644:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651666648:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651666653:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651666705:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651666710:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651666712:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651666717:camera1.all <- rbind(camera1.all, camera1.slice)
1542651666719:camera2.all <- rbind(camera2.all, camera2.slice)
1542651666723:i.length <- rbind(i.length, i)
1542651666726:}
1542651670847:camera1.all
1542651670857:camera2.all
1542651670871:i.length
1542651670877:#50
1542651670931:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542651688179:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651688183:camera2.name <- 'Entrance Name: South Great Georges'
1542651688186:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651688933:#change sheet 13 to week 13
1542651688936:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651688946:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651688954:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651689198:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651689226:#1:length(sheet.names)
1542651689279:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651689284:colnames(i.length) <- c('i')
1542651689339:for(i in 49)
1542651689342:{
1542651689344:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651689349:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651689353:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651689355:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651689359:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651689362:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651689366:camera1.all <- rbind(camera1.all, camera1.slice)
1542651689368:camera2.all <- rbind(camera2.all, camera2.slice)
1542651689371:i.length <- rbind(i.length, i)
1542651689373:}
1542651704301:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651704304:camera2.name <- 'Entrance Name: South Great Georges'
1542651704308:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651704973:#change sheet 13 to week 13
1542651704975:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651704984:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651704994:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651705002:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651705013:#1:length(sheet.names)
1542651705016:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651705021:colnames(i.length) <- c('i')
1542651705025:for(i in 48)
1542651705027:{
1542651705029:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651705033:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651705037:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651705039:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651705043:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651705046:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651705050:camera1.all <- rbind(camera1.all, camera1.slice)
1542651705052:camera2.all <- rbind(camera2.all, camera2.slice)
1542651705056:i.length <- rbind(i.length, i)
1542651705108:}
1542651709242:camera1.all
1542651709252:camera2.all
1542651709264:i.length
1542651709270:#50, 49
1542651709273:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542651724771:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651724776:camera2.name <- 'Entrance Name: South Great Georges'
1542651724780:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651725431:#change sheet 13 to week 13
1542651725433:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651725441:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651725451:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651725460:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651725473:#1:length(sheet.names)
1542651725476:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651725480:colnames(i.length) <- c('i')
1542651725484:for(i in 47)
1542651725486:{
1542651725488:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651725492:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651725495:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651725497:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651725501:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651725503:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651725507:camera1.all <- rbind(camera1.all, camera1.slice)
1542651725508:camera2.all <- rbind(camera2.all, camera2.slice)
1542651725512:i.length <- rbind(i.length, i)
1542651725514:}
1542651742807:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651742811:camera2.name <- 'Entrance Name: South Great Georges'
1542651742815:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651743502:#change sheet 13 to week 13
1542651743505:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651743514:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651743523:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651743532:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651743674:#1:length(sheet.names)
1542651743677:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651743682:colnames(i.length) <- c('i')
1542651743686:for(i in 46)
1542651743688:{
1542651743690:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651743694:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651743698:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651743700:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651743704:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651743707:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651743710:camera1.all <- rbind(camera1.all, camera1.slice)
1542651743713:camera2.all <- rbind(camera2.all, camera2.slice)
1542651743717:i.length <- rbind(i.length, i)
1542651743719:}
1542651763490:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651763494:camera2.name <- 'Entrance Name: South Great Georges'
1542651763498:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651764251:#change sheet 13 to week 13
1542651764254:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651764264:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651764273:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651764332:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651764344:#1:length(sheet.names)
1542651764347:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651764352:colnames(i.length) <- c('i')
1542651764356:for(i in 45)
1542651764358:{
1542651764361:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651764365:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651764369:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651764371:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651764375:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651764377:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651764381:camera1.all <- rbind(camera1.all, camera1.slice)
1542651764383:camera2.all <- rbind(camera2.all, camera2.slice)
1542651764387:i.length <- rbind(i.length, i)
1542651764389:}
1542651769363:camera1.all
1542651769373:camera2.all
1542651769384:i.length
1542651769391:#50, 49, 47, 46
1542651769394:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542651778111:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542651778115:camera2.name <- 'Entrance Name: South Great Georges'
1542651778119:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542651778827:#change sheet 13 to week 13
1542651778829:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651778838:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651778846:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542651778854:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651778867:#1:length(sheet.names)
1542651778869:i.length <- data.frame(matrix(ncol = 1, nrow = 0))
1542651778873:colnames(i.length) <- c('i')
1542651778878:for(i in 44)
1542651778880:{
1542651778882:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542651778886:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542651778890:camera1.row <- which(grepl(camera1.name, f1$Time))
1542651778892:camera2.row <- which(grepl(camera2.name, f1$Time))
1542651778895:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[i])
1542651778898:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[i])
1542651778901:camera1.all <- rbind(camera1.all, camera1.slice)
1542651778904:camera2.all <- rbind(camera2.all, camera2.slice)
1542651778907:i.length <- rbind(i.length, i)
1542651778910:}
1542651783065:camera1.all
1542651783075:camera2.all
1542651783139:i.length
1542651783145:#50, 49, 47, 46
1542651783148:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542651876427:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542651880445:f45 <- read_ods('pedestrianfootfall2013.ods',sheet.names[45])
1542651884969:f47 <- read_ods('pedestrianfootfall2013.ods',sheet.names[47])
1542651889373:f49 <- read_ods('pedestrianfootfall2013.ods',sheet.names[49])
1542651894580:f50 <- read_ods('pedestrianfootfall2013.ods',sheet.names[50])
1542651936299:f1
1542651936387:f45
1542651936423:f47
1542651936512:f49
1542651936553:f50
1542652014142:?f
1542652016887:?if
1542652028049:?if
1542652282100:f1$Time
1542652297957:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542652302240:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652302256:f45 <- read_ods('pedestrianfootfall2013.ods',sheet.names[45])
1542652306995:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652306995:f47 <- read_ods('pedestrianfootfall2013.ods',sheet.names[47])
1542652311032:f49 <- read_ods('pedestrianfootfall2013.ods',sheet.names[49])
1542652315121:f50 <- read_ods('pedestrianfootfall2013.ods',sheet.names[50])
1542652321032:f1$Time
1542652327490:f45
1542652335178:f45$Time
1542652345014:f45 <- read_ods('pedestrianfootfall2013.ods',sheet.names[45])
1542652348996:colnames(f45) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652370551:f45$Time
1542652384761:f1$Time
1542652385238:f45$Time
1542652412915:f1
1542652413053:f45
1542652413090:f47
1542652413133:f49
1542652413175:f50
1542652527618:which(grepl(camera1.name, f45$Time))
1542652534085:f45
1542652534224:which(grepl(camera1.name, f45$Time))
1542652593792:f45
1542652593833:camera1.row <- which(grepl(camera1.name, f45$Time))
1542652593837:slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[45])
1542652624844:f45
1542652624988:camera1.row <- which(grepl(camera1.name, f45$Time))
1542652624991:camera1.row
1542652624996:slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[45])
1542652661268:f45
1542652661409:camera1.row <- which(grepl(camera1.name, f45$Time))
1542652661413:camera1.row
1542652661417:slice(f45, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[45])
1542652696523:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542652696527:camera2.name <- 'Entrance Name: South Great Georges'
1542652696531:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542652697300:#change sheet 13 to week 13
1542652697301:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542652697353:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652697362:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542652697369:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652697369:#1:length(sheet.names)
1542652697384:for(week.i in 44)
1542652697384:{
1542652697491:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542652697491:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652697491:camera1.row <- which(grepl(camera1.name, f1$Time))
1542652697491:camera2.row <- which(grepl(camera2.name, f1$Time))
1542652697491:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542652697506:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542652697506:camera1.all <- rbind(camera1.all, camera1.slice)
1542652697506:camera2.all <- rbind(camera2.all, camera2.slice)
1542652697506:f1 <- NULL
1542652697506:}
1542652701668:camera1.all
1542652701675:camera2.all
1542652701691:#50, 49, 47, 46
1542652701691:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542652713756:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542652713756:camera2.name <- 'Entrance Name: South Great Georges'
1542652713756:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542652714515:#change sheet 13 to week 13
1542652714515:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542652714531:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652714546:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542652714555:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652714558:#1:length(sheet.names)
1542652714558:for(week.i in 45)
1542652714558:{
1542652714573:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542652714573:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652714573:camera1.row <- which(grepl(camera1.name, f1$Time))
1542652714573:camera2.row <- which(grepl(camera2.name, f1$Time))
1542652714573:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542652714591:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542652714595:camera1.all <- rbind(camera1.all, camera1.slice)
1542652714597:camera2.all <- rbind(camera2.all, camera2.slice)
1542652714597:f1 <- NULL
1542652714597:}
1542652720223:camera1.all
1542652720239:camera2.all
1542652720256:#50, 49, 47, 46
1542652720256:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542652741610:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542652741612:camera2.name <- 'Entrance Name: South Great Georges'
1542652741612:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542652742350:#change sheet 13 to week 13
1542652742350:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542652742366:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652742366:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542652742387:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652742393:#1:length(sheet.names)
1542652742393:for(week.i in 46)
1542652742393:{
1542652742393:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542652742523:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652742523:camera1.row <- which(grepl(camera1.name, f1$Time))
1542652742523:camera2.row <- which(grepl(camera2.name, f1$Time))
1542652742523:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542652742538:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542652742538:camera1.all <- rbind(camera1.all, camera1.slice)
1542652742538:camera2.all <- rbind(camera2.all, camera2.slice)
1542652742538:f1 <- NULL
1542652742538:}
1542652746837:camera1.all
1542652746845:camera2.all
1542652746845:#50, 49, 47, 46
1542652746860:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542652766976:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542652766976:camera2.name <- 'Entrance Name: South Great Georges'
1542652766976:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542652767628:#change sheet 13 to week 13
1542652767628:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542652767644:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652767644:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542652767660:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652767660:#1:length(sheet.names)
1542652767675:for(week.i in 1:52)
1542652767675:{
1542652767675:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542652767728:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542652767732:camera1.row <- which(grepl(camera1.name, f1$Time))
1542652767735:camera2.row <- which(grepl(camera2.name, f1$Time))
1542652767738:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542652767740:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542652767846:camera1.all <- rbind(camera1.all, camera1.slice)
1542652767849:camera2.all <- rbind(camera2.all, camera2.slice)
1542652767855:f1 <- NULL
1542652767858:}
1542652994168:camera1.all
1542652994297:camera2.all
1542652994422:#50, 49, 47, 46
1542652994426:#read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>%
1542653110603:select(camera1.all, Week) %>%distinct()
1542653137009:filter(camera1.all, Week=='Week_52')
1542656898379:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542656898383:options(digits=2)
1542656898467:library(devtools)
1542656899843:library(readr)
1542656899922:library(ggplot2)
1542656900141:library(ggmap)
1542656900196:devtools::install_github('hadley/ggplot2')
1542656901583:devtools::install_github('dkahle/ggmap')
1542656902059:library(rnoaa)
1542656902396:library(httr)
1542656902406:library(plyr)
1542656902416:library(jsonlite)
1542656902426:library(dplyr)
1542656902439:library(readODS)
1542656902509:library(knitr)
1542656902523:library(hms)
1542656902539:employ.read <- read_delim('dublin employment trends.txt', ':')
1542656902652:qplot(data = employ.read , x = Time , y = Employment, geom = 'line', xlab = 'Quarterly Figures', ylab = 'Trend', main = 'Dublin Employment Trends Per Sector: 2006 - 2016') + facet_grid ( .~ Sector)
1542656903130:min.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == min(Employment))
1542656903167:max.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == max(Employment))
1542656903192:employ.extreme <- left_join(min.employ, max.employ, by = 'Sector', suffix = c('.min', '.max'))[c('Sector', 'QuarterYear.min', 'Employment.min', 'Time.min', 'QuarterYear.max', 'Employment.max', 'Time.max')]
1542656903411:employ.extreme <- employ.extreme %>% mutate(Employment.diff = Employment.max-Employment.min)
1542656903433:kable(employ.extreme, digits = 2)
1542656904062:prop.read <- read_tsv('dublin property trends.txt')
1542656904084:qplot(data = prop.read , x = Time , y = Trend, geom = 'line', colour = Category, xlab = 'Time', ylab = 'Trend', main = 'Dublin Property Trends: 2007 - 2016')
1542656904505:prop.split <- split(prop.read, prop.read$Category)
1542656904690:prop.apt.rent <- select(prop.split[[1]], Time, Year, Trend, Category)
1542656904700:prop.house.price <- select(prop.split[[2]], Time, Year, Trend, Category)
1542656904708:prop.house.rent <- select(prop.split[[3]], Time, Year, Trend, Category)
1542656904716:prop.house.built <- select(prop.split[[4]], Time, Year, Trend, Category)
1542656904724:prop.cols <- prop.apt.rent %>% left_join(prop.house.price, by = c('Time', 'Year'), suffix = c('.apt.rent', '.house.price')) %>% left_join( prop.house.built, by = c('Time', 'Year'), suffix = c('.', '.house.built')) %>% left_join(., prop.house.rent, by = c('Time', 'Year'), suffix = c('.', '.house.rent'))
1542656904739:prop.filter.buy <- filter(prop.cols, (Trend.house.price > Trend.house.rent & Trend.house.price > Trend.apt.rent & Trend. > Trend.house.rent & Trend. > Trend.apt.rent))
1542656904779:prop.filter.rent <- filter(prop.cols, (Trend.house.price < Trend.house.rent & Trend.house.price < Trend.apt.rent & Trend. < Trend.house.rent & Trend. < Trend.apt.rent))
1542656904796:min.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == min(Trend))
1542656904815:max.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == max(Trend))
1542656904833:prop.extreme <- left_join(min.prop, max.prop, by = 'Category', suffix = c('.min', '.max'))[c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max', 'Trend.max', 'Time.max')]
1542656904850:prop.extreme <- prop.extreme %>% mutate(Trend.diff = Trend.max-Trend.min)
1542656904863:employ.extreme.con <- employ.extreme %>% filter(., Sector == 'Construction') %>% setNames(c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max',  'Trend.max', 'Time.max', 'Trend.diff'))
1542656904924:kable(bind_rows(prop.extreme, employ.extreme.con), digits = 2)
1542656905042:stations <- GET('https://api.jcdecaux.com/vls/v1/stations?apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542656905469:http_type(stations)
1542656905477:stations.df <- jsonlite::fromJSON(content(stations, 'text'), simplifyVector = TRUE)
1542656905794:#count(stations.df, vars = 'contract_name')
1542656905804:bike <- GET('https://api.jcdecaux.com/vls/v1/stations?contract=Dublin&apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542656905977:http_type(bike)
1542656905984:bike.df <- jsonlite::fromJSON(content(bike, 'text'), simplifyVector = TRUE)
1542656906023:sum.bike <- summary(bike.df)
1542656906049:#filter(bike.df, banking==FALSE)
1542656906053:#bike.df[bike.df$banking==F]
1542656906058:#bike.df[bike.df$address=='Smithfield North']
1542656906062:#bike.df$address=='Smithfield North'
1542656906066:#bike.df$banking
1542656906077:bike.df <- bike.df[order(bike.df$number),]
1542656906101:#bike.df
1542656906112:str(bike.df)
1542656906595:qplot(available_bikes, name, data = bike.df , colour = banking, size=I(3))
1542656907041:unzip('DublinBus.zip')
1542656907955:trips.df <- read_csv('googletransitdublinbusp20130315-1546\\trips.txt')
1542656907982:routes.df <- read_csv('googletransitdublinbusp20130315-1546\\routes.txt')
1542656908010:calendar.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar.txt')
1542656908131:calendar_dates.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar_dates.txt')
1542656908145:shapes.df <- read_csv('googletransitdublinbusp20130315-1546\\shapes.txt')
1542656908260:stops.df <- read_csv('googletransitdublinbusp20130315-1546\\stops.txt')
1542656908282:transfers.df <- read_csv('googletransitdublinbusp20130315-1546\\transfers.txt')
1542656908346:agency.df <- read_csv('googletransitdublinbusp20130315-1546\\agency.txt')
1542656908414:stop_times.df <- read_csv('googletransitdublinbusp20130315-1546\\stop_times.txt')
1542656910196:route.num.trip <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542656910224:ggplot(data=route.num.trip, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542656910817:#common join used at multiple points in the code
1542656910820:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542656911669:#calculating the unit of distance in the dataset
1542656911672:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542656911727:#calculating the route lengths
1542656911730:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542656912037:# base df that most and least frequent routes and mean length is based on
1542656912040:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, Service, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, Service, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, Service, Freq) %>% group_by(Service)
1542656912194:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542656912202:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542656912211:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542656912286:extreme.freq <- rbind(most.freq, leastfreq) %>% select(Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., Service, Freq)
1542656912300:kable(extreme.freq)
1542656912417:##trying to figure out first and last bus - getting bogged down
1542656912420:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 #~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% #mutate(actual.time=case_when(arrival_time < as.hms('04:00:00') ~ arrival_time+as.hms('24:00:00')))  %>% #filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% arrange(arrival_time)
1542656912423:#library(hms)
1542656912425:#typeof(as.hms('04:00:00'))
1542656912429:#%>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542656912431:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41) %>% select(Service, route_short_name, service_id, arrival_time, departure_time)  %>% distinct() %>% arrange(arrival_time)
1542656912439:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542656912450:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542656912465:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542656912478:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest)
1542656912640:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542656912643:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542656912645:bottom = (min(stops.df$stop_lat) - 0.01),
1542656912647:right = (max(stops.df$stop_lon) + 0.01),
1542656912649:top = (max(stops.df$stop_lat) + 0.01))
1542656912653:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542656914952:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542656915598:home.route <- 49
1542656915603:bus.home <- bus.join %>% filter(route_short_name==home.route, Service=='Weekday')
1542656915744:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542656915780:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542656915903:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542656915916:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(lead(arrival_time) - arrival_time)/60) %>% mutate(length.dist=(lead(shape_dist_traveled) - shape_dist_traveled)/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542656915951:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542656916082:kable(bus.join %>% group_by(Service, stop_headsign) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(earliest.bus=min(arrival_time), latest.bus= max(arrival_time)))
1542656916291:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542656916374:stops.home <- bus.join.sat %>% filter(route_short_name==home.route)
1542656916414:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by = c("route_short_name.intersect" = "route_short_name")) %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542656916539:intersect.routes <- rbind((stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))), (stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route)))) %>% select(Route, Longitude, Latitude)
1542656916563:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542656916565:dublin_intersect_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542656916568:bottom = (min(stops.intersect$Latitude) - 0.01),
1542656916570:right = (max(stops.intersect$Longitude) + 0.01),
1542656916572:top = (max(stops.intersect$Latitude) + 0.01))
1542656916576:dublin_intersect_stamen <- get_stamenmap(bbox = dublin_intersect_bb, zoom = 11,  maptype = 'toner-lite')
1542656917576:ggmap(dublin_intersect_stamen, legend = 'right') + geom_point(data = intersect.routes, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542656918312:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542656918316:download.file(url.footfall, 'footfall_ods.ods')
1542656920110:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542656920115:camera2.name <- 'Entrance Name: South Great Georges'
1542656920119:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542656920929:#change sheet 13 to week 13
1542656920931:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542656920943:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542656921006:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542656921068:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542656921134:#1:length(sheet.names)
1542656921138:for(week.i in 1:52)
1542656921141:{
1542656921144:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542656921148:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542656921253:camera1.row <- which(grepl(camera1.name, f1$Time))
1542656921256:camera2.row <- which(grepl(camera2.name, f1$Time))
1542656921258:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542656921261:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542656921265:camera1.all <- rbind(camera1.all, camera1.slice)
1542656921267:camera2.all <- rbind(camera2.all, camera2.slice)
1542656921272:f1 <- NULL
1542656921274:}
1542657152452:camera1.all
1542657152586:camera2.all
1542657361849:/which
1542657365736:?which
1542657395781:camera1.all
1542657539556:filter(camera1.all, Mon.In:Sun.Out)
1542657546681:select(camera1.all, Mon.In:Sun.Out)
1542657559533:?mutate
1542657597958:?colSums
1542657615025:camera1.all %>% mutate(sum.all=colSums(select(camera1.all, Mon.In:Sun.Out)))
1542657640062:colSums(select(camera1.all, Mon.In:Sun.Out))
1542657658588:select(camera1.all, Mon.In:Sun.Out)
1542657710035:x <- select(camera1.all, Mon.In:Sun.Out)
1542657710293:colSums(x)
1542657720987:select(camera1.all, Mon.In:Sun.Out)
1542657753131:x <- select(camera1.all, Mon.In:Wed.Out)
1542657753282:colSums(x)
1542657762753:x <- select(camera1.all, Mon.In:Mon.Out)
1542657762753:colSums(x)
1542657777269:rowSums(x)
1542657840532:camera1.all %>% summarise(min(Mon.In), max(Mon.In))
1542657898560:camera1.all %>% summarise(min(Mon.In), max(Mon.In))
1542657898568:camera1.all %>% summarise(min(Tue.In), max(Tue.In))
1542657898580:camera1.all %>% summarise(min(Wed.In), max(Wed.In))
1542657898588:camera1.all %>% summarise(min(Thurs.In), max(Thurs.In))
1542657898597:camera1.all %>% summarise(min(Fri.In), max(Fri.In))
1542657898606:camera1.all %>% summarise(min(Sat.In), max(Sat.In))
1542657898766:camera1.all %>% summarise(min(Sun.In), max(Sun.In))
1542657898784:mutate(sum.all=colSums(select(camera1.all, Mon.In:Sun.Out)))
1542657931420:camera1.all %>% summarise(min(Mon.In), max(Mon.In))
1542657931429:camera1.all %>% summarise(min(Tue.In), max(Tue.In))
1542657931439:camera1.all %>% summarise(min(Wed.In), max(Wed.In))
1542657931448:camera1.all %>% summarise(min(Thurs.In), max(Thurs.In))
1542657931456:camera1.all %>% summarise(min(Fri.In), max(Fri.In))
1542657931464:camera1.all %>% summarise(min(Sat.In), max(Sat.In))
1542657931472:camera1.all %>% summarise(min(Sun.In), max(Sun.In))
1542657931482:#mutate(sum.all=colSums(select(camera1.all, Mon.In:Sun.Out)))
1542657931485:select(camera1.all, Mon.In:Sun.Out)
1542657931550:x <- select(camera1.all, Mon.In:Mon.Out)
1542657931557:rowSums(x)
1542657938002:camera1.all %>% summarise(min(Mon.In), max(Mon.In))
1542657938021:camera1.all %>% summarise(min(Tue.In), max(Tue.In))
1542657938029:camera1.all %>% summarise(min(Wed.In), max(Wed.In))
1542657938144:camera1.all %>% summarise(min(Thurs.In), max(Thurs.In))
1542657938308:camera1.all %>% summarise(min(Fri.In), max(Fri.In))
1542657938316:camera1.all %>% summarise(min(Sat.In), max(Sat.In))
1542657938324:camera1.all %>% summarise(min(Sun.In), max(Sun.In))
1542657967941:str(camera1.all)
1542657983567:summary(camera1.all)
1542658063215:as.numeric(camera1.all$Mon.In)
1542658067490:summary(camera1.all)
1542658083343:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542658086459:summary(camera1.all)
1542658101233:camera1.all[Mon.In]
1542658107898:camera1.all[,Mon.In]
1542658119828:camera1.all['Mon.In']
1542658123665:camera1.all[,'Mon.In']
1542658143101:camera1.all['Mon.In', 'Mon.Out']
1542658421171:colnames(camera1.all)
1542658440643:colnames(camera1.all)[2:14]
1542658556003:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542658556007:camera2.name <- 'Entrance Name: South Great Georges'
1542658556007:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542658556985:#change sheet 13 to week 13
1542658556987:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542658556996:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542658557005:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542658557006:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542658557022:for(week.i in 1:length(sheet.names))
1542658557022:{
1542658557022:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542658557022:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542658557037:camera1.row <- which(grepl(camera1.name, f1$Time))
1542658557037:camera2.row <- which(grepl(camera2.name, f1$Time))
1542658557037:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542658557037:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542658557037:camera1.all <- rbind(camera1.all, camera1.slice)
1542658557037:camera2.all <- rbind(camera2.all, camera2.slice)
1542658557053:f1 <- NULL
1542658557053:}
1542658777625:camera1.all
1542658777848:camera2.all
1542658867625:summary(camera1.all)
1542658894132:col.change <- colnames(camera1.all)[2:14]
1542658894137:for (col.name in col.change)
1542658894139:{
1542658894142:camera1.all$col.name <- as.numeric(camera1.all$col.name)
1542658894147:}
1542658914224:col.change <- colnames(camera1.all)[2:14]
1542658914229:for (col.name in col.change)
1542658914231:{
1542658914234:col.name
1542658914236:camera1.all$col.name <- as.numeric(camera1.all$col.name)
1542658914240:}
1542658926629:col.change
1542658935939:col.change[1]
1542658981941:col.change <- colnames(camera1.all)[2:14]
1542658981947:for (i in 1:length(col.change))
1542658981949:{
1542658981952:col.name
1542658981954:camera1.all$col.change[i] <- as.numeric(camera1.all$col.change[i])
1542658981959:}
1542658982085:summary(camera1.all)
1542659019127:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542659020920:summary(camera1.all)
1542659033504:for (i in 1:length(col.change))
1542659033508:{
1542659033512:col.name
1542659033515:camera1.all$col.change[i] <- as.numeric(camera1.all$col.change[i])
1542659033521:}
1542659036202:summary(camera1.all)
1542659082365:col.change[1]
1542659102726:summary(camera1.all)
1542659106269:col.change <- colnames(camera1.all)[2:14]
1542659106274:for (i in 1:length(col.change))
1542659106276:{
1542659106278:col.name
1542659106281:camera1.all[col.change[i]] <- as.numeric(camera1.all[col.change[i]])
1542659106285:}
1542659120974:camera1.all[col.change[1]]
1542659129132:camera1.all[col.change[2]]
1542659132821:camera1.all[col.change[3]]
1542659142724:col.change <- colnames(camera1.all)[2:14]
1542659142728:#camera1.all[col.change[3]]
1542659142732:for (i in 1:length(col.change))
1542659142734:{
1542659142736:col.name
1542659142739:camera1.all[col.change[i]] <- as.numeric(camera1.all[col.change[i]])
1542659142743:}
1542659227796:camera1.all[[col.change[1]]]
1542659233612:col.change <- colnames(camera1.all)[2:14]
1542659233612:for (i in 1:length(col.change))
1542659233612:{
1542659233612:camera1.all[[col.change[i]]] <- as.numeric(camera1.all[[col.change[i]]])
1542659233612:}
1542659233745:summary(camera1.all)
1542659327448:for (i in 1:length(col.change))
1542659327448:{
1542659327448:camera1.all[[col.change[i]]] <- as.numeric(camera1.all[[col.change[i]]])
1542659327448:camera2.all[[col.change[i]]] <- as.numeric(camera2.all[[col.change[i]]])
1542659327448:}
1542659327530:summary(camera1.all)
1542659327640:summary(camera2.all)
1542659462441:camera1.all %>% group_by(Week) %>% summarise(rowsum())
1542659478846:camera1.all %>% group_by(Week) %>% summarise()
1542659494408:camera1.all %>% group_by(Week) %>% summarise(, sum())
1542659504394:?summarise
1542659681203:camera1.all %>% group_by(Week) %>% summarise(, sum)
1542659688587:camera1.all %>% group_by(Week) %>% summarise(sum)
1542659718267:?summarise_at
1542659794961:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542659816024:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum) %>% dustinct()
1542659820393:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum) %>% distinct()
1542659954211:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542659970239:camera1.al2 %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542659976779:camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542660066471:camera1.all %>% group_by(Week, Time) %>% summarise_if(., is.numeric, sum)
1542662167751:?rvest
1542662176941:install.packages('rvest')
1542662181408:?rvest
1542662187221:library(rvest)
1542662191378:?rvest
1542662251283:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542662257158:jan
1542662320814:vignette("selectorgadget")
1542662717038:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542662717718:jan
1542662717786:cast <- html_nodes(jan, "td")
1542662717930:length(cast)
1542662729195:cast
1542662776784:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542662776971:jan
1542662776990:cast <- html_nodes(jan, ".city-history-observation .columns")
1542662777015:length(cast)
1542662777020:cast
1542662933878:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542662934528:jan
1542662934545:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542662934547:cast <- html_nodes(jan, "td:nth-child(7) , td:nth-child(1)")
1542662934601:length(cast)
1542662934709:cast
1542663049471:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663049628:jan
1542663049644:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663049650:cast <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(1)")
1542663049679:length(cast)
1542663049686:cast
1542663195222:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663196089:jan
1542663196160:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663196165:cast1 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(1)")
1542663196194:cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663196323:cast1
1542663196329:cast2
1542663358285:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663359392:jan
1542663359409:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663359412:cast1 <- html_nodes(jan, "_ngcontent-c8")
1542663359421:cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663359557:cast1
1542663359563:cast2
1542663610596:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663611462:jan
1542663611481:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663611484:cast1 <- html_nodes(jan, "region-content-observation")
1542663611493:cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663611544:cast1
1542663611549:cast2
1542663623346:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663623567:jan
1542663623583:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663623586:cast1 <- html_nodes(jan, "region-content-observation")
1542663623595:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663623600:cast1
1542663623604:#cast2
1542663630940:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663631112:jan
1542663631128:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663631130:cast1 <- html_nodes(jan, "#region-content-observation")
1542663631139:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663631144:cast1
1542663631149:#cast2
1542663640189:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663640350:jan
1542663640366:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663640369:cast1 <- html_nodes(jan, ".region-content-observation")
1542663640381:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663640385:cast1
1542663640392:#cast2
1542663689693:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663689861:jan
1542663689882:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663689886:cast1 <- html_nodes(jan, ".region-content-observation _ngcontent-c8")
1542663689896:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663689901:cast1
1542663689906:#cast2
1542663695818:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663696074:jan
1542663696149:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663696198:cast1 <- html_nodes(jan, ".region-content-observation ._ngcontent-c8")
1542663696283:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663696497:cast1
1542663696739:#cast2
1542663702409:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663702793:jan
1542663702861:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663702863:cast1 <- html_nodes(jan, ".region-content-observation #_ngcontent-c8")
1542663702875:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663702879:cast1
1542663702884:#cast2
1542663723132:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663723354:jan
1542663723426:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663723501:cast1 <- html_nodes(jan, ".region-content-observation td:_ngcontent-c8")
1542663765784:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663765974:jan
1542663765996:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663766001:cast1 <- html_nodes(jan, ".region-content-observation #inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(1)")
1542663766028:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663766033:cast1
1542663766038:#cast2
1542663780316:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663780490:jan
1542663780506:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663780512:cast1 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(1)")
1542663780540:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663780544:cast1
1542663780549:#cast2
1542663808034:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663808309:jan
1542663808325:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663808327:cast1 <- html_nodes(jan, ".region-content-observation ._ngcontent-c8")
1542663808355:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663808461:cast1
1542663808467:#cast2
1542663817943:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542663818085:jan
1542663818101:#cast <- html_nodes(jan, ".city-history-observation .columns")
1542663818103:cast1 <- html_nodes(jan, ".region-content-observation")
1542663818115:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542663818120:cast1
1542663818126:#cast2
1542664041722:cast <- html_nodes(jan, 'table')
1542664047130:cast
1542664105970:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664106922:jan
1542664106939:cast <- html_nodes(jan, '.city-history-observation .columns')
1542664107000:cast1 <- html_nodes(jan, ".region-content-observation ._ngcontent-c8")
1542664107012:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542664107017:cast
1542664107025:#cast2
1542664153940:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664154114:jan
1542664154130:cast <- html_nodes(jan, '.city-history-observation .row .columns')
1542664154140:cast1 <- html_nodes(jan, ".region-content-observation ._ngcontent-c8")
1542664154152:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542664154156:cast
1542664154163:#cast2
1542664169505:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664169635:cast <- html_nodes(jan, '.city-history-observation .row .columns')
1542664169646:#cast2 <- html_nodes(jan, "#inner-content > div.city-body > div.row.city-history-observation > div > div:nth-child(1) > div > div > city-history-observation > div > div.observation-table > table > tbody > tr > td:nth-child(7)")
1542664169652:cast
1542664169660:#cast2
1542664237632:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664238341:jan %>% html_nodes(jan, '.city-history-observation .row .columns') %>% html_text()
1542664250755:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664251064:jan %>% html_nodes(, '.city-history-observation .row .columns') %>% html_text()
1542664256785:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664256955:jan %>% html_nodes(, '.city-history-observation .row .columns') #%>% html_text()
1542664274099:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664274276:html_nodes(jan, '.city-history-observation .row .columns') #%>% html_text()
1542664280753:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664280931:html_nodes(jan, '.city-history-observation .row .columns') %>% html_text()
1542664427929:html_nodes(jan, 'tbody td:nth-child(7)') %>% html_text()
1542664431847:html_nodes(jan, 'tbody td:nth-child(7)')# %>% html_text()
1542664434503:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664438076:html_nodes(jan, 'tbody td:nth-child(7)')# %>% html_text()
1542664445327:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664445539:html_nodes(jan, '.city-history-observation .row .columns') %>% html_text()
1542664492631:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664492792:html_nodes(jan, '.city-history-observation .row .columns') %>% html_table()
1542664502408:html_nodes(jan, '.city-history-observation .row .columns')# %>% html_table()
1542664508038:html_nodes(jan, '.city-history-observation .row .columns') %>% html_table()
1542664523759:html_nodes(jan, '.city-history-observation .row .columns') %>% html_text() %>% html_table()
1542664573565:html_nodes(jan, '.city-history-observation .row .columns') %>% html_text()
1542664622033:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542664622641:jan.nodes <- html_nodes(jan, '.city-history-observation .row .columns') #%>% html_text()
1542664622651:jan.nodes
1542664627918:jan.nodes[1]
1542664636035:jan.nodes[[1]]
1542664649698:jan.nodes
1542664650036:jan.nodes[1]
1542664650194:jan.nodes[[1]]
1542664665881:jan.nodes[[1,1]]
1542664676315:jan.nodes
1542664676327:jan.nodes[1,1]
1542664689817:jan.nodes
1542664689985:jan.nodes[2]
1542664700878:jan.nodes
1542664701201:jan.nodes[1]
1542664701259:jan.nodes[[1]]
1542664711056:typeof(jan.nodes)
1542664716323:jan.nodes[1]
1542664723023:dim(jan.nodes)
1542664727643:length(jan.nodes)
1542664901122:html_table(jan.nodes)[[2]]
1542664918628:tbls <- html_nodes(jan, "table")
1542664925939:html_table(jan.nodes)[[2]]
1542664932330:tbls
1542664936938:html_table(tbls)[[2]]
1542664944787:tbls <- html_nodes(jan, "table")
1542664944794:tbls
1542664944799:html_table(tbls)
1542664956347:jan.nodes <- html_nodes(jan, '.city-history-observation .row .columns') #%>% html_text()
1542664967164:html_table(jan.nodes)
1542665001756:length(jan.nodes)
1542665007382:jan.nodes
1542665029848:html_attr(jan.nodes)
1542665033657:?html_attr
1542665083474:jan <- html('https://www.wunderground.com/history/monthly/ie/dublin/EIDW/date/2013-1')
1542665084283:jan.nodes <- html_nodes(jan, '.city-history-observation .row .columns') #%>% html_text()
1542665084293:html_text(jan.nodes)
1542665084298:html_name(jan.nodes)
1542665084302:html_attrs(jan.nodes)
1542665084310:html_attr(jan.nodes, "class")
1542665128283:read_html(jan.nodes)
1542665142689:?read_html
1542665165596:read_html(jan)
1542665728303:jan2.nodes <- html_nodes(jan, 'tbody:nth-child(4) tr:nth-child(1) td:nth-child(2)')
1542665728316:jan2.nodes
1542665739237:jan2.nodes %>% html_text()
1542665785897:jan2.nodes <- html_nodes(jan, '.summary-table tbody:nth-child(2) tr:nth-child(1) td:nth-child(2)')
1542665786303:jan2.nodes %>% html_text()
1542665811706:jan <- html('https://www.wunderground.com/history/daily/ie/dublin/EIDW/date/2013-11-19')
1542665812781:jan2.nodes <- html_nodes(jan, '.city-history-observation .row .columns') #%>% html_text()
1542665812793:jan2.nodes <- html_nodes(jan, '.summary-table tbody:nth-child(2) tr:nth-child(1) td:nth-child(2)')
1542665812808:jan2.nodes %>% html_text()
1542665812813:jan2.nodes
1542665812870:read_html(jan)
1542665816735:jan2.nodes
1542665819393:jan2.nodes %>% html_text()
1542665867272:jan <- html('https://www.wunderground.com/history/daily/ie/dublin/EIDW/date/2013-11-19')
1542665867591:#jan2.nodes <- html_nodes(jan, '.city-history-observation .row .columns') #%>% html_text()
1542665867595:jan2.nodes <- html_nodes(jan, '.summary-table tbody:nth-child(2) tr:nth-child(1) td:nth-child(2)')
1542665867611:jan2.nodes #%>% html_text()
1542665886148:jan2.nodes %>% read_html()#%>% html_text()
1542665895100:jan2.nodes %>% html_text()#%>% html_text()
1542665934457:jan <- html('https://www.wunderground.com/history/daily/ie/dublin/EIDW/date/2013-11-19')
1542665935467:#jan2.nodes <- html_nodes(jan, '.city-history-observation .row .columns') #%>% html_text()
1542665935470:jan2.nodes <- html_nodes(jan, 'tbody:nth-child(14) tr:nth-child(1) td:nth-child(2)')
1542665935482:jan2.nodes %>% html_text()#%>% html_text()
1542665935487:jan2.nodes
1542665948345:read_html(jan)
1542665954768:read_html(jan2.nodes)
1542665967803:jan <- html('https://www.wunderground.com/history/daily/ie/dublin/EIDW/date/2013-11-19')
1542665969490:#jan2.nodes <- html_nodes(jan, '.city-history-observation .row .columns') #%>% html_text()
1542665969493:jan2.nodes <- html_nodes(jan, 'tbody:nth-child(14) tr:nth-child(1) td:nth-child(2)')
1542665969556:jan2.nodes %>% html_text()#%>% html_text()
1542665969763:jan2.nodes
1542666024068:weather_data<-read_html("http://www.wunderground.com/history/airport/KSFO/2015/1/1/DailyHistory.html")
1542666025359:mean_daily_temp<-weather_data %>%
1542666025362:html_node(".wx-value") %>%
1542666025365:html_text() %>%
1542666025367:as.numeric()
1542666033473:weather_data<-read_html("http://www.wunderground.com/history/airport/KSFO/2015/1/1/DailyHistory.html")
1542666033821:mean_daily_temp<-weather_data %>%
1542666033823:html_node(".wx-value") %>%
1542666033825:html_text() %>%
1542666033828:as.numeric()
1542666033835:mean_daily_temp
1542666122271:weather_data<-read_html("http://www.wunderground.com/history/airport/KSFO/2015/1/1/DailyHistory.html")
1542666122612:mean_daily_temp<-weather_data %>%
1542666122614:html_node(".summary-table tbody:nth-child(2) tr:nth-child(3) td:nth-child(2)") %>%
1542666122617:html_text() %>%
1542666122619:as.numeric()
1542666122633:mean_daily_temp
1542735500269:jan2.nodes
1542736712319:jan2.nodes <- html_nodes(jan, '.summary-table tbody:nth-child(2) tr:nth-child(3) td:nth-child(2)')
1542736713783:jan2.nodes %>% html_text()#%>% html_text()
1542736715006:jan2.nodes
1542737193893:jan <- html('https://www.wunderground.com/history/daily/ie/dublin/EIDW/date/2013-11-19')
1542737196066:jan_html <- read_html(jan)
1542737224875:library(rvest)
1542737224875:jan <- html('https://www.wunderground.com/history/daily/ie/dublin/EIDW/date/2013-11-19')
1542737225015:jan_html <- read_html(jan)
1542737248574:jan
1542737275985:jan <- read_html('https://www.wunderground.com/history/daily/ie/dublin/EIDW/date/2013-11-19')
1542737276141:jan
1542737316178:jan %>% html_nodes()
1542737320989:jan %>% html_nodes('a')
1542737330224:jan %>% html_nodes('a') %>% head()
1542737334671:jan %>% html_nodes('a')
1542737359366:jan %>% html_nodes('div.nav-tools')
1542737381071:jan %>% html_nodes('div')
1542737458347:jan %>% html_nodes('div.summary-title')
1542737497019:jan %>% html_nodes('table')
1542737515020:jan %>% html_nodes('div.summary-title')
1542737537704:jan %>% html_nodes('div.summary-title') %>% html_text()
1542737572712:jan %>% html_nodes('div.summary-table') %>% html_text()
1542737594236:jan %>% html_nodes('div.summary-table') %>% html_text()
1542737604513:jan %>% html_nodes('div.summary-table') %>% html_table()
1542737620831:jan %>% html_nodes('div.summary-table') %>% html_text()
1542737625487:jan %>% html_nodes('div.summary-table')# %>% html_text()
1542737638462:View(jan %>% html_nodes('div.summary-table'))# %>% html_text()
1542737657580:View(jan %>% html_nodes('div.summary-table')[1])# %>% html_text()
1542737663363:View(jan %>% html_nodes('div.summary-table'))# %>% html_text()
1542737902396:View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542737941286:jan %>% html_nodes('div.row.city-history-summary') %>% html_text()
1542737990540:jan %>% html_nodes('div.row.city-history-summary div:nth-child(1)') %>% html_text()
1542738089083:library(rvest)
1542738089086:jan <- read_html('https://www.wunderground.com/history/daily/ie/dublin/EIDW/date/2013-11-20')
1542738089233:jan
1542738089250:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542738089252:jan %>% html_nodes('div.row.city-history-summary div:nth-child(1)') %>% html_text()
1542738118941:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542738119009:jan %>% html_nodes('div.row.city-history-summary div:nth-child(1)') %>% html_text() %>% head()
1542738125662:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542738125665:jan %>% html_nodes('div.row.city-history-summary div:nth-child(1)') %>% html_text()
1542738149112:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542738149114:jan %>% html_nodes('div.row.city-history-summary td:nth-child(2)') %>% html_text()
1542742109158:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742109158:jan %>% html_nodes('div.row.city-history-summary td:nth-child(2)') #%>% html_text()
1542742135145:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742135146:jan %>% html_nodes('div.row.city-history-summary)# td:nth-child(2)') #%>% html_text()
1542742149410:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742149412:jan %>% html_nodes('div.row.city-history-summary')# td:nth-child(2)') #%>% html_text()
1542742179080:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742179083:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('td')# td:nth-child(2)') #%>% html_text()
1542742222568:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742222569:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('ng-content')# td:nth-child(2)') #%>% html_text()
1542742237080:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742237082:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('_ngcontent')# td:nth-child(2)') #%>% html_text()
1542742242399:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742242401:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('_ngcontent-c7')# td:nth-child(2)') #%>% html_text()
1542742247674:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742247676:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('_ngcontent-c7')# td:nth-child(2)') %>% html_text()
1542742291736:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742291738:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table')# td:nth-child(2)') %>% html_text()
1542742302270:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742302273:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table')# td:nth-child(2)') %>% html_text())
1542742306039:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742306041:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table')# td:nth-child(2)')) %>% html_text())
1542742320752:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742320754:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table'))
1542742359302:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742359305:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table')) %>% html_table())
1542742368397:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742368399:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_table())
1542742396081:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742396084:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('div.observation-table'))
1542742495580:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742495582:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('div.observation-table'))
1542742508301:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742508304:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('div.observation-table')) %>% html_text()
1542742522771:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742522773:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('div.observation-table') %>% html_text()
1542742588488:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742588601:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('tbody:nth-child(4)') %>% html_text()
1542742597831:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742597834:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('tr:nth-child(1)') %>% html_text()
1542742642437:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742642439:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('td:nth-child(2)') %>% html_text()
1542742711501:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742711504:jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('tbody:nth-child(4) tr:nth-child(1) td:nth-child(2)') %>% html_text()
1542742780831:#View(jan %>% html_nodes('div.row.city-history-summary'))# %>% html_text()
1542742780833:View(jan %>% html_nodes('div.row.city-history-summary') %>% html_nodes('div.summary-table') %>% html_node('tbody:nth-child(4) tr:nth-child(1) td:nth-child(2)') %>% html_text())
1542743104184:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542743104184:options(digits=2)
1542743104270:library(devtools)
1542743105499:library(readr)
1542743105581:library(ggplot2)
1542743105777:library(ggmap)
1542743105832:devtools::install_github('hadley/ggplot2')
1542743130218:devtools::install_github('dkahle/ggmap')
1542743130677:library(rnoaa)
1542743131039:library(httr)
1542743131049:library(plyr)
1542743131059:library(jsonlite)
1542743131069:library(dplyr)
1542743131082:library(readODS)
1542743131106:library(knitr)
1542743131116:library(hms)
1542743131132:employ.read <- read_delim('dublin employment trends.txt', ':')
1542743131204:qplot(data = employ.read , x = Time , y = Employment, geom = 'line', xlab = 'Quarterly Figures', ylab = 'Trend', main = 'Dublin Employment Trends Per Sector: 2006 - 2016') + facet_grid ( .~ Sector)
1542743131719:min.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == min(Employment))
1542743131754:max.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == max(Employment))
1542743131780:employ.extreme <- left_join(min.employ, max.employ, by = 'Sector', suffix = c('.min', '.max'))[c('Sector', 'QuarterYear.min', 'Employment.min', 'Time.min', 'QuarterYear.max', 'Employment.max', 'Time.max')]
1542743131799:employ.extreme <- employ.extreme %>% mutate(Employment.diff = Employment.max-Employment.min)
1542743131812:kable(employ.extreme, digits = 2)
1542743132430:prop.read <- read_tsv('dublin property trends.txt')
1542743132450:qplot(data = prop.read , x = Time , y = Trend, geom = 'line', colour = Category, xlab = 'Time', ylab = 'Trend', main = 'Dublin Property Trends: 2007 - 2016')
1542743132982:prop.split <- split(prop.read, prop.read$Category)
1542743132998:prop.apt.rent <- select(prop.split[[1]], Time, Year, Trend, Category)
1542743133006:prop.house.price <- select(prop.split[[2]], Time, Year, Trend, Category)
1542743133014:prop.house.rent <- select(prop.split[[3]], Time, Year, Trend, Category)
1542743133022:prop.house.built <- select(prop.split[[4]], Time, Year, Trend, Category)
1542743133131:prop.cols <- prop.apt.rent %>% left_join(prop.house.price, by = c('Time', 'Year'), suffix = c('.apt.rent', '.house.price')) %>% left_join( prop.house.built, by = c('Time', 'Year'), suffix = c('.', '.house.built')) %>% left_join(., prop.house.rent, by = c('Time', 'Year'), suffix = c('.', '.house.rent'))
1542743133155:prop.filter.buy <- filter(prop.cols, (Trend.house.price > Trend.house.rent & Trend.house.price > Trend.apt.rent & Trend. > Trend.house.rent & Trend. > Trend.apt.rent))
1542743133225:prop.filter.rent <- filter(prop.cols, (Trend.house.price < Trend.house.rent & Trend.house.price < Trend.apt.rent & Trend. < Trend.house.rent & Trend. < Trend.apt.rent))
1542743133240:min.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == min(Trend))
1542743133309:max.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == max(Trend))
1542743133374:prop.extreme <- left_join(min.prop, max.prop, by = 'Category', suffix = c('.min', '.max'))[c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max', 'Trend.max', 'Time.max')]
1542743133387:prop.extreme <- prop.extreme %>% mutate(Trend.diff = Trend.max-Trend.min)
1542743133398:employ.extreme.con <- employ.extreme %>% filter(., Sector == 'Construction') %>% setNames(c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max',  'Trend.max', 'Time.max', 'Trend.diff'))
1542743133409:kable(bind_rows(prop.extreme, employ.extreme.con), digits = 2)
1542743133527:stations <- GET('https://api.jcdecaux.com/vls/v1/stations?apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542743133892:http_type(stations)
1542743133897:stations.df <- jsonlite::fromJSON(content(stations, 'text'), simplifyVector = TRUE)
1542743134138:#count(stations.df, vars = 'contract_name')
1542743134146:bike <- GET('https://api.jcdecaux.com/vls/v1/stations?contract=Dublin&apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542743134324:http_type(bike)
1542743134329:bike.df <- jsonlite::fromJSON(content(bike, 'text'), simplifyVector = TRUE)
1542743134355:sum.bike <- summary(bike.df)
1542743134472:#filter(bike.df, banking==FALSE)
1542743134475:#bike.df[bike.df$banking==F]
1542743134478:#bike.df[bike.df$address=='Smithfield North']
1542743134480:#bike.df$address=='Smithfield North'
1542743134483:#bike.df$banking
1542743134494:bike.df <- bike.df[order(bike.df$number),]
1542743134598:#bike.df
1542743134606:str(bike.df)
1542743134724:qplot(available_bikes, name, data = bike.df , colour = banking, size=I(3))
1542743135065:unzip('DublinBus.zip')
1542743135781:trips.df <- read_csv('googletransitdublinbusp20130315-1546\\trips.txt')
1542743135803:routes.df <- read_csv('googletransitdublinbusp20130315-1546\\routes.txt')
1542743135880:calendar.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar.txt')
1542743136018:calendar_dates.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar_dates.txt')
1542743136031:shapes.df <- read_csv('googletransitdublinbusp20130315-1546\\shapes.txt')
1542743136160:stops.df <- read_csv('googletransitdublinbusp20130315-1546\\stops.txt')
1542743136182:transfers.df <- read_csv('googletransitdublinbusp20130315-1546\\transfers.txt')
1542743136246:agency.df <- read_csv('googletransitdublinbusp20130315-1546\\agency.txt')
1542743136264:stop_times.df <- read_csv('googletransitdublinbusp20130315-1546\\stop_times.txt')
1542743137923:route.num.trip <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542743137991:ggplot(data=route.num.trip, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542743138525:#common join used at multiple points in the code
1542743138528:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542743139377:#calculating the unit of distance in the dataset
1542743139380:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542743139447:#calculating the route lengths
1542743139449:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542743139665:# base df that most and least frequent routes and mean length is based on
1542743139667:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, Service, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, Service, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, Service, Freq) %>% group_by(Service)
1542743139821:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542743139829:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542743139839:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542743139901:extreme.freq <- rbind(most.freq, leastfreq) %>% select(Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., Service, Freq)
1542743139945:kable(extreme.freq)
1542743140114:##trying to figure out first and last bus - getting bogged down
1542743140116:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 #~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% #mutate(actual.time=case_when(arrival_time < as.hms('04:00:00') ~ arrival_time+as.hms('24:00:00')))  %>% #filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% arrange(arrival_time)
1542743140119:#library(hms)
1542743140121:#typeof(as.hms('04:00:00'))
1542743140124:#%>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542743140127:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41) %>% select(Service, route_short_name, service_id, arrival_time, departure_time)  %>% distinct() %>% arrange(arrival_time)
1542743140135:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542743140146:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542743140159:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542743140174:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest)
1542743140182:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542743140185:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542743140187:bottom = (min(stops.df$stop_lat) - 0.01),
1542743140189:right = (max(stops.df$stop_lon) + 0.01),
1542743140191:top = (max(stops.df$stop_lat) + 0.01))
1542743140197:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542743142358:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542743142996:home.route <- 49
1542743143000:bus.home <- bus.join %>% filter(route_short_name==home.route, Service=='Weekday')
1542743143024:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542743143161:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542743143307:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542743143316:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(lead(arrival_time) - arrival_time)/60) %>% mutate(length.dist=(lead(shape_dist_traveled) - shape_dist_traveled)/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542743143385:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542743143555:kable(bus.join %>% group_by(Service, stop_headsign) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(earliest.bus=min(arrival_time), latest.bus= max(arrival_time)))
1542743143856:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542743143925:stops.home <- bus.join.sat %>% filter(route_short_name==home.route)
1542743144116:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by = c("route_short_name.intersect" = "route_short_name")) %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542743144289:intersect.routes <- rbind((stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))), (stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route)))) %>% select(Route, Longitude, Latitude)
1542743144309:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542743144313:dublin_intersect_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542743144316:bottom = (min(stops.intersect$Latitude) - 0.01),
1542743144319:right = (max(stops.intersect$Longitude) + 0.01),
1542743144321:top = (max(stops.intersect$Latitude) + 0.01))
1542743144326:dublin_intersect_stamen <- get_stamenmap(bbox = dublin_intersect_bb, zoom = 11,  maptype = 'toner-lite')
1542743145314:ggmap(dublin_intersect_stamen, legend = 'right') + geom_point(data = intersect.routes, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542743145922:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542743145926:download.file(url.footfall, 'footfall_ods.ods')
1542743146966:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542743146971:camera2.name <- 'Entrance Name: South Great Georges'
1542743146976:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542743147750:#change sheet 13 to week 13
1542743147752:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542743147762:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542743147775:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542743147787:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542743147797:for(week.i in 1:length(sheet.names))
1542743147800:{
1542743147803:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542743147807:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542743147812:camera1.row <- which(grepl(camera1.name, f1$Time))
1542743147815:camera2.row <- which(grepl(camera2.name, f1$Time))
1542743147817:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542743147820:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542743147825:camera1.all <- rbind(camera1.all, camera1.slice)
1542743147828:camera2.all <- rbind(camera2.all, camera2.slice)
1542743147833:f1 <- NULL
1542743147837:}
1542789449285:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542789449344:download.file(url.footfall, 'footfall_ods.ods')
1542789465833:camera1.name <- 'Entrance Name: O\'Connell Street at Easons'
1542789465842:camera2.name <- 'Entrance Name: South Great Georges'
1542789465851:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542789466907:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542789466929:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542789467003:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542789467024:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542789467292:for(week.i in 1:length(sheet.names))
1542789467299:{
1542789467304:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542789467315:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542789467375:camera1.row <- which(grepl(camera1.name, f1$Time))
1542789467380:camera2.row <- which(grepl(camera2.name, f1$Time))
1542789467386:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542789467391:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542789467401:camera1.all <- rbind(camera1.all, camera1.slice)
1542789467408:camera2.all <- rbind(camera2.all, camera2.slice)
1542789467419:f1 <- NULL
1542789467424:}
1542789975490:#all fields are character (they contained some text before using split), so must change all numeric characters to numeris
1542789975496:for (i in 1:length(col.change))
1542789975500:{
1542789975505:camera1.all[[col.change[i]]] <- as.numeric(camera1.all[[col.change[i]]])
1542789975510:camera2.all[[col.change[i]]] <- as.numeric(camera2.all[[col.change[i]]])
1542789975512:}
1542789975584:summary(camera1.all)
1542789976045:summary(camera2.all)
1542790472427:#getting list of camera locations
1542790472436:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542790518797:which(grepl('Entrance Name:', f1$Time))
1542790526342:f1
1542790566163:which(grepl('Entrance Name:*', f1$Time))
1542790605446:which(grepl('Entrance Name:.*', f1$Time))
1542790611916:which(egrepl('Entrance Name:.*', f1$Time))
1542790687865:read_ods[read_ods$Time %like% "Entrance Name:*", ]
1542790710020:library(data.table)
1542790710281:read_ods[read_ods$Time %like% "Entrance Name:*", ]
1542790722916:read_ods[read_ods$Time %like% "Entrance Name:", ]
1542790783308:f1 %>% filter(., grepl("Entrance Name:", Time, fixed = TRUE))
1542790816252:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542790820731:f1 %>% filter(., grepl("Entrance Name:", Time, fixed = TRUE))
1542790838598:f1 %>% filter(., grepl("Entrance Name:", Time, fixed = TRUE)) %>% select(Time)
1542791637602:ambient.sound <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542791861755:ambient.sound
1542791930581:#getting list of camera locations
1542791930585:read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>% filter(., grepl("Entrance Name:", Time, fixed = TRUE)) %>% select(Time)
1542791960443:#getting list of camera locations
1542791960453:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542791968730:f1 %>% filter(., grepl("Entrance Name:", Time, fixed = TRUE)) %>% select(Time)
1542792032018:#getting list of camera locations
1542792032027:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542792038307:camera.locations
1542792038359:colnames(camera.locations) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542792038389:f1 %>% filter(., grepl("Entrance Name:", Time, fixed = TRUE)) %>% select(Time)
1542792063855:camera.locations[1]
1542792101473:#getting list of camera locations
1542792101483:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542792111431:#getting list of camera locations
1542792111441:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542792118962:colnames(camera.locations) <- c('Loc')
1542792118971:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE)) %>% select(Time)
1542792142512:#getting list of camera locations
1542792142521:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542792148730:colnames(camera.locations) <- c('Loc')
1542792148737:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE)) %>% select(Loc)
1542792171849:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1] %>% filter_at(1)
1542792197869:read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1] %>% filter_at(1)
1542792284131:read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542792321564:?select
1542792383153:read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>% select_at(1)
1542792399452:read_ods('pedestrianfootfall2013.ods',sheet.names[1]) %>% select_at(., 1)
1542792489621:example("select_at", package = "dplyr")
1542792556723:#getting list of camera locations
1542792556731:camera.locations
1542792556761:read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1] %>% filter(., grepl("Entrance Name:", fixed = TRUE))
1542792646181:#getting list of camera locations
1542792646187:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542792652992:camera.locations[grepl("Entrance Name:", fixed = TRUE)]
1542792704131:#getting list of camera locations
1542792704141:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542792710807:colnames(camera.locations) <- c('Loc')
1542792710816:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE))
1542792745878:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542792745890:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542792745906:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542792747053:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542792747134:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542792747168:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542792747202:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542792747643:for(week.i in 1:length(sheet.names))
1542792747649:{
1542792747654:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542792747663:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542792747673:camera1.row <- which(grepl(camera1.name, f1$Time))
1542792747781:camera2.row <- which(grepl(camera2.name, f1$Time))
1542792747789:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542792747801:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542792747817:camera1.all <- rbind(camera1.all, camera1.slice)
1542792747827:camera2.all <- rbind(camera2.all, camera2.slice)
1542792747845:f1 <- NULL
1542792747906:}
1542792944601:ambient.sound.url <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542792944619:download.file(ambient.sound.url, destfile = 'ambient_sound.zip')
1542792946543:unzip('ambient_sound.zip', exdir = './sound')
1542793036332:ambient.sound.url <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542793036349:download.file(ambient.sound.url, destfile = 'ambient_sound.zip')
1542793037240:unzip('ambient_sound.zip', exdir = './ambient_sound')
1542793176852:format(ISOdate(2013,1:12,1),"%B")
1542793196544:months <- format(ISOdate(2013,1:12,1),"%B")
1542793202111:months
1542793253314:?read_tsv
1542793283467:read_tsv('ambient_sound\2013\January')
1542793292273:read_tsv('ambient_sound/2013/January')
1542793311838:read_tsv('ambient_sound/2013/January\DCC-NOISE-001011-2013-01-01T00-00-00')
1542793320927:read_tsv('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-01T00-00-00')
1542793331818:read_tsv('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-01T00-00-00.txt')
1542793355777:read_csv('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-01T00-00-00.txt')
1542793599521:sound1 <- read_csv('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-01T00-00-00.txt')
1542793599672:sound1
1542793622211:dim(sound1)
1542793638026:sound1 <- read_csv('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-01T00-00-00.txt', delim=',')
1542793676331:sound1 <- read_delim('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-01T00-00-00.txt', delim=',')
1542793676632:dim(sound1)
1542793721055:sound1 <- read_delim('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-01T00-00-00.txt', delim=c(' ',','))
1542794086244:sound1 <- read_delim('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794110389:sound1 <- read_csv('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794110534:dim(sound1)
1542794148986:sound1 <- read_file('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794149000:dim(sound1)
1542794161822:sound1 <- read_file('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794162135:sound1
1542794185252:sound1 <- read_delim('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt', '~')
1542794185568:sound1
1542794198611:?read_file
1542794294646:sound1 <- read.csv('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794294674:sound1
1542794370742:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794370765:sound1
1542794386392:sound1 <- read_table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794389800:sound1 <- read_table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794389890:sound1
1542794410679:sound1 <- read.csv('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794410705:sound1
1542794421730:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542794421770:sound1
1542794450446:?read_table
1542795711533:sound1 %>% select(V1, V2, V3)
1542795767221:?mutate_all
1542795804815:sound1 %>% select(V1, V2, V3) %>% mutate(gsub(",",""))
1542795812155:sound1 %>% select(V1, V2, V3) %>% mutate_all(gsub(",",""))
1542795817445:sound1 %>% select(V1, V2, V3) %>% mutate_all(gsub(",",""), .)
1542795825705:?gsub
1542795856322:mutate_all(gsub(",",""), sound2)
1542795864358:mutate_all(gsub(",","", sound2)
1542795878402:sound2
1542795883393:mutate_all(gsub(",","", sound2))
1542795889485:sound2 <- sound1 %>% select(V1, V2, V3)
1542795889485:sound2
1542795889660:mutate_all(gsub(",","", sound2))
1542795909380:gsub(",","", sound2)
1542795925522:sound3 <- gsub(",","", sound2)
1542795925522:sound3
1542795957003:sound2 %>% mutate_all(gsub(",","", .))
1542796068770:sound1$V1
1542796078681:sound1
1542796085643:sound2
1542796112302:sound3 <-  gsub(",","", sound2)
1542796112308:sound3
1542796134050:sound2$V1 <-  gsub(",","", sound2$V1)
1542796134058:sound2
1542796142611:sound1
1542796151206:sound2$V2 <-  gsub(",","", sound2$V2)
1542796151217:sound2
1542796164112:sound2$V3 <-  gsub(",","", sound2$V2)
1542796164123:sound2
1542796180580:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-02T00-00-00.txt')
1542796180860:sound2 <- sound1 %>% select(V1, V2, V3)
1542796180867:sound2$V2 <-  gsub(",","", sound2$V2)
1542796180873:sound2$V3 <-  gsub(",","", sound2$V3)
1542796180879:sound2
1542796225431:format(as.Date("2014-03-16"), "%W")
1542796238021:sound2
1542796394333:?paste
1542796434166:paste('ambient_sound/2013/',months[1])
1542796441236:paste('ambient_sound/2013/',months[1], sep='')
1542796472431:paste('ambient_sound/2013/',months[1], '/DCC-NOISE-001011-2013', 'T00-00-00.txt' sep='')
1542796485456:paste('ambient_sound/2013/', months[1], '/DCC-NOISE-001011-2013', 'T00-00-00.txt', sep='')
1542796533726:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-045T00-00-00.txt')
1542796544166:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-45T00-00-00.txt')
1542796552155:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542796552319:sound2 <- sound1 %>% select(V1, V2, V3)
1542796552325:sound2$V2 <-  gsub(",","", sound2$V2)
1542796552331:sound2$V3 <-  gsub(",","", sound2$V3)
1542796552338:sound2
1542796613178:monthDays(as.Date('2010-01-01'))
1542796637585:days_in_month(date)
1542796655229:library(devtools)
1542796655234:library(readr)
1542796655234:library(ggplot2)
1542796655234:library(ggmap)
1542796655234:devtools::install_github('hadley/ggplot2')
1542796656307:devtools::install_github('dkahle/ggmap')
1542796656743:library(rnoaa)
1542796656746:library(httr)
1542796656748:library(plyr)
1542796656752:library(jsonlite)
1542796656755:library(dplyr)
1542796656755:library(readODS)
1542796656755:library(knitr)
1542796656755:library(hms)
1542796656755:library(Lubridate)
1542796669793:install.packages('Lubridate')
1542796677949:library(lubridate)
1542796716056:date = as.Date("2011-02-23", "%Y-%m-%d")
1542796716060:days_in_month(date)
1542796768241:months
1542796788347:?as.Date()
1542796939118:date.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542796939122:colnames(date.all) <- c('year', 'month.char', 'month.num', 'day')
1542796939129:data.all
1542796946192:date.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542796946197:colnames(date.all) <- c('year', 'month.char', 'month.num', 'day')
1542796946206:date.all
1542797134385:as.Date(paste('2011','-02-23, "%Y-%m-%d")
1542797150029:as.Date(paste('2011','-02-23'), "%Y-%m-%d")
1542797168926:paste('2011','-02-23')
1542797173508:as.Date(paste('2011','-02-23'), '%Y-%m-%d')
1542797187180:as.Date(paste('2011','-02-23', sep=''), '%Y-%m-%d')
1542797209939:as.Date(paste('2011','-02-23', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797220327:as.Date(paste('2011','-02-23', sep=''), '%Y-%m-%d') %>% days_in_month()[1]
1542797319562:j=1
1542797319566:as.Date(paste('2013','-', j ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797330027:for (i in 1:12)
1542797330173:{
1542797330174:date.i <- data.frame(matrix(ncol = 4, nrow = 0))
1542797330178:date.i[1] <- '2013'
1542797330180:date.i[2] <- months[i]
1542797330182:date.i[1] <- i
1542797330184:date.i[1] <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797330187:date.all < rbind(date.all, date.i)
1542797330191:date.i < NULL
1542797330192:}
1542797346177:for (i in 1:12)
1542797346180:{
1542797346181:date.i <- data.frame(matrix(ncol = 4, nrow = 0))
1542797346181:date.i[1] <- '2013'
1542797346181:date.i[2] <- months[i]
1542797346181:date.i[3] <- i
1542797346181:date.i[4] <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797346181:date.all < rbind(date.all, date.i)
1542797346181:date.i < NULL
1542797346196:}
1542797400628:i=1
1542797400632:date.i <- data.frame(matrix(ncol = 4, nrow = 0))
1542797400632:date.i
1542797400632:date.i[1] <- '2013'
1542797459565:i=1
1542797459569:date.i <- data.frame(matrix(ncol = 4, nrow = 0))
1542797459573:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542797459573:date.i
1542797459573:date.i$year <- '2013'
1542797475467:i=1
1542797475467:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542797475614:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542797475620:date.i
1542797475629:date.i$year <- '2013'
1542797475635:date.i$month.char <- months[i]
1542797475640:date.i$month.num <- i
1542797475645:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797475650:date.i
1542797475657:date.all < rbind(date.all, date.i)
1542797503902:date.all < rbind(date.all, date.i)
1542797524807:date.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542797524808:colnames(date.all) <- c('year', 'month.char', 'month.num', 'day')
1542797524808:date.all
1542797524824:i=1
1542797524824:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542797524987:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542797524992:date.i
1542797524999:date.i$year <- '2013'
1542797525004:date.i$month.char <- months[i]
1542797525010:date.i$month.num <- i
1542797525015:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797525020:date.i
1542797525030:date.all < rbind(date.all, date.i)
1542797539103:date.all
1542797577579:i=1
1542797577581:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542797577581:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542797577581:date.i
1542797577596:date.i$year <- '2013'
1542797577596:date.i$month.char <- months[i]
1542797577612:date.i$month.num <- i
1542797577612:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797577612:date.i
1542797577627:date.all <- rbind(date.all, date.i)
1542797577627:date.all
1542797629331:for (i in 1:12)
1542797629331:{
1542797629336:date.i <- data.frame(matrix(ncol = 4, nrow = 0))
1542797629336:date.i$year <- '2013'
1542797629336:date.i$month.char <- months[i]
1542797629336:date.i$month.num <- i
1542797629336:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797629348:date.all <- rbind(date.all, date.i)
1542797629504:date.i <- NULL
1542797629505:}
1542797658269:for (i in 1:12)
1542797658272:{
1542797658272:date.i <- data.frame(matrix(ncol = 4, nrow = 0))
1542797658272:date.i$year <- '2013'
1542797658272:date.i$month.char <- months[i]
1542797658272:date.i$month.num <- i
1542797658281:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797658435:date.all <- rbind(date.all, date.i)
1542797658438:#date.i <- NULL
1542797658440:}
1542797675916:date.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542797675920:colnames(date.all) <- c('year', 'month.char', 'month.num', 'day')
1542797675920:for (i in 1:12)
1542797675920:{
1542797675933:date.i <- data.frame(matrix(ncol = 4, nrow = 0))
1542797676086:date.i$year <- '2013'
1542797676088:date.i$month.char <- months[i]
1542797676090:date.i$month.num <- i
1542797676092:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797676094:date.all <- rbind(date.all, date.i)
1542797676097:date.i <- NULL
1542797676098:}
1542797691180:date.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542797691180:colnames(date.all) <- c('year', 'month.char', 'month.num', 'day')
1542797691195:for (i in 1:12)
1542797691195:{
1542797691195:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542797691195:date.i$year <- '2013'
1542797691195:date.i$month.char <- months[i]
1542797691195:date.i$month.num <- i
1542797691362:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797691365:date.all <- rbind(date.all, date.i)
1542797691368:date.i <- NULL
1542797691369:}
1542797691389:date.all
1542797715526:ate.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542797715529:colnames(date.all) <- c('year', 'month.char', 'month.num', 'day')
1542797715529:for (i in 1:12)
1542797715529:{
1542797715541:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542797715542:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542797715545:date.i$year <- '2013'
1542797715547:date.i$month.char <- months[i]
1542797715548:date.i$month.num <- i
1542797715550:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797715552:date.all <- rbind(date.all, date.i)
1542797715555:date.i <- NULL
1542797715557:}
1542797742515:date.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542797742521:colnames(date.all) <- c('year', 'month.char', 'month.num', 'day')
1542797742521:for (i in 1:12)
1542797742521:{
1542797742521:#date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542797742536:#colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542797742690:date.i$year <- '2013'
1542797742691:date.i$month.char <- months[i]
1542797742693:date.i$month.num <- i
1542797742694:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797742696:date.all <- rbind(date.all, date.i)
1542797742698:date.i <- NULL
1542797742700:}
1542797742715:date.all
1542797758628:date.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542797758634:colnames(date.all) <- c('year', 'month.char', 'month.num', 'day')
1542797758634:for (i in 1:12)
1542797758634:{
1542797758634:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542797758646:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542797758649:date.i$year <- '2013'
1542797758803:date.i$month.char <- months[i]
1542797758804:date.i$month.num <- i
1542797758806:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797758808:date.all <- rbind(date.all, date.i)
1542797758811:date.i <- NULL
1542797758812:}
1542797758841:date.all
1542797895058:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542797895061:months <- format(ISOdate(2013,1:12,1),"%B")
1542797895065:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542797895071:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542797895076:for (i in 1:12)
1542797895079:{
1542797895081:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542797895083:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542797895086:date.i$year <- '2013'
1542797895088:date.i$month.char <- months[i]
1542797895090:date.i$month.num <- i
1542797895092:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542797895096:dates.df <- rbind(dates.df, date.i)
1542797895103:date.i <- NULL
1542797895106:}
1542797895125:dates.df
1542797922004:sum(dates.df$day)
1542798145972:length(month.char)
1542798166195:length(dates.df$month.char)
1542798220534:for (i.month.char in 1:length(dates.df$month.char))
1542798220534:{
1542798220538:x <- paste('ambient_sound/2013/', months[i.month.char], '/DCC-NOISE-001011-2013-', 'T00-00-00.txt', sep='')
1542798220538:print(x)
1542798220538:}
1542798362757:length(dates.df)
1542798368212:nrow(dates.df)
1542798414803:dates.df$month.char[1]
1542798475726:for (i.month in 1:nrow(dates.df))
1542798475726:{
1542798475732:x <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], 'T00-00-00.txt', sep='')
1542798475732:print(x)
1542798475732:}
1542798632981:as.string(1)
1542798638887:as.char(1)
1542798683610:as.character(1)
1542798694409:numchar(as.character(1))
1542798700484:nchar(as.character(1))
1542798703753:nchar(as.character(12))
1542798732751:?if
1542798813714:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542798813714:months <- format(ISOdate(2013,1:12,1),"%B")
1542798829739:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542798829741:months <- format(ISOdate(2013,1:12,1),"%B")
1542798829747:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542798829752:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542798829758:for (i in 1:12)
1542798829760:{
1542798829763:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542798829765:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542798829768:date.i$year <- '2013'
1542798829770:date.i$month.char <- months[i]
1542798829772:if(nchar(as.character(i))==1)
1542798829774:{
1542798829776:date.i$month.num <- paste('0', i)
1542798829777:} else {
1542798829778:date.i$month.num <- i
1542798829780:}
1542798829786:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542798829789:dates.df <- rbind(dates.df, date.i)
1542798829793:date.i <- NULL
1542798829795:}
1542798829983:dates.df
1542798829990:dates.df$month %>% mutate_if(nchar()==1, paste())
1542798851666:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542798851666:months <- format(ISOdate(2013,1:12,1),"%B")
1542798851666:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542798851666:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542798851681:for (i in 1:12)
1542798851681:{
1542798851681:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542798851681:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542798851681:date.i$year <- '2013'
1542798851697:date.i$month.char <- months[i]
1542798851697:if(nchar(as.character(i))==1)
1542798851697:{
1542798851697:date.i$month.num <- paste('0', i, sep='')
1542798851697:} else {
1542798851697:date.i$month.num <- i
1542798851697:}
1542798851712:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542798851712:dates.df <- rbind(dates.df, date.i)
1542798851712:date.i <- NULL
1542798851712:}
1542798851743:dates.df
1542798872113:for (i.month in 1:nrow(dates.df))
1542798872115:{
1542798872118:x <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], 'T00-00-00.txt', sep='')
1542798872120:print(x)
1542798872126:}
1542798872159:'ambient_sound\2013\January\DCC-NOISE-001011-2013-01-01T00-00-00'
1542798930380:dates.df$day
1542798935032:dates.df$day[1]
1542799003832:for (i.month in 1:nrow(dates.df))
1542799003834:{
1542799003834:for (i.day in 1:dates.df$day[i.month])
1542799003834:{
1542799003834:x <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542799003834:print(x)
1542799003834:}
1542799003834:}
1542799113133:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542799113134:months <- format(ISOdate(2013,1:12,1),"%B")
1542799113137:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542799113137:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542799113137:for (i in 1:12)
1542799113153:{
1542799113153:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542799113153:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542799113153:date.i$year <- '2013'
1542799113153:date.i$month.char <- months[i]
1542799113153:if(nchar(as.character(i))==1)
1542799113168:{
1542799113168:date.i$month.num <- paste('0', i, sep='')
1542799113168:} else {
1542799113168:date.i$month.num <- i
1542799113177:}
1542799113183:days.month <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542799113187:if(nchar(as.character(days.month))==1)
1542799113189:{
1542799113191:date.i$day <- paste('0', days.month, sep='')
1542799113193:} else {
1542799113196:date.i$day <- days.month
1542799113198:}
1542799113201:dates.df <- rbind(dates.df, date.i)
1542799113205:date.i <- NULL
1542799113207:}
1542799113233:dates.df
1542799219827:for (i.month in 1:nrow(dates.df))
1542799219827:{
1542799219827:for (i.day in 1:dates.df$day[i.month])
1542799219827:{
1542799219844:if(nchar(as.character(i.day))==1)
1542799219846:{
1542799219849:x <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542799219851:} else {
1542799219854:x <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542799219856:}
1542799219858:print(x)
1542799219860:}
1542799219862:}
1542799312428:for (i.month in 1:nrow(dates.df))
1542799312428:{
1542799312428:for (i.day in 1:dates.df$day[i.month])
1542799312428:{
1542799312428:if(nchar(as.character(i.day))==1)
1542799312428:{
1542799312443:x <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542799312443:} else {
1542799312443:x <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542799312443:}
1542799312443:print(x)
1542799312443:}
1542799312443:}
1542799369136:sound2$V1
1542799417079:?strptime
1542799440376:format(as.Date("2014-03-16"), "%W")
1542799444879:format(as.Date("2014-03-16"), "%V")
1542799527590:format(as.Date("2014-03-16"), "%W")
1542799542446:sound2
1542799628856:sound2$V1 <- format(as.Date(sound2$V1), "%W")
1542799628867:sound2
1542799697831:sound2$V1 <- paste('Week', format(as.Date(sound2$V1), "%W"), sep='_')
1542799726789:sound2$V1 <- paste('Week', as.character(format(as.Date(sound2$V1), "%W")), sep='_')
1542799749648:format(as.Date(sound2$V1)
1542799756050:format(as.Date(sound2$V1))
1542799771939:format(as.Date(sound2$V1), '%W')
1542799792360:sound2$V1 <- format(as.Date(sound2$V1), '%W')
1542799830215:sound2$V1 <- format(as.Date(sound2$V1), "%W")
1542799850763:format(as.Date("2014-03-16"), "%W")
1542799860231:format(as.Date(sound2$V1), "%W")
1542799871892:format(as.Date(as.character(sound2$V1)), "%W")
1542799899908:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542799899912:sound2 <- sound1 %>% select(V1, V2, V3)
1542799921390:format(as.Date(sound2$V1), "%W")
1542799946878:paste('Week', format(as.Date(sound2$V1), "%W"), sep='_')
1542800024031:gsub('_0', '_', paste('Week', format(as.Date(sound2$V1), "%W"), sep='_'))
1542800049940:camera1.all
1542800092397:gsub('Sheet13', 'Week_13', camera1.all)
1542800100507:camera1.all
1542800130512:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542800130680:camera1.all
1542800146348:camera2.all
1542800173443:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542800173623:camera2.all
1542800210107:summary(camera1.all)
1542800210437:summary(camera2.all)
1542800222050:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542800222062:camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542800237739:for (i in 1:length(col.change))
1542800237739:{
1542800237739:camera1.all[[col.change[i]]] <- as.numeric(camera1.all[[col.change[i]]])
1542800238014:camera2.all[[col.change[i]]] <- as.numeric(camera2.all[[col.change[i]]])
1542800238016:}
1542800296096:?rename
1542800419075:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542800419088:sound2 <- sound1 %>% select(V1, V2, V3) %>% rename('Week', 'Time', 'Sound')
1542800429827:sound2 <- sound1 %>% select(V1, V2, V3) %>% rename(., 'Week', 'Time', 'Sound')
1542800529845:sound2 <- sound1 %>% select(V1, V2, V3) %>% rename(., Week, Time, Sound)
1542800547894:sound2 <- sound1 %>% select(Week=V1, Time=V2, Sound=V3)
1542800550710:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542800550724:sound2 <- sound1 %>% select(Week=V1, Time=V2, Sound=V3)
1542800550730:sound2
1542800601266:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542800601268:sound2 <- sound1 %>% select(Week=V1, time=V2, noise.level=V3)
1542800601284:sound2$time <-  gsub(",","", sound2$time)
1542800601284:sound2$noise.level <-  gsub(",","", sound2$noise.level)
1542800601299:sound2
1542800679302:gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_'))
1542800689944:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542800689944:sound2 <- sound1 %>% select(date.sound=V1, time=V2, noise.level=V3)
1542800689959:sound2$time <-  gsub(",","", sound2$time)
1542800690121:sound2$noise.level <-  gsub(",","", sound2$noise.level)
1542800690129:sound2
1542800692692:gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_'))
1542800709335:sound2 %>% mutate(Week=gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_')))
1542800709528:sound2
1542800727641:sound2
1542800731800:sound2 %>% mutate(Week=gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_')))
1542800734863:sound2
1542800737813:sound2 %>% mutate(Week=gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_')))
1542800769470:sound2 %>% mutate(Week=gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_'))) %>% mutate(day.week=format(as.Date(sound2$date.sound), "%A"))
1542800819782:sound2 %>% mutate(Week=gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound2$date.sound), "%A"))
1542800867817:sound3 <- sound2 %>% mutate(Week=gsub('_0', '_', paste('week', format(as.Date(sound2$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound2$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542800884064:sound3 <- sound2 %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound2$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542800884235:sound3
1542801036840:format(as.Date(sound2$time), "%r")
1542801052373:as.Date(sound2$time)
1542801067381:?as.Date
1542801166763:strptime('16/Oct/2005:07:51:00',format='%d/%b/%Y:%H:%M:%S')
1542801180045:strptime('07:51:00',format='%H:%M:%S')
1542801197529:format(strptime('07:51:00',format='%H:%M:%S'), '%r'
1542801202439:format(strptime('07:51:00',format='%H:%M:%S'), '%r')
1542801217011:format(strptime('07:51:00',format='%H:%M:%S'), "%r")
1542801241857:format(strptime('07:51:00',format='%H:%M:%S'), "%k")
1542801254445:sound2$time
1542801268458:format(strptime(sound2$time,format='%H:%M:%S'), "%k")
1542801288809:sound3
1542801302788:sound3$hour <- format(strptime(sound2$time,format='%H:%M:%S'), "%k")
1542801302799:sound3
1542801382204:sound3 %>% group_by(week, day.week, hour) %>% summarise(noise.level, ave())
1542801394230:sound3 %>% group_by(week, day.week, hour) #%>% summarise(noise.level, ave())
1542801400397:?summarise
1542801410827:sound3 %>% group_by(week, day.week, hour) %>% summarise(, noise.level, ave())
1542801418733:sound3 %>% group_by(week, day.week, hour) %>% summarise(, noise.level, mean())
1542801438394:sound3 %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542801447597:sound3
1542801466772:sound3 %>% ungroup()
1542801485118:mean(sound3$noise.level)
1542801501481:n(sound3$noise.level)
1542801507690:min(sound3$noise.level)
1542801519893:ave(sound3$noise.level)
1542801590005:mean(sound3$noise.level, na.rm=TRUE)
1542801628237:ave(sound3$noise.level, na.rm=TRUE)
1542801637203:sound3$noise.level
1542801651649:ave(as.numeric(sound3$noise.level), na.rm=TRUE)
1542801656907:mean(as.numeric(sound3$noise.level), na.rm=TRUE)
1542801728028:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542801728043:sound2 <- sound1 %>% select(date.sound=V1, time=V2, noise.level=V3)
1542801728043:sound2$time <-  gsub(",","", sound2$time)
1542801728043:sound2$noise.level <-  as.numeric(gsub(",","", sound2$noise.level))
1542801728059:sound2
1542801728074:sound3 <- sound2 %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound2$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542801728090:sound3$hour <- format(strptime(sound2$time,format='%H:%M:%S'), "%k")
1542801728090:sound3
1542801728106:sound3 %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542801781486:camera1.all
1542801833392:?pivot
1542801869130:?reshape
1542801897597:sound2 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt') %>% select(date.sound=V1, time=V2, noise.level=V3)
1542801897608:sound2 <- sound1
1542801897768:sound2$time <-  gsub(",","", sound2$time)
1542801916570:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542801916570:sound1 %>% select(date.sound=V1, time=V2, noise.level=V3)
1542801916748:sound2 <- sound1
1542801916756:sound2$time <-  gsub(",","", sound2$time)
1542801951458:sound1 <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542801951458:sound2 <- sound1 %>% select(date.sound=V1, time=V2, noise.level=V3)
1542801951474:sound2$time <-  gsub(",","", sound2$time)
1542801951474:sound2$noise.level <-  as.numeric(gsub(",","", sound2$noise.level))
1542801951647:sound2
1542801951658:sound3 <- sound2 %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound2$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound2$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542801951676:sound3$hour <- format(strptime(sound2$time,format='%H:%M:%S'), "%k")
1542801951687:sound3
1542801951700:sound3 %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542802036202:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542802036207:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542802036222:sound.df$time <-  gsub(",","", sound.df$time)
1542802036222:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542802036390:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542802036409:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542802036421:sound.df %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542802091852:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542802091856:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542802091871:sound.df$time <-  gsub(",","", sound.df$time)
1542802091871:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542802091887:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542802091903:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542802091918:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542802091918:sound.summary
1542802184491:for (i.month in 1:nrow(dates.df))
1542802184491:{
1542802184491:for (i.day in 1:dates.df$day[i.month])
1542802184491:{
1542802184491:if(nchar(as.character(i.day))==1)
1542802184491:{
1542802184507:x <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542802184507:} else {
1542802184507:x <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542802184507:}
1542802184507:#print(x)
1542802184507:}
1542802184507:}
1542802686253:?split
1542802729449:# want Week, time
1542802729449:split(sound.summary, day.week)
1542802753211:# want Week, time
1542802753213:split(sound.summary, sound.summary$day.week)
1542802883467:# want Week, time
1542802883469:sound.split <- split(sound.summary, sound.summary$day.week)
1542802891070:sound.split
1542802895717:sound.split[1]
1542802900052:sound.split[2]
1542802907824:sound.summary
1542802929514:as.Date(sound.df$date.sound
1542802933712:as.Date(sound.df$date.sound)
1542802966620:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542802966632:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542802966641:sound.df$time <-  gsub(",","", sound.df$time)
1542802966799:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542802966806:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542802966827:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542802966842:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542802966850:sound.summary
1542802966857:# want Week, time
1542803020930:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-03T00-00-00.txt')
1542803020943:sound.read
1542803032209:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-05T00-00-00.txt')
1542803032344:sound.read
1542803082518:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-05T00-00-00.txt')
1542803082531:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803082538:sound.df
1542803099430:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-08T00-00-00.txt')
1542803099444:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803099453:sound.df
1542803273707:for (i.month in 1:nrow(dates.df))
1542803273709:{
1542803273711:for (i.day in 1:dates.df$day[i.month])
1542803273765:{
1542803273769:if(nchar(as.character(i.day))==1)
1542803273771:{
1542803273773:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803273776:} else {
1542803273778:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803273781:}
1542803273785:sound.read <- read.table(sound.file)
1542803273798:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803273804:sound.df$time <-  gsub(",","", sound.df$time)
1542803273806:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803273810:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803273814:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803273818:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542803273822:sound.all <- rbind(sound.all, sound.summary)
1542803273826:sound.summary <- Null
1542803273828:}
1542803273830:}
1542803348486:sound.summary
1542803429679:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803429688:sound.summary
1542803441113:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803441277:colnames(date.i) <- c('week', 'day.week', 'month.num', 'day', 'mean.noise.level')
1542803448681:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803448686:colnames(sound.all) <- c('week', 'day.week', 'month.num', 'day', 'mean.noise.level')
1542803460988:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803460994:colnames(sound.all) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803461000:for (i.month in 1:nrow(dates.df))
1542803461154:{
1542803461156:for (i.day in 1:dates.df$day[i.month])
1542803461159:{
1542803461163:if(nchar(as.character(i.day))==1)
1542803461165:{
1542803461167:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803461169:} else {
1542803461171:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803461173:}
1542803461180:sound.read <- read.table(sound.file)
1542803461181:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803461183:sound.df$time <-  gsub(",","", sound.df$time)
1542803461185:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803461189:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803461193:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803461197:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542803461201:sound.all <- rbind(sound.all, sound.summary)
1542803461205:sound.summary <- Null
1542803461207:}
1542803461209:}
1542803473659:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803473665:colnames(sound.all) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803473670:for (i.month in 1:nrow(dates.df))
1542803473672:{
1542803473675:for (i.day in 1:dates.df$day[i.month])
1542803473830:{
1542803473834:if(nchar(as.character(i.day))==1)
1542803473836:{
1542803473838:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803473840:} else {
1542803473843:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803473845:}
1542803473852:sound.read <- read.table(sound.file)
1542803473854:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803473856:sound.df$time <-  gsub(",","", sound.df$time)
1542803473858:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803473862:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803473866:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803473884:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean(noise.level))
1542803473888:sound.all <- rbind(sound.all, sound.summary)
1542803473892:sound.summary <- NULL
1542803473895:}
1542803473897:}
1542803536768:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803536774:colnames(sound.all) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803536779:for (i.month in 1:nrow(dates.df))
1542803536782:{
1542803536784:for (i.day in 1:dates.df$day[i.month])
1542803536938:{
1542803536942:if(nchar(as.character(i.day))==1)
1542803536943:{
1542803536945:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803536947:} else {
1542803536949:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803536951:}
1542803536959:#sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803536961:#colnames(sound.all) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803536963:sound.read <- read.table(sound.file)
1542803536965:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803536968:sound.df$time <-  gsub(",","", sound.df$time)
1542803536970:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803536974:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803536978:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803536982:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803536986:sound.all <- rbind(sound.all, sound.summary)
1542803536990:sound.summary <- NULL
1542803536994:}
1542803536996:}
1542803569238:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542803569241:months <- format(ISOdate(2013,1:12,1),"%B")
1542803569246:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542803569251:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542803569257:for (i in 1:12)
1542803569259:{
1542803569261:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542803569263:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542803569267:date.i$year <- '2013'
1542803569269:date.i$month.char <- months[i]
1542803569272:if(nchar(as.character(i))==1)
1542803569324:{
1542803569327:date.i$month.num <- paste('0', i, sep='')
1542803569329:} else {
1542803569331:date.i$month.num <- i
1542803569333:}
1542803569338:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542803569341:dates.df <- rbind(dates.df, date.i)
1542803569345:date.i <- NULL
1542803569347:}
1542803569370:dates.df
1542803575519:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803575525:colnames(sound.all) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803575531:for (i.month in 1:nrow(dates.df))
1542803575533:{
1542803575535:for (i.day in 1:dates.df$day[i.month])
1542803575537:{
1542803575542:if(nchar(as.character(i.day))==1)
1542803575544:{
1542803575547:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803575549:} else {
1542803575551:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803575605:}
1542803575612:sound.summary <- data.frame(matrix(ncol = 4, nrow = 1))
1542803575614:colnames(sound.summary) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803575616:sound.read <- read.table(sound.file)
1542803575618:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803575621:sound.df$time <-  gsub(",","", sound.df$time)
1542803575623:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803575627:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803575630:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803575634:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803575638:sound.all <- rbind(sound.all, sound.summary)
1542803575642:sound.summary <- NULL
1542803575644:}
1542803575646:}
1542803602116:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803602121:colnames(sound.all) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803602126:for (i.month in 1:nrow(dates.df))
1542803602129:{
1542803602131:for (i.day in 1:dates.df$day[i.month])
1542803602133:{
1542803602137:if(nchar(as.character(i.day))==1)
1542803602139:{
1542803602141:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803602143:} else {
1542803602145:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803602148:}
1542803602205:sound.summary <- data.frame(matrix(ncol = 4, nrow = 1))
1542803602207:colnames(sound.summary) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803602210:sound.read <- read.table(sound.file)
1542803602212:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803602214:sound.df$time <-  gsub(",","", sound.df$time)
1542803602217:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803602221:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803602224:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803602228:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803602230:print(sound.summary)
1542803602233:print(sound.all)
1542803602235:sound.all <- rbind(sound.all, sound.summary)
1542803602239:sound.summary <- NULL
1542803602241:}
1542803602243:}
1542803630242:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803630251:colnames(sound.all) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803630409:for (i.month in 1:nrow(dates.df))
1542803630411:{
1542803630413:for (i.day in 1:dates.df$day[i.month])
1542803630415:{
1542803630419:if(nchar(as.character(i.day))==1)
1542803630421:{
1542803630423:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803630425:} else {
1542803630427:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803630429:}
1542803630436:sound.summary <- data.frame(matrix(ncol = 4, nrow = 1))
1542803630438:colnames(sound.summary) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803630441:sound.read <- read.table(sound.file)
1542803630443:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803630445:print(sound.df)
1542803630447:sound.df$time <-  gsub(",","", sound.df$time)
1542803630449:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803630452:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803630456:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803630460:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803630462:print(sound.summary)
1542803630464:print(sound.all)
1542803630466:sound.all <- rbind(sound.all, sound.summary)
1542803630469:sound.summary <- NULL
1542803630471:}
1542803630473:}
1542803727058:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803727064:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542803727070:for (i.month in 1:nrow(dates.df))
1542803727072:{
1542803727074:for (i.day in 1:dates.df$day[i.month])
1542803727076:{
1542803727080:if(nchar(as.character(i.day))==1)
1542803727082:{
1542803727085:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803727087:} else {
1542803727089:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803727091:}
1542803727099:sound.summary <- data.frame(matrix(ncol = 4, nrow = 1))
1542803727101:colnames(sound.summary) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803727104:sound.read <- read.table(sound.file)
1542803727106:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803727108:print(sound.df)
1542803727110:sound.df$time <-  gsub(",","", sound.df$time)
1542803727112:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803727116:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803727120:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803727124:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803727126:print(sound.summary)
1542803727128:print(sound.all)
1542803727131:sound.all <- rbind(sound.all, sound.summary)
1542803727134:sound.summary <- NULL
1542803727137:}
1542803727139:}
1542803752238:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803752244:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542803752250:for (i.month in 1:nrow(dates.df))
1542803752252:{
1542803752254:for (i.day in 1:dates.df$day[i.month])
1542803752257:{
1542803752261:if(nchar(as.character(i.day))==1)
1542803752263:{
1542803752417:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803752420:} else {
1542803752421:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803752423:}
1542803752430:sound.summary <- data.frame(matrix(ncol = 4, nrow = 1))
1542803752433:colnames(sound.summary) <- c('week', 'day.week', 'month.num', 'mean.noise.level')
1542803752435:sound.read <- read.table(sound.file)
1542803752437:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803752439:print(sound.df)
1542803752441:sound.df$time <-  gsub(",","", sound.df$time)
1542803752444:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803752448:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803752452:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803752455:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803752457:print(sound.summary)
1542803752460:print(sound.all)
1542803752462:sound.all <- rbind(sound.all, sound.summary)
1542803752465:print(sound.all)
1542803752467:sound.summary <- NULL
1542803752469:}
1542803752471:}
1542803783426:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803783430:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542803783437:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-08T00-00-00.txt')
1542803783449:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803783456:sound.df$time <-  gsub(",","", sound.df$time)
1542803783463:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803783470:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803783492:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803783504:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803783511:sound.summary
1542803783518:rbind(sound.all, sound.summary)
1542803803049:sound.all
1542803803112:sound.summary
1542803818614:sound.all<- rbind(sound.all, sound.summary)
1542803825802:sound.all
1542803877363:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542803877369:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542803877375:for (i.month in 1:nrow(dates.df))
1542803877377:{
1542803877379:for (i.day in 1:dates.df$day[i.month])
1542803877381:{
1542803877385:if(nchar(as.character(i.day))==1)
1542803877387:{
1542803877389:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803877391:} else {
1542803877393:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803877395:}
1542803877402:sound.read <- read.table(sound.file)
1542803877405:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803877407:print(sound.df)
1542803877410:sound.df$time <-  gsub(",","", sound.df$time)
1542803877412:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803877416:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803877420:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803877424:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803877426:print(sound.summary)
1542803877428:print(sound.all)
1542803877430:sound.all <- rbind(sound.all, sound.summary)
1542803877432:print(sound.all)
1542803877434:sound.summary <- NULL
1542803877437:}
1542803877439:}
1542803892647:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542803892652:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542803892658:for (i.month in 1:nrow(dates.df))
1542803892660:{
1542803892662:for (i.day in 1:dates.df$day[i.month])
1542803892664:{
1542803892668:if(nchar(as.character(i.day))==1)
1542803892670:{
1542803892672:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542803892675:} else {
1542803892677:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542803892679:}
1542803892736:sound.read <- read.table(sound.file)
1542803892739:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542803892741:print(sound.df)
1542803892743:sound.df$time <-  gsub(",","", sound.df$time)
1542803892746:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542803892749:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542803892753:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542803892757:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542803892759:print(sound.summary)
1542803892761:print(sound.all)
1542803892763:sound.all <- rbind(sound.all, sound.summary)
1542803892765:print(sound.all)
1542803892767:sound.summary <- NULL
1542803892769:}
1542803892772:}
1542804037053:sound.summary <- NULL
1542804037054:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542804037054:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804037054:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-08T00-00-00.txt')
1542804037070:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804037085:sound.df$time <-  gsub(",","", sound.df$time)
1542804037094:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804037104:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804037124:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804037136:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804037144:sound.all
1542804037151:sound.summary
1542804037161:sound.all<- rbind(sound.all, sound.summary)
1542804037169:sound.all
1542804168974:is.df(sound.all)
1542804174633:is.dateframe(sound.all)
1542804186271:is.data.frame(sound.all)
1542804190981:is.data.frame(sound.summary)
1542804204023:sound.summary <- NULL
1542804204023:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542804204023:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804204038:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-08T00-00-00.txt')
1542804204038:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804204054:sound.df$time <-  gsub(",","", sound.df$time)
1542804204054:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804204069:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804204085:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804204101:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804204101:is.data.frame(sound.all)
1542804204116:is.data.frame(sound.summary)
1542804204116:sound.all<- rbind(sound.all, sound.summary)
1542804204116:sound.all
1542804226598:is.data.frame(sound.all)
1542804233164:sound.summary <- NULL
1542804233164:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542804233164:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804233180:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-08T00-00-00.txt')
1542804233180:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804233195:sound.df$time <-  gsub(",","", sound.df$time)
1542804233207:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804233217:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804233238:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804233249:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804233257:is.data.frame(sound.all)
1542804233261:is.data.frame(sound.summary)
1542804233266:rbind(sound.all, sound.summary)
1542804233292:is.data.frame(sound.all)
1542804249409:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542804249410:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542804249410:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542804250203:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542804250213:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542804250213:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542804250228:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542804250294:for(week.i in 1:length(sheet.names))
1542804250294:{
1542804250294:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542804250294:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542804250294:camera1.row <- which(grepl(camera1.name, f1$Time))
1542804250310:camera2.row <- which(grepl(camera2.name, f1$Time))
1542804250310:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542804250310:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542804250310:camera1.all <- rbind(camera1.all, camera1.slice)
1542804250310:camera2.all <- rbind(camera2.all, camera2.slice)
1542804250310:f1 <- NULL
1542804250325:}
1542804476441:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542804476444:for (i in 1:length(col.change))
1542804476446:{
1542804476448:camera1.all[[col.change[i]]] <- as.numeric(camera1.all[[col.change[i]]])
1542804476450:camera2.all[[col.change[i]]] <- as.numeric(camera2.all[[col.change[i]]])
1542804476453:}
1542804476483:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542804476495:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542804476508:summary(camera1.all)
1542804476634:summary(camera2.all)
1542804485661:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542804485676:camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542804485852:camera1.all
1542804496611:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542804496627:camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542804534167:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542804534167:months <- format(ISOdate(2013,1:12,1),"%B")
1542804534167:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542804534182:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542804534182:for (i in 1:12)
1542804534182:{
1542804534182:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542804534182:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542804534198:date.i$year <- '2013'
1542804534198:date.i$month.char <- months[i]
1542804534198:if(nchar(as.character(i))==1)
1542804534198:{
1542804534198:date.i$month.num <- paste('0', i, sep='')
1542804534198:} else {
1542804534198:date.i$month.num <- i
1542804534213:}
1542804534213:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542804534213:dates.df <- rbind(dates.df, date.i)
1542804534213:date.i <- NULL
1542804534213:}
1542804534245:dates.df
1542804540862:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542804540868:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804540874:for (i.month in 1:nrow(dates.df))
1542804540876:{
1542804540878:for (i.day in 1:dates.df$day[i.month])
1542804540881:{
1542804540885:if(nchar(as.character(i.day))==1)
1542804540886:{
1542804540886:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542804540886:} else {
1542804540886:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542804541048:}
1542804541055:sound.read <- read.table(sound.file)
1542804541057:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804541059:print(sound.df)
1542804541062:sound.df$time <-  gsub(",","", sound.df$time)
1542804541064:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804541068:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804541072:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804541076:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804541078:print(sound.summary)
1542804541081:print(sound.all)
1542804541083:sound.all <- rbind(sound.all, sound.summary)
1542804541085:print(sound.all)
1542804541087:sound.summary <- NULL
1542804541089:}
1542804541091:}
1542804565513:camera1.all
1542804577726:camera1.all
1542804577904:camera2.all
1542804604357:camera1.all
1542804604720:camera1.slice
1542804604733:rbind(camera2.all, camera2.slice)
1542804627193:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542804627193:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804627218:for (i.month in 1:nrow(dates.df))
1542804627221:{
1542804627223:for (i.day in 1:dates.df$day[i.month])
1542804627225:{
1542804627230:if(nchar(as.character(i.day))==1)
1542804627232:{
1542804627235:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542804627237:} else {
1542804627239:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542804627242:}
1542804627249:sound.read <- read.table(sound.file)
1542804627251:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804627253:print(sound.df)
1542804627255:sound.df$time <-  gsub(",","", sound.df$time)
1542804627257:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804627261:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804627265:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804627269:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804627271:print(sound.summary)
1542804627274:print(sound.all)
1542804627276:sound.all <- rbind(sound.all, sound.summary)
1542804627278:print(sound.all)
1542804627280:sound.summary <- NULL
1542804627283:}
1542804627285:}
1542804644362:sound.all <- NULL
1542804644362:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542804644362:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804644362:for (i.month in 1:nrow(dates.df))
1542804644378:{
1542804644378:for (i.day in 1:dates.df$day[i.month])
1542804644378:{
1542804644378:if(nchar(as.character(i.day))==1)
1542804644378:{
1542804644378:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542804644394:} else {
1542804644394:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542804644394:}
1542804644394:sound.read <- read.table(sound.file)
1542804644394:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804644394:print(sound.df)
1542804644445:sound.df$time <-  gsub(",","", sound.df$time)
1542804644447:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804644451:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804644455:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804644459:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804644461:print(sound.summary)
1542804644463:print(sound.all)
1542804644466:sound.all <- rbind(sound.all, sound.summary)
1542804644468:print(sound.all)
1542804644470:sound.summary <- NULL
1542804644472:}
1542804644474:}
1542804690925:sound.summary <- NULL
1542804690927:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542804690927:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804690927:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-08T00-00-00.txt')
1542804690942:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804690958:sound.df$time <-  gsub(",","", sound.df$time)
1542804690958:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804690976:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804690995:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804691009:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804691030:is.data.frame(sound.all)
1542804691034:is.data.frame(sound.summary)
1542804691039:rbind(sound.all, sound.summary)
1542804691050:is.data.frame(sound.all)
1542804769253:rbind.data.frame(sound.all, sound.summary)
1542804778545:sound.summary <- NULL
1542804778545:sound.all <- data.frame(matrix(ncol = 4, nrow = 1))
1542804778545:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804778560:sound.read <- read.table('ambient_sound/2013/January/DCC-NOISE-001011-2013-01-08T00-00-00.txt')
1542804778576:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804778576:sound.df$time <-  gsub(",","", sound.df$time)
1542804778576:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804778591:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804778607:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804778622:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804778622:is.data.frame(sound.all)
1542804778638:is.data.frame(sound.summary)
1542804778638:rbind.data.frame(sound.all, sound.summary)
1542804778654:is.data.frame(sound.all)
1542804792411:sound.all <- NULL
1542804792415:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542804792415:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804792415:for (i.month in 1:nrow(dates.df))
1542804792415:{
1542804792431:for (i.day in 1:dates.df$day[i.month])
1542804792431:{
1542804792431:if(nchar(as.character(i.day))==1)
1542804792431:{
1542804792442:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542804792445:} else {
1542804792450:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542804792452:}
1542804792457:sound.read <- read.table(sound.file)
1542804792459:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804792461:print(sound.df)
1542804792463:sound.df$time <-  gsub(",","", sound.df$time)
1542804792463:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804792463:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804792463:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804792463:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804792480:print(sound.summary)
1542804792482:print(sound.all)
1542804792485:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542804792487:print(sound.all)
1542804792490:sound.summary <- NULL
1542804792490:}
1542804792490:}
1542804825960:sound.all <- NULL
1542804825960:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542804825960:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804825976:for (i.month in 1:nrow(dates.df))
1542804825976:{
1542804825976:for (i.day in 1:dates.df$day[i.month])
1542804825976:{
1542804825976:if(nchar(as.character(i.day))==1)
1542804825976:{
1542804825992:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542804825992:} else {
1542804825992:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542804825992:}
1542804825992:sound.read <- read.table(sound.file)
1542804826007:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804826007:sound.df$time <-  gsub(",","", sound.df$time)
1542804826007:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804826007:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804826007:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804826023:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804826023:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542804826023:sound.summary <- NULL
1542804826023:}
1542804826023:}
1542804839123:ambient.sound.url <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542804839123:download.file(ambient.sound.url, destfile = 'ambient_sound.zip')
1542804839982:unzip('ambient_sound.zip', exdir = './ambient_sound')
1542804842895:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542804842898:months <- format(ISOdate(2013,1:12,1),"%B")
1542804842903:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542804842909:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542804842914:for (i in 1:12)
1542804842917:{
1542804842919:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542804842921:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542804842925:date.i$year <- '2013'
1542804842928:date.i$month.char <- months[i]
1542804842930:if(nchar(as.character(i))==1)
1542804842933:{
1542804842936:date.i$month.num <- paste('0', i, sep='')
1542804842938:} else {
1542804842941:date.i$month.num <- i
1542804842943:}
1542804842948:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542804842952:dates.df <- rbind(dates.df, date.i)
1542804842957:date.i <- NULL
1542804842960:}
1542804842997:dates.df
1542804847740:sound.all <- NULL
1542804847740:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542804847740:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804847756:for (i.month in 1:nrow(dates.df))
1542804847756:{
1542804847756:for (i.day in 1:dates.df$day[i.month])
1542804847756:{
1542804847756:if(nchar(as.character(i.day))==1)
1542804847771:{
1542804847771:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542804847771:} else {
1542804847771:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542804847771:}
1542804847771:sound.read <- read.table(sound.file)
1542804847941:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804847944:sound.df$time <-  gsub(",","", sound.df$time)
1542804847946:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804847950:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804847953:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804847956:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804847959:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542804847961:sound.summary <- NULL
1542804847963:}
1542804847966:}
1542804887506:sound.all <- NULL
1542804887506:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542804887506:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542804887522:for (i.month in 1:nrow(dates.df))
1542804887522:{
1542804887522:for (i.day in 1:dates.df$day[i.month])
1542804887522:{
1542804887536:if(nchar(as.character(i.day))==1)
1542804887539:{
1542804887541:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542804887543:} else {
1542804887548:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542804887551:}
1542804887555:sound.read <- read.table(sound.file)
1542804887557:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542804887560:sound.df$time <-  gsub(",","", sound.df$time)
1542804887562:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542804887565:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542804887569:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542804887573:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542804887578:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542804887582:sound.summary <- NULL
1542804887584:}
1542804887586:}
1542805089334:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542805089338:options(digits=2)
1542805089455:library(devtools)
1542805090289:library(readr)
1542805090473:library(ggplot2)
1542805090660:library(ggmap)
1542805090823:devtools::install_github('hadley/ggplot2')
1542805092095:devtools::install_github('dkahle/ggmap')
1542805092818:library(rnoaa)
1542805093290:library(httr)
1542805093300:library(plyr)
1542805093310:library(jsonlite)
1542805093320:library(dplyr)
1542805093385:library(readODS)
1542805093408:library(knitr)
1542805093417:library(hms)
1542805093427:library(lubridate)
1542805103751:ambient.sound.url <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542805103751:download.file(ambient.sound.url, destfile = 'ambient_sound.zip')
1542805104547:unzip('ambient_sound.zip', exdir = './ambient_sound')
1542805107071:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542805107071:months <- format(ISOdate(2013,1:12,1),"%B")
1542805107114:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542805107114:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542805107146:for (i in 1:12)
1542805107146:{
1542805107146:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542805107146:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542805107146:date.i$year <- '2013'
1542805107161:date.i$month.char <- months[i]
1542805107161:if(nchar(as.character(i))==1)
1542805107165:{
1542805107168:date.i$month.num <- paste('0', i, sep='')
1542805107170:} else {
1542805107173:date.i$month.num <- i
1542805107175:}
1542805107178:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542805107182:dates.df <- rbind(dates.df, date.i)
1542805107186:date.i <- NULL
1542805107189:}
1542805107327:dates.df
1542805111488:sound.all <- NULL
1542805111488:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542805111488:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542805111504:for (i.month in 1:nrow(dates.df))
1542805111504:{
1542805111504:for (i.day in 1:dates.df$day[i.month])
1542805111504:{
1542805111504:if(nchar(as.character(i.day))==1)
1542805111520:{
1542805111520:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542805111520:} else {
1542805111520:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542805111520:}
1542805111520:sound.read <- read.table(sound.file)
1542805111535:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542805111535:sound.df$time <-  gsub(",","", sound.df$time)
1542805111535:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542805111535:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542805111535:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542805111551:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542805111556:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542805111559:sound.summary <- NULL
1542805111562:}
1542805111564:}
1542805154367:ambient.sound.url <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542805154367:download.file(ambient.sound.url, destfile = 'ambient_sound.zip')
1542805154994:unzip('ambient_sound.zip', exdir = './ambient_sound')
1542805191584:sound.all <- NULL
1542805191594:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542805191594:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542805191610:for (i.month in 1:nrow(dates.df))
1542805191610:{
1542805191610:for (i.day in 1:dates.df$day[i.month])
1542805191610:{
1542805191626:if(nchar(as.character(i.day))==1)
1542805191626:{
1542805191626:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542805191626:} else {
1542805191626:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542805191626:}
1542805191641:sound.read <- read.table(sound.file)
1542805191641:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542805191641:sound.df$time <-  gsub(",","", sound.df$time)
1542805191641:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542805191641:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542805191641:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542805191657:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542805191657:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542805191657:sound.summary <- NULL
1542805191657:}
1542805191657:}
1542805215528:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542805215528:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542805215528:for (i.month in 1:nrow(dates.df))
1542805215528:{
1542805215543:for (i.day in 1:dates.df$day[i.month])
1542805215543:{
1542805215543:if(nchar(as.character(i.day))==1)
1542805215543:{
1542805215543:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542805215543:} else {
1542805215559:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542805215559:}
1542805215559:sound.read <- read.table(sound.file)
1542805215559:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542805215559:sound.df$time <-  gsub(",","", sound.df$time)
1542805215575:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542805215681:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542805215686:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542805215689:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542805215693:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542805215696:sound.summary <- NULL
1542805215698:}
1542805215700:}
1542805289157:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542805289157:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542805289157:for (i.month in 1:nrow(dates.df))
1542805289157:{
1542805289173:for (i.day in 1:dates.df$day[i.month])
1542805289173:{
1542805289173:if(nchar(as.character(i.day))==1)
1542805289173:{
1542805289173:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542805289173:} else {
1542805289173:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542805289189:}
1542805289189:print(sound.file)
1542805289189:sound.read <- read.table(sound.file)
1542805289189:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542805289189:sound.df$time <-  gsub(",","", sound.df$time)
1542805289189:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542805289189:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542805289204:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542805289204:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542805289204:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542805289204:sound.summary <- NULL
1542805289220:}
1542805289220:}
1542805316441:sound.all
1542805448025:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542805448025:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542805448025:for (i.month in 1:nrow(dates.df))
1542805448025:{
1542805448040:for (i.day in 1:dates.df$day[i.month])
1542805448040:{
1542805448040:if(nchar(as.character(i.day))==1)
1542805448040:{
1542805448040:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542805448040:} else {
1542805448056:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542805448056:}
1542805448056:if (file.exists(sound.file))
1542805448056:print(sound.file)
1542805448056:sound.read <- read.table(sound.file)
1542805448056:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542805448056:sound.df$time <-  gsub(",","", sound.df$time)
1542805448071:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542805448071:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542805448071:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542805448071:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542805448071:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542805448087:sound.summary <- NULL
1542805448087:}
1542805448087:}
1542805477949:if (file.exists("ambient_sound/2013/February/DCC-NOISE-001011-2013-02-17T00-00-00.txt"))
1542805485974:file.exists("ambient_sound/2013/February/DCC-NOISE-001011-2013-02-17T00-00-00.txt")
1542805491240:file.exists("ambient_sound/2013/February/DCC-NOISE-001011-2013-02-18T00-00-00.txt")
1542805546422:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542805546422:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542805546422:for (i.month in 1:nrow(dates.df))
1542805546422:{
1542805546437:for (i.day in 1:dates.df$day[i.month])
1542805546437:{
1542805546437:if(nchar(as.character(i.day))==1)
1542805546437:{
1542805546437:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542805546437:} else {
1542805546453:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542805546453:}
1542805546453:if (file.exists(sound.file)) next
1542805546463:print(sound.file)
1542805546465:sound.read <- read.table(sound.file)
1542805546467:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542805546470:sound.df$time <-  gsub(",","", sound.df$time)
1542805546472:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542805546476:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542805546479:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542805546482:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542805546486:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542805546490:sound.summary <- NULL
1542805546492:}
1542805546494:}
1542805560774:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542805560774:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542805560774:for (i.month in 1:nrow(dates.df))
1542805560774:{
1542805560789:for (i.day in 1:dates.df$day[i.month])
1542805560789:{
1542805560789:if(nchar(as.character(i.day))==1)
1542805560789:{
1542805560789:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542805560789:} else {
1542805560789:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542805560805:}
1542805560805:if (!file.exists(sound.file)) next
1542805560805:print(sound.file)
1542805560805:sound.read <- read.table(sound.file)
1542805560805:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542805560820:sound.df$time <-  gsub(",","", sound.df$time)
1542805560823:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542805560827:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542805560831:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542805560835:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542805560839:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542805560843:sound.summary <- NULL
1542805560845:}
1542805560846:}
1542805593757:sound.all
1542805627082:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542805627082:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542805627268:for (i.month in 1:nrow(dates.df))
1542805627271:{
1542805627273:for (i.day in 1:dates.df$day[i.month])
1542805627275:{
1542805627280:if(nchar(as.character(i.day))==1)
1542805627283:{
1542805627285:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542805627288:} else {
1542805627291:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542805627294:}
1542805627296:if (!file.exists(sound.file)) next
1542805627300:sound.read <- read.table(sound.file)
1542805627302:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542805627306:sound.df$time <-  gsub(",","", sound.df$time)
1542805627309:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542805627313:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542805627318:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542805627323:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542805627328:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542805627334:sound.summary <- NULL
1542805627337:}
1542805627340:}
1542805659391:sound.all
1542805720613:sound.split <- split(sound.all, day.week)
1542805731035:sound.split <- split(sound.all, sound.all$day.week)
1542805735319:sound.split
1542805876950:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542805876954:download.file(url.footfall, 'footfall_ods.ods')
1542805879671:#getting list of camera locations
1542805879671:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542805887997:library(devtools)
1542805887997:library(readr)
1542805887997:library(ggplot2)
1542805887997:library(ggmap)
1542805887997:devtools::install_github('hadley/ggplot2')
1542805888884:devtools::install_github('dkahle/ggmap')
1542805889452:library(rnoaa)
1542805889476:library(httr)
1542805889476:library(plyr)
1542805889476:library(jsonlite)
1542805889476:library(dplyr)
1542805889476:library(readODS)
1542805889476:library(knitr)
1542805889491:library(hms)
1542805889491:library(lubridate)
1542805903355:#getting list of camera locations
1542805903355:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542805926940:#getting list of camera locations
1542805926940:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542805938835:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542805938835:download.file(url.footfall, 'footfall_ods.ods')
1542805939673:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542805944433:#getting list of camera locations
1542805944433:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542805948693:colnames(camera.locations) <- c('Loc')
1542805948693:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE))
1542805952304:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542805952305:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542805952305:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542805952470:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542805952484:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542805952492:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542805952501:for(week.i in 1:length(sheet.names))
1542805952503:{
1542805952508:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542805952512:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542805952515:camera1.row <- which(grepl(camera1.name, f1$Time))
1542805952517:camera2.row <- which(grepl(camera2.name, f1$Time))
1542805952519:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542805952521:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542805952525:camera1.all <- rbind(camera1.all, camera1.slice)
1542805952527:camera2.all <- rbind(camera2.all, camera2.slice)
1542805952530:f1 <- NULL
1542805952532:}
1542806169076:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542806169076:for (i in 1:length(col.change))
1542806169076:{
1542806169076:camera1.all[[col.change[i]]] <- as.numeric(camera1.all[[col.change[i]]])
1542806169076:camera2.all[[col.change[i]]] <- as.numeric(camera2.all[[col.change[i]]])
1542806169076:}
1542806216992:sound.split$Friday
1542806251957:sound.split$Friday$mean.noise.level
1542806264090:sound.split$Friday
1542806407037:sound.split$Friday[mean.noise.level] <- 'Fri.noise.level'
1542806502201:names(sound.split$Friday$mean.noise.level) <- 'Fri.noise.level'
1542806509658:sound.split$Friday
1542806625809:sound.fri <- sound.split$Friday %>% select(week, hour, fri.noise=mean.noise.level)
1542806625927:sound.fri
1542806659686:sound.fri <- sound.split$Friday %>% select(week, hour, fri.noise=mean.noise.level)
1542806659704:sound.fri
1542806741597:sound.mon <- sound.split$Monday %>% select(week, hour, mon.noise=mean.noise.level)
1542806741714:sound.tue <- sound.split$Tuesday %>% select(week, hour, tue.noise=mean.noise.level)
1542806741731:sound.wed <- sound.split$Wednesday %>% select(week, hour, wed.noise=mean.noise.level)
1542806741749:sound.thurs <- sound.split$Thursday %>% select(week, hour, thurs.noise=mean.noise.level)
1542806741766:sound.fri <- sound.split$Friday %>% select(week, hour, fri.noise=mean.noise.level)
1542806741783:sound.sat <- sound.split$Saturday %>% select(week, hour, sat.noise=mean.noise.level)
1542806741801:sound.sun <- sound.split$Sunday %>% select(week, hour, sun.noise=mean.noise.level)
1542809318161:sound.mon
1542809318198:sound.tue
1542809378846:sound.mon left_join(sound.tue, by=c('week', 'hour'))
1542809387199:sound.mon %>% left_join(sound.tue, by=c('week', 'hour'))
1542809456303:sound.mon %>% left_join(sound.tue, by=c('week', 'hour')) %>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542809475990:sound.sun
1542809484979:sound.mon %>% left_join(sound.tue, by=c('week', 'hour')) %>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542809524326:camera1.all
1542809575892:sound.new %>% select(week, hour, mon.noise, tue.noise, wed.noise, thurs.noise, fri.noise, sat.noise, sun.noise)
1542809582193:sound.new <- sound.mon %>% left_join(sound.tue, by=c('week', 'hour')) %>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542809582948:sound.new %>% select(week, hour, mon.noise, tue.noise, wed.noise, thurs.noise, fri.noise, sat.noise, sun.noise)
1542809615707:sound.split <- split(sound.all, sound.all$day.week)
1542809615851:sound.split %>% ungroup()
1542809631055:sound.sun
1542809644014:is.data.frame(sound.sun)
1542809654820:sound.sun
1542809700867:sound.new %>% select(week, hour, mon.noise, tue.noise, wed.noise, thurs.noise, fri.noise, sat.noise, sun.noise)
1542809733113:sound.mon
1542809745044:sound.new <- sound.mon %>% left_join(sound.tue, by=c('week', 'hour'))
1542809749645:sound.new
1542809777489:sound.mon
1542809777617:sound.new <- sound.mon %>% left_join(sound.tue, by=c('week', 'hour'))
1542809777628:#%>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542809777631:sound.new
1542809795564:sound.mon
1542809795695:sound.tue
1542809795719:sound.new <- sound.mon %>% left_join(sound.tue, by=c('week', 'hour'))
1542809795730:#%>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542809795733:sound.new
1542809845907:sound.mon2 <- select(sound.mon, week, hour, mon.noise)
1542809846040:sound.mon2
1542809864063:?select
1542809870143:sound.mon2 <- dplyr::select(sound.mon, week, hour, mon.noise)
1542809872893:sound.mon2
1542809897824:ungroup(sound.mon)
1542809903634:sound.mon2 <- dplyr::select(sound.mon, week, hour, mon.noise)
1542809903650:sound.mon2
1542809971772:sound.mon2 <- sound.mon %>% dplyr::select(week, hour, mon.noise)
1542809971942:sound.mon2
1542809995016:sound.mon2 <- sound.mon[1]
1542809995022:sound.mon2
1542810001861:sound.mon2 <- sound.mon[2:4]
1542810001868:sound.mon2
1542810021186:sound.mon <- sound.split$Monday[2:4] %>% select(week, hour, mon.noise=mean.noise.level)
1542810031031:sound.mon <- sound.split$Monday[2:4] %>% select(., week, hour, mon.noise=mean.noise.level)
1542810040194:sound.split$Monday[2:4]
1542810056591:sound.split$Monday
1542810065436:sound.split$Monday[1,3,4]
1542810073143:sound.split$Monday[1,3:4]
1542810134920:sound.mon[2:4]
1542810134936:sound.tue[2:4]
1542810134951:sound.new <- sound.mon[2:4] %>% left_join(sound.tue[2:4], by=c('week', 'hour'))
1542810134967:#%>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542810134967:sound.new
1542810169918:sound.mon[2:4]
1542810170045:sound.tue[2:4]
1542810170064:sound.new <- sound.mon[2:4] %>% left_join(sound.tue[2:4], by=c('hour')
1542810170067:#%>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542810170068:sound.new
1542810181046:sound.mon[2:4]
1542810181173:sound.tue[2:4]
1542810181192:sound.new <- sound.mon[2:4] %>% left_join(sound.tue[2:4], by='hour')
1542810181199:#%>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542810181202:sound.new
1542810197633:sound.mon[2:4]
1542810197757:sound.tue[2:4]
1542810197777:sound.new <- sound.mon[2:4] %>% left_join(sound.tue[2:4], by=c('week', 'hour'))
1542810197784:#%>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542810197787:sound.new
1542810211442:sound.mon[2:4]
1542810211567:sound.tue[2:4]
1542810211588:sound.new <- sound.mon[2:4] %>% inner_join(sound.tue[2:4], by=c('week', 'hour'))
1542810211596:#%>% left_join(sound.wed, by=c('week', 'hour')) %>% left_join(sound.thurs, by=c('week', 'hour')) %>% left_join(sound.fri, by=c('week', 'hour')) %>% left_join(sound.sat, by=c('week', 'hour')) %>% left_join(sound.sun, by=c('week', 'hour'))
1542810211598:sound.new
1542810239394:sound.mon
1542810264920:sound.all
1542810311384:filter(sound.all, week=='Week_3')
1542810352970:sound.summary
1542810379149:sound.df
1542810392643:?count
1542810412933:count(sound.df, week, day.week)
1542810423318:sound.df
1542810433345:count(sound.df, week, day.week, hour)
1542810478068:sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542810715495:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542810715497:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542810715497:for (i.month in 1:nrow(dates.df))
1542810715497:{
1542810715497:for (i.day in 1:dates.df$day[i.month])
1542810715513:{
1542810715513:if(nchar(as.character(i.day))==1)
1542810715513:{
1542810715513:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542810715513:} else {
1542810715513:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542810715528:}
1542810715535:if (!file.exists(sound.file)) next
1542810715538:sound.read <- read.table(sound.file)
1542810715540:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542810715543:sound.df$time <-  gsub(",","", sound.df$time)
1542810715545:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542810715548:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542810715552:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542810715556:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542810715560:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542810715564:sound.summary <- NULL
1542810715566:sound.df<- NULL
1542810715568:}
1542810715570:}
1542810722208:sound.all
1542810739239:count(sound.all, week, day.week, hour)
1542810840093:sound.read <- read.table('ambient_sound/2013/February/DCC-NOISE-001011-2013-02-16T00-00-00')
1542810861994:sound.read <- read.table('ambient_sound/2013/February/DCC-NOISE-001011-2013-02-16T00-00-00.txt')
1542810862006:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542810870202:sound.df
1542810889901:sound.df$time <-  gsub(",","", sound.df$time)
1542810889901:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542810889901:sound.df
1542810903524:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542810911085:sound.df
1542810919560:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542810919573:sound.df
1542810934754:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542810934762:sound.summary
1542810995194:print(distinct(sound.summary$week, sound.summary$day.week))
1542811008867:sound.summary$week
1542811017331:sound.summary$weeksound.summary$day.week
1542811024288:sound.summary$day.week
1542811047146:sound.summary %>% select(week, day.week)
1542811054130:sound.summary %>% select(week, day.week) %>% distinct()
1542811060909:print(sound.summary %>% select(week, day.week) %>% distinct())
1542811075295:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542811075301:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542811075307:for (i.month in 1:nrow(dates.df))
1542811075307:{
1542811075307:for (i.day in 1:dates.df$day[i.month])
1542811075307:{
1542811075307:if(nchar(as.character(i.day))==1)
1542811075307:{
1542811075307:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542811075323:} else {
1542811075325:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542811075327:}
1542811075332:if (!file.exists(sound.file)) next
1542811075334:sound.read <- read.table(sound.file)
1542811075336:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542811075339:sound.df$time <-  gsub(",","", sound.df$time)
1542811075341:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542811075345:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542811075348:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542811075352:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542811075355:print(sound.summary %>% select(week, day.week) %>% distinct())
1542811075359:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542811075362:sound.summary <- NULL
1542811075364:sound.df<- NULL
1542811075366:}
1542811075368:}
1542811084524:sound.all
1542811121748:print(sound.summary %>% select(week, day.week) %>% distinct()[1])
1542811126208:print(sound.summary %>% select(week, day.week) %>% distinct())
1542811146935:sound.read <- read.table('ambient_sound/2013/February/DCC-NOISE-001011-2013-02-16T00-00-00.txt')
1542811146935:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542811146950:sound.df
1542811146966:sound.df$time <-  gsub(",","", sound.df$time)
1542811146966:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542811146966:sound.df
1542811146981:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542811146997:sound.df
1542811147012:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542811147915:sound.df
1542811147928:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542811147936:sound.summary
1542811147947:print(distinct(sound.summary$week, sound.summary$day.week))
1542811159797:print(sound.summary %>% select(week, day.week) %>% distinct())
1542811165957:print(sound.summary %>% select(week, day.week) %>% distinct()[1])
1542811173985:print(sound.summary %>% select(week, day.week) %>% distinct()[[1]])
1542811178207:print(sound.summary %>% select(week, day.week) %>% distinct())
1542811252660:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542811252660:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542811252660:sound.days <- data.frame(matrix(ncol = 2, nrow = 0))
1542811252676:for (i.month in 1:nrow(dates.df))
1542811252676:{
1542811252676:for (i.day in 1:dates.df$day[i.month])
1542811252676:{
1542811252676:if(nchar(as.character(i.day))==1)
1542811252676:{
1542811252691:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542811252691:} else {
1542811252691:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542811252691:}
1542811252691:if (!file.exists(sound.file)) next
1542811252691:sound.read <- read.table(sound.file)
1542811252691:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542811252709:sound.df$time <-  gsub(",","", sound.df$time)
1542811252711:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542811252715:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542811252718:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542811252718:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542811252718:sound.days <- rbind(sound.days, sound.summary %>% select(week, day.week) %>% distinct())
1542811252718:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542811252734:sound.summary <- NULL
1542811252734:sound.df<- NULL
1542811252734:}
1542811252734:}
1542811284202:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542811284202:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542811284202:sound.days <- data.frame(matrix(ncol = 2, nrow = 0))
1542811284217:for (i.month in 1:nrow(dates.df))
1542811284217:{
1542811284217:for (i.day in 1:dates.df$day[i.month])
1542811284217:{
1542811284233:if(nchar(as.character(i.day))==1)
1542811284233:{
1542811284237:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542811284239:} else {
1542811284244:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542811284246:}
1542811284248:if (!file.exists(sound.file)) next
1542811284251:sound.read <- read.table(sound.file)
1542811284254:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542811284256:sound.df$time <-  gsub(",","", sound.df$time)
1542811284259:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542811284263:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542811284267:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542811284267:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542811284267:sound.days <- rbind.data.frame(sound.days, sound.summary %>% select(week, day.week) %>% distinct())
1542811284267:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542811284283:sound.summary <- NULL
1542811284283:sound.df<- NULL
1542811284283:}
1542811284283:}
1542811292171:sound.all
1542811298020:sound.days
1542811309300:?order
1542811342620:?order_by
1542811368155:sound.days %>% order_by(week, day.week)
1542811387367:sound.days %>% order_by(c('week', 'day.week'))
1542811406214:sound.days
1542811443834:sound.read <- read.table('ambient_sound/2013/February/DCC-NOISE-001011-2013-02-16T00-00-00.txt')
1542811443834:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542811443849:sound.df
1542811443849:sound.df$time <-  gsub(",","", sound.df$time)
1542811443871:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542811443877:sound.df
1542811443891:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542811443910:sound.df
1542811443923:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542811443935:sound.df
1542811443947:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542811443955:sound.summary
1542811473129:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542811473133:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542811473133:sound.days <- data.frame(matrix(ncol = 2, nrow = 0))
1542811473133:for (i.month in 1:nrow(dates.df))
1542811473133:{
1542811473149:for (i.day in 1:dates.df$day[i.month])
1542811473149:{
1542811473149:if(nchar(as.character(i.day))==1)
1542811473149:{
1542811473149:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542811473149:} else {
1542811473164:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542811473164:}
1542811473164:if (!file.exists(sound.file)) next
1542811473175:sound.read <- read.table(sound.file)
1542811473178:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542811473180:sound.df$time <-  gsub(",","", sound.df$time)
1542811473182:sound.df$noise.level <-  as.numeric(gsub(",","", sound.df$noise.level))
1542811473186:sound.df <- sound.df %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.df$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.df$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542811473190:sound.df$hour <- format(strptime(sound.df$time,format='%H:%M:%S'), "%k")
1542811473194:sound.summary <- sound.df %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542811473197:sound.days <- rbind.data.frame(sound.days, sound.summary %>% select(week, day.week, hour) %>% distinct())
1542811473201:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542811473205:sound.summary <- NULL
1542811473207:sound.df<- NULL
1542811473209:}
1542811473211:}
1542811480308:sound.all
1542811480334:sound.days
1542811562127:52*24
1542811587042:sound.days %>% distinct()
1542811636309:sound.all
1542812000606:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542812000606:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542812000606:for (i.month in 1:nrow(dates.df))
1542812000622:{
1542812000622:for (i.day in 1:dates.df$day[i.month])
1542812000622:{
1542812000622:if(nchar(as.character(i.day))==1)
1542812000622:{
1542812000622:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542812000622:} else {
1542812000637:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542812000637:}
1542812000637:if (!file.exists(sound.file)) next
1542812000637:sound.read <- read.table(sound.file)
1542812000637:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542812000637:sound.all <- rbind.data.frame(sound.all, sound.summary)
1542812000653:sound.df<- NULL
1542812000653:}
1542812000653:}
1542812002332:sound.all
1542812002338:sound.days %>% distinct()
1542812014870:sound.all
1542812014881:sound.all %>% distinct()
1542812033638:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542812033638:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542812033638:for (i.month in 1:nrow(dates.df))
1542812033638:{
1542812033653:for (i.day in 1:dates.df$day[i.month])
1542812033653:{
1542812033653:if(nchar(as.character(i.day))==1)
1542812033653:{
1542812033653:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542812033653:} else {
1542812033668:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542812033668:}
1542812033668:if (!file.exists(sound.file)) next
1542812033720:sound.read <- read.table(sound.file)
1542812033723:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542812033726:sound.all <- rbind.data.frame(sound.all, sound.df)
1542812033730:sound.df<- NULL
1542812033732:}
1542812033734:}
1542812037605:sound.all
1542812037641:sound.all %>% distinct()
1542812076673:sound.all
1542812076749:sound.all$time <-  gsub(",","", sound.df$time)
1542812087662:sound.all
1542812087795:sound.all$time <-  gsub(",","", sound.all$time)
1542812087826:sound.all$noise.level <-  as.numeric(gsub(",","", sound.all$noise.level))
1542812098768:sound.all
1542812098967:sound.all$time <-  gsub(",","", sound.all$time)
1542812098993:sound.all$noise.level <-  as.numeric(gsub(",","", sound.all$noise.level))
1542812099124:sound.all
1542812136078:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542812136079:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542812136079:for (i.month in 1:nrow(dates.df))
1542812136079:{
1542812136079:for (i.day in 1:dates.df$day[i.month])
1542812136095:{
1542812136095:if(nchar(as.character(i.day))==1)
1542812136095:{
1542812136095:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542812136095:} else {
1542812136095:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542812136110:}
1542812136110:if (!file.exists(sound.file)) next
1542812136110:sound.read <- read.table(sound.file)
1542812136110:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542812136110:sound.all <- rbind.data.frame(sound.all, sound.df)
1542812136125:sound.df<- NULL
1542812136125:}
1542812136125:}
1542812140084:sound.all
1542812145426:sound.test <- sound.all
1542812145462:sound.test$time <-  gsub(",","", sound.test$time)
1542812145599:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542812145654:sound.test
1542812216664:sound.test <- sound.all
1542812216664:sound.test$time <-  gsub(",","", sound.test$time)
1542812216803:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542812216847:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542812217444:sound.test
1542812267486:sound.test <- sound.all
1542812267487:sound.test$time <-  gsub(",","", sound.test$time)
1542812267629:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542812267675:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542812268288:sound.test.summary <- sound.test %>% group_by(week, day.week, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542812281081:sound.test
1542812309146:sound.test <- sound.all
1542812309146:sound.test$time <-  gsub(",","", sound.test$time)
1542812309285:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542812309348:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542812309958:sound.test
1542812310045:sound.test.summary <- sound.test %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542812310061:sound.test.summary
1542812330740:8193*12
1542812405255:365*24
1542812417625:sound.test.summary2 <- sound.test.summary %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.test.summary$date.sound), "%W"), sep='_'))) %>%  mutate(day.week=format(as.Date(sound.test.summary$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542812516965:sound.test.summary
1542812517139:sound.test.summary %>% mutate(week=gsub('_0', '_', paste('Week', format(as.Date(sound.test.summary$date.sound), "%W"), sep='_')))
1542812541906:format(as.Date(sound.test.summary$date.sound))
1542812557469:sound.test.summary
1542812557643:format(as.Date(sound.test.summary$date.sound))
1542812574047:?as.Date
1542812599129:as.Date(sound.test.summary$date.sound)
1542812607005:sound.test.summary
1542812607179:as.Date(sound.test.summary$date.sound, format)
1542812648654:sound.test.summary
1542812648781:as.Date(sound.test.summary$date.sound, format="%d/%m/%Y")
1542812684958:format(as.Date(sound.test.summary$date.sound, format="%d/%m/%Y"), '%W')
1542812693005:as.Date(sound.test.summary$date.sound, format="%d/%m/%Y")
1542812693796:format(as.Date(sound.test.summary$date.sound, format="%d/%m/%Y"), '%W')
1542812717940:format(as.Date(sound.test.summary$date.sound, format="%d/%m/%Y"), '%w')
1542812734191:?format
1542812786005:?strftime
1542812844862:strftime(as.Date(sound.test.summary$date.sound, format="%d/%m/%Y"), '%V')
1542812869175:sound.test.summary %>% mutate(week=gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound), "%W"), sep='_')))
1542812897354:gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound), "%V"), sep='_'))
1542812905144:sound.test.summary %>% mutate(week=gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound), "%V"), sep='_')))
1542812935267:sound.test <- sound.all
1542812935270:sound.test$time <-  gsub(",","", sound.test$time)
1542812935406:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542812935454:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542812936100:sound.test.summary <- sound.test %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542812936173:sound.test.summary %>% ungroup()
1542812936217:sound.test.summary %>% mutate(week=gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound), "%V"), sep='_')))
1542812944610:sound.test.summary %>% ungroup()
1542812947149:sound.test.summary %>% mutate(week=gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound), "%V"), sep='_')))
1542812956643:sound.test.summary
1542812979987:gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound)
1542812985303:gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound))
1542812994291:gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound))))
1542813054205:sound.test.summary$date.sound
1542813054960:as.Date(sound.test.summary$date.sound)
1542813055879:strftime(as.Date(sound.test.summary$date.sound))
1542813056798:paste('Week', strftime(as.Date(sound.test.summary$date.sound)))
1542813123616:sound.test.summary$date.sound
1542813124452:as.Date(sound.test.summary$date.sound)
1542813125278:strftime(as.Date(sound.test.summary$date.sound), "%V")
1542813126116:paste('Week', strftime(as.Date(sound.test.summary$date.sound), "%V"), sep='_')
1542813198926:sound.test.summary %>% mutate(week=gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound, format='%d/%m/%Y'), "%V"), sep='_')))
1542813203080:sound.test.summary$date.sound
1542813204029:as.Date(sound.test.summary$date.sound, format='%d/%m/%Y')
1542813204792:strftime(as.Date(sound.test.summary$date.sound, format='%d/%m/%Y'), "%V")
1542813205571:paste('Week', strftime(as.Date(sound.test.summary$date.sound, format='%d/%m/%Y'), "%V"), sep='_')
1542813247545:gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound, format='%d/%m/%Y'), "%V"), sep='_'))
1542813332443:sound.test.summary$Week <- gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound, format='%d/%m/%Y'), "%V"), sep='_')))
1542813335769:sound.test.summary$Week <- gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound, format='%d/%m/%Y'), "%V"), sep='_'))
1542813343017:sound.test.summary
1542813363679:sound.test <- sound.all
1542813363682:sound.test$time <-  gsub(",","", sound.test$time)
1542813363821:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813363867:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542813364495:sound.test.summary <- sound.test %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542813364563:sound.test.summary$Week <- gsub('_0', '_', paste('Week', strftime(as.Date(sound.test.summary$date.sound, format='%d/%m/%Y'), "%V"), sep='_'))
1542813364592:sound.test.summary
1542813480517:sound.test <- sound.all
1542813480520:sound.test$time <-  gsub(",","", sound.test$time)
1542813480684:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813480736:sound.test$date.sound <-  as.Date(sound.test.summary$date.sound, format='%d/%m/%Y')
1542813504143:sound.test <- sound.all
1542813504146:sound.test$time <-  gsub(",","", sound.test$time)
1542813504282:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813504331:sound.test
1542813514043:sound.test$date.sound <-  as.Date(sound.test.summary$date.sound, format='%d/%m/%Y')
1542813539270:sound.test <- sound.all
1542813539273:sound.test$time <-  gsub(",","", sound.test$time)
1542813539410:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813539458:sound.test$date.sound <-  as.Date(sound.test$date.sound, format='%d/%m/%Y')
1542813549642:sound.test <- sound.all
1542813549645:sound.test$time <-  gsub(",","", sound.test$time)
1542813549682:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813549729:sound.test$date.sound <-  as.Date(sound.test$date.sound, format='%d/%m/%Y')
1542813549890:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542813550461:sound.test.summary <- sound.test %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542813550484:sound.test.summary$Week <- gsub('_0', '_', paste('Week', strftime(date.sound, "%V"), sep='_'))
1542813567612:sound.test.summary
1542813587829:sound.test <- sound.all
1542813587957:sound.test$time <-  gsub(",","", sound.test$time)
1542813587990:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813588036:sound.test$date.sound <-  as.Date(sound.test$date.sound, format='%d/%m/%Y')
1542813588070:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542813588657:sound.test.summary <- sound.test %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542813588680:sound.test.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.test.summary$date.sound, "%V"), sep='_'))
1542813600307:sound.test.summary$day.week <-
1542813600309:#%>%  mutate(day.week=format(as.Date(sound.test.summary$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542813600312:sound.test.summary
1542813604362:sound.test.summary$day.week <-
1542813604365:#%>%  mutate(day.week=format(as.Date(sound.test.summary$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542813604367:sound.test.summary
1542813612055:sound.test <- sound.all
1542813612058:sound.test$time <-  gsub(",","", sound.test$time)
1542813612094:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813612141:sound.test$date.sound <-  as.Date(sound.test$date.sound, format='%d/%m/%Y')
1542813612192:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542813612814:sound.test.summary <- sound.test %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542813612846:sound.test.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.test.summary$date.sound, "%V"), sep='_'))
1542813612876:#sound.test.summary$day.week <-
1542813613033:#%>%  mutate(day.week=format(as.Date(sound.test.summary$date.sound), "%A")) %>% select(week, day.week, time, noise.level)
1542813613038:sound.test.summary
1542813638307:sound.test <- sound.all
1542813638310:sound.test$time <-  gsub(",","", sound.test$time)
1542813638346:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813638394:sound.test$date.sound <-  as.Date(sound.test$date.sound, format='%d/%m/%Y')
1542813638433:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542813639075:sound.test.summary <- sound.test %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542813639157:sound.test.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.test.summary$date.sound, "%V"), sep='_'))
1542813639187:sound.test.summary$day.week <- format(as.Date(sound.test.summary$date.sound), "%A")) #%>% select(week, day.week, time, noise.level)
1542813654674:sound.test <- sound.all
1542813654677:sound.test$time <-  gsub(",","", sound.test$time)
1542813654814:sound.test$noise.level <-  as.numeric(gsub(",","", sound.test$noise.level))
1542813654865:sound.test$date.sound <-  as.Date(sound.test$date.sound, format='%d/%m/%Y')
1542813654904:sound.test$hour <- format(strptime(sound.test$time,format='%H:%M:%S'), "%k")
1542813655601:sound.test.summary <- sound.test %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542813655675:sound.test.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.test.summary$date.sound, "%V"), sep='_'))
1542813655756:sound.test.summary$day.week <- format(as.Date(sound.test.summary$date.sound), "%A") #%>% select(week, day.week, time, noise.level)
1542813655836:sound.test.summary
1542813727674:sound.test.all <- select(sound.test.summary, week, day.week, hour, mean.noise.level)
1542813752117:sound.test.all
1542813756367:sound.test.all <- select(sound.test.summary, Week, day.week, hour, mean.noise.level)
1542813756528:sound.test.all
1542813772579:sound.test.summary
1542813793369:sound.test.all <- ddplyr:select(sound.test.summary, Week, day.week, hour, mean.noise.level)
1542813798426:sound.test.all <- dplyr:select(sound.test.summary, Week, day.week, hour, mean.noise.level)
1542813838831:sound.test.all <- dply::rselect(sound.test.summary, Week, day.week, hour, mean.noise.level)
1542813846142:sound.test.all <- dplyr::rselect(sound.test.summary, Week, day.week, hour, mean.noise.level)
1542813856894:sound.test.all <- dplyr::select(sound.test.summary, Week, day.week, hour, mean.noise.level)
1542813856949:sound.test.all
1542813883017:sound.test.all <- sound.test.summary[2:5]
1542813883025:#sound.test.all <- dplyr::select(sound.test.summary, Week, day.week, hour, mean.noise.level)
1542813883027:sound.test.all
1542813906205:sound.test.all <- sound.test.summary[2:5] %>% select(sound.test.summary, Week, day.week, hour, mean.noise.level)
1542813962615:sound.tidy <- sound.all
1542813962619:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542813962655:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542813962806:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542813962846:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542813963466:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542813963539:sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_'))
1542813963570:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542813963650:sound.tidy.all <- sound.tidy.summary[2:5]
1542813963661:sound.tidy.all
1542814002113:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542814002250:sound.split
1542814021801:sound.mon <- sound.split$Monday[2:4] %>% select(., week, hour, mon.noise=mean.noise.level)
1542814031765:sound.split
1542814077705:sound.mon <- sound.split$Monday[2:4] %>% select(., Week, hour, mon.noise=mean.noise.level)
1542814097205:sound.split
1542814124768:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542814124776:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542814124783:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542814124790:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542814124898:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542814124906:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542814124912:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542814131329:sound.mon
1542814163618:sound.new <- sound.mon %>% inner_join(sound.tue, by=c('Week', 'hour'))
1542814163627:#%>% left_join(sound.wed, by=c('Week', 'hour')) %>% left_join(sound.thurs, by=c('Week', 'hour')) %>% left_join(sound.fri, by=c('Week', 'hour')) %>% left_join(sound.sat, by=c('Week', 'hour')) %>% left_join(sound.sun, by=c('Week', 'hour'))
1542814163630:sound.new
1542814179617:sound.new <- sound.mon %>% inner_join(sound.tue, by=c('Week', 'hour')) %>% left_join(sound.wed, by=c('Week', 'hour')) %>% left_join(sound.thurs, by=c('Week', 'hour')) %>% left_join(sound.fri, by=c('Week', 'hour')) %>% left_join(sound.sat, by=c('Week', 'hour')) %>% left_join(sound.sun, by=c('Week', 'hour'))
1542814179630:sound.new
1542814835284:camera1.all
1542814835357:camera2.all
1542814835487:sound.new
1542814941721:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542814941737:options(digits=2)
1542814941799:library(devtools)
1542814942905:library(readr)
1542814943149:library(ggplot2)
1542814943387:library(ggmap)
1542814943439:devtools::install_github('hadley/ggplot2')
1542814944362:devtools::install_github('dkahle/ggmap')
1542814945007:library(rnoaa)
1542814945510:library(httr)
1542814945519:library(plyr)
1542814945528:library(jsonlite)
1542814945537:library(dplyr)
1542814945602:library(readODS)
1542814945623:library(knitr)
1542814945632:library(hms)
1542814945641:library(lubridate)
1542814945660:employ.read <- read_delim('dublin employment trends.txt', ':')
1542814945710:qplot(data = employ.read , x = Time , y = Employment, geom = 'line', xlab = 'Quarterly Figures', ylab = 'Trend', main = 'Dublin Employment Trends Per Sector: 2006 - 2016') + facet_grid ( .~ Sector)
1542814946282:min.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == min(Employment))
1542814946427:max.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == max(Employment))
1542814946448:employ.extreme <- left_join(min.employ, max.employ, by = 'Sector', suffix = c('.min', '.max'))[c('Sector', 'QuarterYear.min', 'Employment.min', 'Time.min', 'QuarterYear.max', 'Employment.max', 'Time.max')]
1542814946466:employ.extreme <- employ.extreme %>% mutate(Employment.diff = Employment.max-Employment.min)
1542814946479:kable(employ.extreme, digits = 2)
1542814946889:prop.read <- read_tsv('dublin property trends.txt')
1542814946908:qplot(data = prop.read , x = Time , y = Trend, geom = 'line', colour = Category, xlab = 'Time', ylab = 'Trend', main = 'Dublin Property Trends: 2007 - 2016')
1542814947354:prop.split <- split(prop.read, prop.read$Category)
1542814947371:prop.apt.rent <- select(prop.split[[1]], Time, Year, Trend, Category)
1542814947380:prop.house.price <- select(prop.split[[2]], Time, Year, Trend, Category)
1542814947387:prop.house.rent <- select(prop.split[[3]], Time, Year, Trend, Category)
1542814947394:prop.house.built <- select(prop.split[[4]], Time, Year, Trend, Category)
1542814947402:prop.cols <- prop.apt.rent %>% left_join(prop.house.price, by = c('Time', 'Year'), suffix = c('.apt.rent', '.house.price')) %>% left_join( prop.house.built, by = c('Time', 'Year'), suffix = c('.', '.house.built')) %>% left_join(., prop.house.rent, by = c('Time', 'Year'), suffix = c('.', '.house.rent'))
1542814947413:prop.filter.buy <- filter(prop.cols, (Trend.house.price > Trend.house.rent & Trend.house.price > Trend.apt.rent & Trend. > Trend.house.rent & Trend. > Trend.apt.rent))
1542814947423:prop.filter.rent <- filter(prop.cols, (Trend.house.price < Trend.house.rent & Trend.house.price < Trend.apt.rent & Trend. < Trend.house.rent & Trend. < Trend.apt.rent))
1542814947437:min.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == min(Trend))
1542814947566:max.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == max(Trend))
1542814947584:prop.extreme <- left_join(min.prop, max.prop, by = 'Category', suffix = c('.min', '.max'))[c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max', 'Trend.max', 'Time.max')]
1542814947596:prop.extreme <- prop.extreme %>% mutate(Trend.diff = Trend.max-Trend.min)
1542814947623:employ.extreme.con <- employ.extreme %>% filter(., Sector == 'Construction') %>% setNames(c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max',  'Trend.max', 'Time.max', 'Trend.diff'))
1542814947634:kable(bind_rows(prop.extreme, employ.extreme.con), digits = 2)
1542814947756:stations <- GET('https://api.jcdecaux.com/vls/v1/stations?apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542814948183:http_type(stations)
1542814948188:stations.df <- jsonlite::fromJSON(content(stations, 'text'), simplifyVector = TRUE)
1542814948296:#count(stations.df, vars = 'contract_name')
1542814948512:bike <- GET('https://api.jcdecaux.com/vls/v1/stations?contract=Dublin&apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542814948942:http_type(bike)
1542814948947:bike.df <- jsonlite::fromJSON(content(bike, 'text'), simplifyVector = TRUE)
1542814948972:sum.bike <- summary(bike.df)
1542814948992:#filter(bike.df, banking==FALSE)
1542814948994:#bike.df[bike.df$banking==F]
1542814948997:#bike.df[bike.df$address=='Smithfield North']
1542814949000:#bike.df$address=='Smithfield North'
1542814949002:#bike.df$banking
1542814949010:bike.df <- bike.df[order(bike.df$number),]
1542814949026:#bike.df
1542814949085:str(bike.df)
1542814949310:qplot(available_bikes, name, data = bike.df , colour = banking, size=I(3))
1542814949683:unzip('DublinBus.zip')
1542814950371:trips.df <- read_csv('googletransitdublinbusp20130315-1546\\trips.txt')
1542814950394:routes.df <- read_csv('googletransitdublinbusp20130315-1546\\routes.txt')
1542814950468:calendar.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar.txt')
1542814950545:calendar_dates.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar_dates.txt')
1542814950658:shapes.df <- read_csv('googletransitdublinbusp20130315-1546\\shapes.txt')
1542814950767:stops.df <- read_csv('googletransitdublinbusp20130315-1546\\stops.txt')
1542814950790:transfers.df <- read_csv('googletransitdublinbusp20130315-1546\\transfers.txt')
1542814950852:agency.df <- read_csv('googletransitdublinbusp20130315-1546\\agency.txt')
1542814950938:stop_times.df <- read_csv('googletransitdublinbusp20130315-1546\\stop_times.txt')
1542814956037:route.num.trip <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542814956160:ggplot(data=route.num.trip, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542814956659:#common join used at multiple points in the code
1542814956662:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542814957701:#calculating the unit of distance in the dataset
1542814957703:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542814957859:#calculating the route lengths
1542814957862:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542814958074:# base df that most and least frequent routes and mean length is based on
1542814958077:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, Service, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, Service, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, Service, Freq) %>% group_by(Service)
1542814958224:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542814958232:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542814958240:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542814958249:extreme.freq <- rbind(most.freq, leastfreq) %>% select(Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., Service, Freq)
1542814958314:kable(extreme.freq)
1542814958435:##trying to figure out first and last bus - getting bogged down
1542814958438:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 #~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% #mutate(actual.time=case_when(arrival_time < as.hms('04:00:00') ~ arrival_time+as.hms('24:00:00')))  %>% #filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% arrange(arrival_time)
1542814958440:#library(hms)
1542814958493:#typeof(as.hms('04:00:00'))
1542814958499:#%>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542814958502:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41) %>% select(Service, route_short_name, service_id, arrival_time, departure_time)  %>% distinct() %>% arrange(arrival_time)
1542814958510:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542814958520:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542814958533:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542814958545:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest)
1542814958555:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542814958660:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542814958663:bottom = (min(stops.df$stop_lat) - 0.01),
1542814958665:right = (max(stops.df$stop_lon) + 0.01),
1542814958667:top = (max(stops.df$stop_lat) + 0.01))
1542814958672:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542814960952:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542814961581:home.route <- 49
1542814961584:bus.home <- bus.join %>% filter(route_short_name==home.route, Service=='Weekday')
1542814961768:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542814961803:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542814961929:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542814961936:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(lead(arrival_time) - arrival_time)/60) %>% mutate(length.dist=(lead(shape_dist_traveled) - shape_dist_traveled)/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542814961953:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542814962079:kable(bus.join %>% group_by(Service, stop_headsign) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(earliest.bus=min(arrival_time), latest.bus= max(arrival_time)))
1542814962283:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542814962352:stops.home <- bus.join.sat %>% filter(route_short_name==home.route)
1542814962390:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by = c("route_short_name.intersect" = "route_short_name")) %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542814962830:intersect.routes <- rbind((stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))), (stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route)))) %>% select(Route, Longitude, Latitude)
1542814962850:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542814962852:dublin_intersect_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542814962854:bottom = (min(stops.intersect$Latitude) - 0.01),
1542814962856:right = (max(stops.intersect$Longitude) + 0.01),
1542814962858:top = (max(stops.intersect$Latitude) + 0.01))
1542814962943:dublin_intersect_stamen <- get_stamenmap(bbox = dublin_intersect_bb, zoom = 11,  maptype = 'toner-lite')
1542814963616:ggmap(dublin_intersect_stamen, legend = 'right') + geom_point(data = intersect.routes, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542814964312:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542814964316:download.file(url.footfall, 'footfall_ods.ods')
1542814965067:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542814965816:#getting list of camera locations
1542814965818:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542814970470:colnames(camera.locations) <- c('Loc')
1542814970475:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE))
1542814970486:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542814970490:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542814970494:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542814970503:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542814970514:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542814970525:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542814970584:for(week.i in 1:length(sheet.names))
1542814970587:{
1542814970589:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542814970595:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542814970599:camera1.row <- which(grepl(camera1.name, f1$Time))
1542814970602:camera2.row <- which(grepl(camera2.name, f1$Time))
1542814970606:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542814970609:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542814970614:camera1.all <- rbind(camera1.all, camera1.slice)
1542814970616:camera2.all <- rbind(camera2.all, camera2.slice)
1542814970622:f1 <- NULL
1542814970625:}
1542815365559:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542815365559:options(digits=2)
1542815370400:library(devtools)
1542815371048:library(readr)
1542815371114:library(ggplot2)
1542815371347:library(ggmap)
1542815371394:devtools::install_github('hadley/ggplot2')
1542815372471:devtools::install_github('dkahle/ggmap')
1542815372913:library(rnoaa)
1542815373409:library(httr)
1542815373419:library(plyr)
1542815373428:library(jsonlite)
1542815373436:library(dplyr)
1542815373483:library(readODS)
1542815373532:library(knitr)
1542815373547:library(hms)
1542815373563:library(lubridate)
1542815377810:employ.read <- read_delim('dublin employment trends.txt', ':')
1542815377908:qplot(data = employ.read , x = Time , y = Employment, geom = 'line', xlab = 'Quarterly Figures', ylab = 'Trend', main = 'Dublin Employment Trends Per Sector: 2006 - 2016') + facet_grid ( .~ Sector)
1542815383065:min.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == min(Employment))
1542815383163:max.employ <- employ.read %>% group_by(Sector) %>% filter(., Employment == max(Employment))
1542815383174:employ.extreme <- left_join(min.employ, max.employ, by = 'Sector', suffix = c('.min', '.max'))[c('Sector', 'QuarterYear.min', 'Employment.min', 'Time.min', 'QuarterYear.max', 'Employment.max', 'Time.max')]
1542815383190:employ.extreme <- employ.extreme %>% mutate(Employment.diff = Employment.max-Employment.min)
1542815383206:kable(employ.extreme, digits = 2)
1542815386820:prop.read <- read_tsv('dublin property trends.txt')
1542815386887:qplot(data = prop.read , x = Time , y = Trend, geom = 'line', colour = Category, xlab = 'Time', ylab = 'Trend', main = 'Dublin Property Trends: 2007 - 2016')
1542815389461:prop.split <- split(prop.read, prop.read$Category)
1542815389580:prop.apt.rent <- select(prop.split[[1]], Time, Year, Trend, Category)
1542815389640:prop.house.price <- select(prop.split[[2]], Time, Year, Trend, Category)
1542815389647:prop.house.rent <- select(prop.split[[3]], Time, Year, Trend, Category)
1542815389654:prop.house.built <- select(prop.split[[4]], Time, Year, Trend, Category)
1542815389662:prop.cols <- prop.apt.rent %>% left_join(prop.house.price, by = c('Time', 'Year'), suffix = c('.apt.rent', '.house.price')) %>% left_join( prop.house.built, by = c('Time', 'Year'), suffix = c('.', '.house.built')) %>% left_join(., prop.house.rent, by = c('Time', 'Year'), suffix = c('.', '.house.rent'))
1542815389677:prop.filter.buy <- filter(prop.cols, (Trend.house.price > Trend.house.rent & Trend.house.price > Trend.apt.rent & Trend. > Trend.house.rent & Trend. > Trend.apt.rent))
1542815389687:prop.filter.rent <- filter(prop.cols, (Trend.house.price < Trend.house.rent & Trend.house.price < Trend.apt.rent & Trend. < Trend.house.rent & Trend. < Trend.apt.rent))
1542815393221:min.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == min(Trend))
1542815393350:max.prop <- prop.read %>% group_by(Category) %>% filter(., Trend == max(Trend))
1542815393432:prop.extreme <- left_join(min.prop, max.prop, by = 'Category', suffix = c('.min', '.max'))[c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max', 'Trend.max', 'Time.max')]
1542815393432:prop.extreme <- prop.extreme %>% mutate(Trend.diff = Trend.max-Trend.min)
1542815393447:employ.extreme.con <- employ.extreme %>% filter(., Sector == 'Construction') %>% setNames(c('Category', 'Year.min', 'Trend.min', 'Time.min', 'Year.max',  'Trend.max', 'Time.max', 'Trend.diff'))
1542815393527:kable(bind_rows(prop.extreme, employ.extreme.con), digits = 2)
1542815396942:stations <- GET('https://api.jcdecaux.com/vls/v1/stations?apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542815397341:http_type(stations)
1542815397341:stations.df <- jsonlite::fromJSON(content(stations, 'text'), simplifyVector = TRUE)
1542815397486:#count(stations.df, vars = 'contract_name')
1542815404369:bike <- GET('https://api.jcdecaux.com/vls/v1/stations?contract=Dublin&apiKey=174980a157364085f718726daecb380b7aeaf5b4')
1542815404573:http_type(bike)
1542815404579:bike.df <- jsonlite::fromJSON(content(bike, 'text'), simplifyVector = TRUE)
1542815408886:sum.bike <- summary(bike.df)
1542815416976:bike.df <- bike.df[order(bike.df$number),]
1542815417043:#bike.df
1542815419821:str(bike.df)
1542815424175:qplot(available_bikes, name, data = bike.df , colour = banking, size=I(3))
1542815429160:unzip('DublinBus.zip')
1542815429803:trips.df <- read_csv('googletransitdublinbusp20130315-1546\\trips.txt')
1542815429870:routes.df <- read_csv('googletransitdublinbusp20130315-1546\\routes.txt')
1542815429901:calendar.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar.txt')
1542815429916:calendar_dates.df <- read_csv('googletransitdublinbusp20130315-1546\\calendar_dates.txt')
1542815429932:shapes.df <- read_csv('googletransitdublinbusp20130315-1546\\shapes.txt')
1542815430042:stops.df <- read_csv('googletransitdublinbusp20130315-1546\\stops.txt')
1542815430058:transfers.df <- read_csv('googletransitdublinbusp20130315-1546\\transfers.txt')
1542815430074:agency.df <- read_csv('googletransitdublinbusp20130315-1546\\agency.txt')
1542815430089:stop_times.df <- read_csv('googletransitdublinbusp20130315-1546\\stop_times.txt')
1542815440472:route.num.trip <- left_join(trips.df, routes.df, by = 'route_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday')) %>% select(Service, route_short_name, trip_id) %>% count(., Service, route_short_name)
1542815440602:ggplot(data=route.num.trip, aes(x=reorder(route_short_name, -n), y=n)) + facet_grid(rows=vars(Service), scale = 'fixed') + geom_histogram(stat = 'identity', fill='darkorchid3', colour='black') + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = 'Routes', y = 'Number of Trips', title='Figure X: Number of journeys on each route by service type')
1542815446318:#common join used at multiple points in the code
1542815446318:bus.join <- left_join(routes.df, trips.df, by='route_id') %>% left_join(., stop_times.df, by='trip_id') %>% left_join(., stops.df, by='stop_id') %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))
1542815447094:#calculating the unit of distance in the dataset
1542815447094:dist.calc <- bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'Redmond\'s Hill') %>% select(shape_dist_traveled) - bus.join %>% filter(route_short_name == 16) %>% filter(trip_id == min(trip_id)) %>% filter(stop_name == 'George\'s St') %>% select(shape_dist_traveled)
1542815447141:#calculating the route lengths
1542815447141:route.length <- bus.join %>% group_by(route_short_name, route_long_name, trip_id) %>% summarise(Dist.all = max(shape_dist_traveled)) %>% ungroup() %>% group_by(route_short_name, route_long_name) %>% summarise(Dist.mean = mean(Dist.all)/1000) %>% ungroup()
1542815447423:# base df that most and least frequent routes and mean length is based on
1542815447423:bus.freq <- bus.join %>% group_by(route_short_name, service_id,direction_id) %>% filter(., stop_sequence==1) %>% select(., route_short_name, route_long_name, Service, direction_id, arrival_time, stop_sequence) %>% arrange(., route_short_name, Service, direction_id, arrival_time) %>% mutate(., Freq = difftime(arrival_time,lag(arrival_time),units='mins')) %>% na.omit() %>% filter(Freq>0)  %>% ungroup() %>% select(route_short_name, route_long_name, Service, Freq) %>% group_by(Service)
1542815447643:freq.mean <- bus.freq %>% summarise(Freq=mean(Freq))
1542815447659:most.freq <- bus.freq %>% filter(Freq==min(Freq)) %>% distinct() %>% mutate(Classification='Most Fequent') %>% ungroup()
1542815447659:leastfreq <- bus.freq %>% filter(Freq==max(Freq)) %>% distinct() %>% mutate(Classification='Least Fequent') %>% ungroup()
1542815447675:extreme.freq <- rbind(most.freq, leastfreq) %>% select(Service, Classification, Freq, Route=route_short_name, Route.name=route_long_name) %>% arrange(., Service, Freq)
1542815451844:kable(extreme.freq)
1542815455066:##trying to figure out first and last bus - getting bogged down
1542815455066:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 #~ 'Saturday')) %>% select(Service, route_short_name, route_long_name, arrival_time) %>% #mutate(actual.time=case_when(arrival_time < as.hms('04:00:00') ~ arrival_time+as.hms('24:00:00')))  %>% #filter(route_short_name == 41, Service=='Sunday/Bank Holiday') %>% arrange(arrival_time)
1542815455066:#library(hms)
1542815455081:#typeof(as.hms('04:00:00'))
1542815455185:#%>% group_by(Service) %>% filter(arrival_time==min(arrival_time, na.rm=TRUE) | arrival_time==max(arrival_time, na.rm=TRUE)) %>% select(Service, route_short_name, route_long_name, arrival_time)
1542815455188:#bus.join %>% mutate(Service=case_when(service_id == 2 ~ 'Sunday/Bank Holiday', service_id == 1 ~ 'Weekday',  service_id == 3 ~ 'Saturday'))  %>% filter(route_short_name == 41) %>% select(Service, route_short_name, service_id, arrival_time, departure_time)  %>% distinct() %>% arrange(arrival_time)
1542815458517:lat.long.all <- select(stops.df, Latitude=stop_lat, Longitude=stop_lon) %>% mutate(., Route='All Routes') %>% select(Route, Longitude, Latitude) %>% distinct()
1542815458517:lat.long.longest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==max(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542815458597:lat.long.shortest <- filter(bus.join, route_short_name==filter(route.length, Dist.mean==min(Dist.mean))$route_short_name) %>% select(., Route=route_short_name, Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542815458610:lat.long.combo <- rbind(lat.long.all, lat.long.longest, lat.long.shortest)
1542815458620:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542815458623:dublin_bb <- c(left = (min(stops.df$stop_lon) - 0.01),
1542815458625:bottom = (min(stops.df$stop_lat) - 0.01),
1542815458627:right = (max(stops.df$stop_lon) + 0.01),
1542815458629:top = (max(stops.df$stop_lat) + 0.01))
1542815458634:dublin_stamen <- get_stamenmap(bbox = dublin_bb, zoom = 11,  maptype = 'toner-lite')
1542815460749:ggmap(dublin_stamen, legend = 'right') + geom_point(data = lat.long.combo, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542815465819:home.route <- 49
1542815465819:bus.home <- bus.join %>% filter(route_short_name==home.route, Service=='Weekday')
1542815469689:home.stops <- bus.home %>%  filter(stop_id=='8220DB001296' | stop_id == '8220DB004521' | stop_id=='8220DB001339' | stop_id=='8220DB005192')
1542815469778:kable(home.stops %>% select(route_short_name, route_long_name, direction_id, stop_headsign, stop_id, stop_name) %>% distinct() )
1542815473052:commute.trips <- home.stops %>% filter((direction_id==1 & stop_id=='8220DB005192' & arrival_time>as.hms('08:15:00') & arrival_time<as.hms('09:00:00')) | (direction_id==0 & stop_id=='8220DB004521' & arrival_time>as.hms('17:00:00') & arrival_time<as.hms('17:45:00'))) %>% select(trip_id)
1542815473052:length.route <- home.stops %>% inner_join(commute.trips, by='trip_id') %>% arrange(trip_id, stop_sequence) %>% group_by(direction_id, trip_id) %>% mutate(length.time=(lead(arrival_time) - arrival_time)/60) %>% mutate(length.dist=(lead(shape_dist_traveled) - shape_dist_traveled)/1000) %>% ungroup() %>% select(direction_id, stop_headsign, length.time, length.dist) %>% filter(!is.na(length.dist)) %>% distinct()
1542815475996:kable(inner_join(home.stops, commute.trips, by='trip_id') %>% mutate(Journey=case_when(stop_headsign=='Pearse St' ~ 'Commute to work', stop_headsign=='The Square' ~ 'Commute to home') ) %>% select(Service, Journey, Direction=stop_headsign, stop_name, arrival_time))
1542815479545:kable(bus.join %>% group_by(Service, stop_headsign) %>% filter(!is.na(arrival_time), route_short_name==home.route) %>% summarise(earliest.bus=min(arrival_time), latest.bus= max(arrival_time)))
1542815483158:bus.join.sat <- filter(bus.join, Service=='Saturday')
1542815483271:stops.home <- bus.join.sat %>% filter(route_short_name==home.route)
1542815483308:stops.intersect <- inner_join(stops.home, bus.join.sat, by='stop_id', suffix=c('.home', '.intersect')) %>% select(route_short_name.intersect) %>% distinct() %>% inner_join(bus.join.sat, by = c("route_short_name.intersect" = "route_short_name")) %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% distinct()
1542815483411:intersect.routes <- rbind((stops.intersect %>% mutate(Route=paste('All Routes Intersecting with Route', home.route))), (stops.home %>% select(Longitude=stop_lon, Latitude=stop_lat) %>% mutate(Route=paste('Route', home.route)))) %>% select(Route, Longitude, Latitude)
1542815486410:# store bounding box coordinates - add a small amount so box extends slightly beyond the furthermost stop
1542815486410:dublin_intersect_bb <- c(left = (min(stops.intersect$Longitude) - 0.01),
1542815486410:bottom = (min(stops.intersect$Latitude) - 0.01),
1542815486410:right = (max(stops.intersect$Longitude) + 0.01),
1542815486410:top = (max(stops.intersect$Latitude) + 0.01))
1542815486524:dublin_intersect_stamen <- get_stamenmap(bbox = dublin_intersect_bb, zoom = 11,  maptype = 'toner-lite')
1542815487244:ggmap(dublin_intersect_stamen, legend = 'right') + geom_point(data = intersect.routes, mapping = aes(x = Longitude, y = Latitude, na.rm=TRUE, colour = Route), size = 0.6, alpha = .5) +ggtitle('Figure X: Map of Dublin Bus Routes') + labs(x='Longitude', y='Latitude')
1542815491947:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542815491947:download.file(url.footfall, 'footfall_ods.ods')
1542815492690:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542815496070:#getting list of camera locations
1542815496070:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542815500240:colnames(camera.locations) <- c('Loc')
1542815500256:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE))
1542815503290:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542815503290:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542815503290:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542815503357:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542815503366:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542815503375:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542815503384:for(week.i in 1:length(sheet.names))
1542815503386:{
1542815503392:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542815503396:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542815503400:camera1.row <- which(grepl(camera1.name, f1$Time))
1542815503402:camera2.row <- which(grepl(camera2.name, f1$Time))
1542815503405:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542815503407:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542815503411:camera1.all <- rbind(camera1.all, camera1.slice)
1542815503413:camera2.all <- rbind(camera2.all, camera2.slice)
1542815503417:f1 <- NULL
1542815503419:}
1542815802454:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542815806750:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542815810920:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542815810936:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542815810951:camera1.row <- which(grepl(camera1.name, f1$Time))
1542815814396:camera2.row <- which(grepl(camera2.name, f1$Time))
1542815823109:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[1])
1542815825443:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[1])
1542815827543:camera1.all <- rbind(camera1.all, camera1.slice)
1542815830227:camera2.all <- rbind(camera2.all, camera2.slice)
1542815835051:camera1.all
1542815841868:camera2.all
1542815898922:camera1.row <- which(grepl(camera1.name, f1$Time))
1542815898922:camera1.row
1542815898922:camera2.row <- which(grepl(camera2.name, f1$Time))
1542815898937:camera2.row
1542816148422:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542816148575:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542816153337:camera2.all
1542816168627:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[42])
1542816168741:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[42])
1542816176971:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[43])
1542816176984:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[43])
1542816185180:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[44])
1542816185231:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[44])
1542816192259:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[44])
1542816192274:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[44])
1542816192274:camera1.all <- rbind(camera1.all, camera1.slice)
1542816192368:camera2.all <- rbind(camera2.all, camera2.slice)
1542816203770:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[45])
1542816203861:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[45])
1542816203876:camera1.all <- rbind(camera1.all, camera1.slice)
1542816203892:camera2.all <- rbind(camera2.all, camera2.slice)
1542816212093:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[46])
1542816212121:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[46])
1542816212187:camera1.all <- rbind(camera1.all, camera1.slice)
1542816212203:camera2.all <- rbind(camera2.all, camera2.slice)
1542816220685:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[47])
1542816220758:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[47])
1542816220774:camera1.all <- rbind(camera1.all, camera1.slice)
1542816220789:camera2.all <- rbind(camera2.all, camera2.slice)
1542816243528:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542816243528:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542816243528:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542816243543:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542816243654:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542816243662:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542816243671:for(week.i in 1:length(sheet.names))
1542816243673:{
1542816243674:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542816243677:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542816243680:camera1.row <- which(grepl(camera1.name, f1$Time))
1542816243682:camera2.row <- which(grepl(camera2.name, f1$Time))
1542816243684:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542816243686:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542816243688:camera1.all <- rbind(camera1.all, camera1.slice)
1542816243690:camera2.all <- rbind(camera2.all, camera2.slice)
1542816243693:print(week.i)
1542816243696:f1 <- NULL
1542816243697:}
1542816501094:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[45])
1542816505082:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542816505092:camera1.row <- which(grepl(camera1.name, f1$Time))
1542816505092:camera2.row <- which(grepl(camera2.name, f1$Time))
1542816505092:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[45])
1542816505172:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[45])
1542816505187:camera1.all <- rbind(camera1.all, camera1.slice)
1542816505203:camera2.all <- rbind(camera2.all, camera2.slice)
1542816505203:print(week.i)
1542816631298:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542816631298:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542816631298:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542816631427:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542816631436:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542816631444:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542816631453:for(week.i in 1:length(sheet.names))
1542816631455:{
1542816631456:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542816631459:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542816631461:camera1.row <- which(grepl(camera1.name, f1$Time))
1542816631463:print(camera1.row)
1542816631464:camera2.row <- which(grepl(camera2.name, f1$Time))
1542816631466:print(camera2.row)
1542816631468:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542816631470:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542816631472:camera1.all <- rbind(camera1.all, camera1.slice)
1542816631474:camera2.all <- rbind(camera2.all, camera2.slice)
1542816631477:print(week.i)
1542816631480:f1 <- NULL
1542816631481:}
1542816858853:camera1.slice
1542816912892:camera1.row
1542816912892:camera2.row
1542816926904:camera1.slice
1542816926904:camera2.slice
1542816982381:f1
1542817085842:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[45])
1542817091286:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[45])
1542817095179:f1
1542817113721:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542817119407:f1
1542817155013:read_ods('pedestrianfootfall2013.ods',sheet.names[1])
1542817184377:read_ods('pedestrianfootfall2013.ods',sheet.names[2])
1542817198028:read_ods('pedestrianfootfall2013.ods',sheet.names[40])
1542817215827:read_ods('pedestrianfootfall2013.ods',sheet.names[10])
1542817266021:read_ods('pedestrianfootfall2013.ods',sheet.names[40])
1542817280370:read_ods('pedestrianfootfall2013.ods',sheet.names[30])
1542817321509:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542817321509:download.file(url.footfall, 'footfall_ods.ods')
1542817322546:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542817330293:#getting list of camera locations
1542817330293:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542817334740:colnames(camera.locations) <- c('Loc')
1542817334756:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE))
1542817471376:?slice
1542817519275:for (i in 1:52)
1542817519278:{
1542817519280:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817519283:print(x)
1542817519285:print(slice(x, 3:4))
1542817519287:}
1542817542415:for (i in 1:52)
1542817542415:{
1542817542415:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817542415:print(i)
1542817542415:print(slice(x, 3:4))
1542817542415:}
1542817580590:for (i in 1:52)
1542817580590:{
1542817580590:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817580590:print(i)
1542817580590:print(slice(x, 3))
1542817580590:}
1542817614394:for (i in 1:52)
1542817614394:{
1542817614394:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817614394:print(i)
1542817614394:print(slice(x, 3:5))
1542817614394:}
1542817677831:?slice
1542817708133:for (i in 1:52)
1542817708136:{
1542817708138:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817708141:print(i)
1542817708143:print(slice(x, 1:4))
1542817708146:}
1542817724285:for (i in 1:52)
1542817724285:{
1542817724285:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817724285:print(i)
1542817724285:print(dplyr::slice(x, 1:4))
1542817724300:}
1542817810924:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542817811872:for (i in 1:52)
1542817811872:{
1542817811872:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817811872:print(i)
1542817811872:print(dplyr::slice(x, 1:4))
1542817811889:}
1542817824613:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542817825354:for (i in 1:52)
1542817825354:{
1542817825354:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817825370:print(i)
1542817825370:print(dplyr::slice(x, 1))
1542817825370:}
1542817904482:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542817905379:x <- NULL
1542817905379:for (i in 1:52)
1542817905379:{
1542817905379:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542817905379:print(i)
1542817905394:print(dplyr::slice(x, 3:5))
1542817905394:}
1542817991158:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542817991158:options(digits=2)
1542817991235:library(devtools)
1542817992037:library(readr)
1542817992105:library(ggplot2)
1542817992282:library(ggmap)
1542817992330:devtools::install_github('hadley/ggplot2')
1542817993289:devtools::install_github('dkahle/ggmap')
1542817993798:library(rnoaa)
1542817994525:library(httr)
1542817994586:library(plyr)
1542817994596:library(jsonlite)
1542817994606:library(dplyr)
1542817994619:library(readODS)
1542817994639:library(knitr)
1542817994649:library(hms)
1542817994657:library(lubridate)
1542818011311:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542818011311:download.file(url.footfall, 'footfall_ods.ods')
1542818012022:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542818015156:#getting list of camera locations
1542818015156:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542818019357:colnames(camera.locations) <- c('Loc')
1542818019373:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE))
1542818024610:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542818024610:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542818024610:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542818024626:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542818024641:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542818024641:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542818024657:for(week.i in 1:length(sheet.names))
1542818024657:{
1542818024657:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542818024668:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542818024673:camera1.row <- which(grepl(camera1.name, f1$Time))
1542818024675:print(camera1.row)
1542818024677:camera2.row <- which(grepl(camera2.name, f1$Time))
1542818024679:print(camera2.row)
1542818024681:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542818024683:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542818024687:camera1.all <- rbind(camera1.all, camera1.slice)
1542818024690:camera2.all <- rbind(camera2.all, camera2.slice)
1542818024693:print(week.i)
1542818024697:f1 <- NULL
1542818024699:}
1542818273134:slice(f1, (camera1.row+3):(camera1.row+26))
1542818279776:camera1.row
1542818279776:camera2.row
1542818291467:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[40])
1542818297478:slice(f1, (camera1.row+3):(camera1.row+26))
1542818328047:f1
1542818333547:camera1.row
1542818333642:camera2.row
1542818344953:slice(f1, 1:5)
1542818355212:dplyr::slice(f1, 1:5)
1542818452018:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[40])
1542818456119:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542818459198:dplyr::slice(f1, 1:5)
1542818479518:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542818480269:x <- NULL
1542818480272:for (i in 1:52)
1542818480329:{
1542818480337:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542818480344:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542818480349:print(i)
1542818480353:print(dplyr::slice(x, 3:4))
1542818480357:}
1542818495111:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542818495858:x <- NULL
1542818495862:for (i in 1:52)
1542818495866:{
1542818495868:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542818495871:colnames(x) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542818495873:print(i)
1542818495875:print(dplyr::slice(x, 3:4))
1542818495878:}
1542818575456:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542818576169:x <- NULL
1542818576173:for (i in 1:52)
1542818576175:{
1542818576178:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542818576231:colnames(x) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542818576234:print(i)
1542818576236:print(dplyr::slice(x, 4:5))
1542818576238:}
1542818910940:dplyr::slice(f1, 3:5)
1542818917088:dplyr::slice(f1, 3:4)
1542818934169:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542818935100:x <- NULL
1542818935104:for (i in 1:52)
1542818935106:{
1542818935108:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542818935110:colnames(x) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542818935112:print(i)
1542818935115:print(dplyr::slice(x, 3:4))
1542818935117:}
1542819253573:f1
1542819288416:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542819289135:x <- NULL
1542819289139:for (i in 1:52)
1542819289141:{
1542819289145:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542819289145:colnames(x) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542819289145:print(i)
1542819289145:print(dplyr::slice(x, 1:5))
1542819289145:}
1542819679125:read_ods('pedestrianfootfall2013.ods',sheet.names[15])
1542820012129:?read_ods
1542820284523:read_ods('pedestrianfootfall2013.ods',sheet.names[45])
1542820298036:read_ods('pedestrianfootfall2013.ods',sheet.names[46])
1542820317195:y <- read_ods('pedestrianfootfall2013.ods',sheet.names[46])
1542820322696:y
1542820349347:y <- read_ods('pedestrianfootfall2013.ods',sheet.names[46])
1542820353601:y
1542820353651:colnames(y) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542820359209:y
1542820368883:slice(y, 3)
1542820380704:y
1542820389164:slice(y, 6:24)
1542820395831:slice(y, 3)
1542820399129:slice(y, 4)
1542820404532:slice(y, 4:10)
1542820408128:slice(y, 4:9)
1542820411110:slice(y, 9)
1542820423716:dplyr::slice(y, 9)
1542820427947:dplyr::slice(y, 9:11)
1542820436263:y
1542820526631:y<-select(y, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542820536519:y
1542820581371:y <- read_ods('pedestrianfootfall2013.ods',sheet.names[46])
1542820586380:y
1542820586411:colnames(y) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown1')
1542820586429:y<-select(y, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542820626882:y <- read_ods('pedestrianfootfall2013.ods',sheet.names[46])
1542820631050:y
1542820631114:colnames(y) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542820631117:y<-select(y, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542820631132:y
1542820642380:dplyr::slice(y, 9:11)
1542820672678:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542820673627:x <- NULL
1542820673631:for (i in 1:52)
1542820673634:{
1542820673636:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542820673638:colnames(x) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542820673640:print(i)
1542820673643:ncols(x)
1542820673645:}
1542820705638:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542820706847:x <- NULL
1542820706850:for (i in 1:52)
1542820706853:{
1542820706855:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542820706858:colnames(x) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542820706860:print(i)
1542820706862:ncol(x)
1542820706864:}
1542820923110:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542820924204:x <- NULL
1542820924210:for (i in 1:52)
1542820924213:{
1542820924215:x <- read_ods('pedestrianfootfall2013.ods',sheet.names[i])
1542820924218:colnames(x) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542820924220:print(i)
1542820924223:print(ncol(x))
1542820924225:}
1542822115574:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542822115574:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542822115574:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822115589:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822115589:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822115605:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822115621:for(week.i in 1:length(sheet.names))
1542822115621:{
1542822115621:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542822115621:if (ncols==15)
1542822115636:{
1542822115636:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822115636:} else {
1542822115636:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542822115636:}
1542822115636:camera1.row <- which(grepl(camera1.name, f1$Time))
1542822115636:print(camera1.row)
1542822115652:camera2.row <- which(grepl(camera2.name, f1$Time))
1542822115652:print(camera2.row)
1542822115652:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822115652:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822115652:camera1.all <- rbind(camera1.all, camera1.slice)
1542822115652:camera2.all <- rbind(camera2.all, camera2.slice)
1542822115668:print(week.i)
1542822115668:f1 <- NULL
1542822115668:}
1542822158031:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542822158031:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542822158031:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822158047:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822158047:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822158062:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822158062:for(week.i in 1:length(sheet.names))
1542822158078:{
1542822158078:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542822158078:if (ncol==15)
1542822158078:{
1542822158078:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822158094:} else {
1542822158094:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542822158094:}
1542822158094:camera1.row <- which(grepl(camera1.name, f1$Time))
1542822158094:print(camera1.row)
1542822158094:camera2.row <- which(grepl(camera2.name, f1$Time))
1542822158094:print(camera2.row)
1542822158111:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822158113:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822158116:camera1.all <- rbind(camera1.all, camera1.slice)
1542822158118:camera2.all <- rbind(camera2.all, camera2.slice)
1542822158122:print(week.i)
1542822158125:f1 <- NULL
1542822158127:}
1542822172971:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542822172971:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542822172971:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822173100:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822173110:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822173118:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822173127:for(week.i in 1:length(sheet.names))
1542822173129:{
1542822173134:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542822173138:if (ncol=15)
1542822192743:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542822192743:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542822192743:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822192872:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822192882:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822192892:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822192901:for(week.i in 1:length(sheet.names))
1542822192903:{
1542822192907:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542822192911:if (ncol(f1)=15)
1542822208000:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542822208004:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542822208007:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822208130:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822208139:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822208148:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822208158:for(week.i in 1:length(sheet.names))
1542822208160:{
1542822208164:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542822208168:if (ncol(f1)==15)
1542822208171:{
1542822208173:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822208175:} else {
1542822208177:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542822208179:}
1542822208183:camera1.row <- which(grepl(camera1.name, f1$Time))
1542822208185:print(camera1.row)
1542822208187:camera2.row <- which(grepl(camera2.name, f1$Time))
1542822208189:print(camera2.row)
1542822208192:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822208194:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822208197:camera1.all <- rbind(camera1.all, camera1.slice)
1542822208199:camera2.all <- rbind(camera2.all, camera2.slice)
1542822208202:print(week.i)
1542822208206:f1 <- NULL
1542822208208:}
1542822512837:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542822512837:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542822512837:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822512966:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822512976:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822512984:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822512993:for(week.i in 1:length(sheet.names))
1542822512996:{
1542822513001:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542822513005:if (ncol(f1)==15)
1542822513007:{
1542822513009:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822513011:} else {
1542822513013:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542822513015:}
1542822513016:f1 < select(f1, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542822513020:camera1.row <- which(grepl(camera1.name, f1$Time))
1542822513022:# print(camera1.row)
1542822513024:camera2.row <- which(grepl(camera2.name, f1$Time))
1542822513026:#print(camera2.row)
1542822513028:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822513030:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822513034:camera1.all <- rbind(camera1.all, camera1.slice)
1542822513036:camera2.all <- rbind(camera2.all, camera2.slice)
1542822513041:#print(week.i)
1542822513045:f1 <- NULL
1542822513047:}
1542822815240:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542822815243:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542822815247:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822815256:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822815265:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542822815274:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822815283:for(week.i in 1:length(sheet.names))
1542822815285:{
1542822815290:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542822815293:if (ncol(f1)==15)
1542822815296:{
1542822815298:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542822815300:} else {
1542822815302:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542822815304:}
1542822815306:f1 <- select(f1, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542822815310:camera1.row <- which(grepl(camera1.name, f1$Time))
1542822815312:camera2.row <- which(grepl(camera2.name, f1$Time))
1542822815314:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822815316:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542822815320:camera1.all <- rbind(camera1.all, camera1.slice)
1542822815323:camera2.all <- rbind(camera2.all, camera2.slice)
1542822815327:#print(week.i)
1542822815330:f1 <- NULL
1542822815332:}
1542823123992:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542823123996:for (i in 1:length(col.change))
1542823123999:{
1542823124002:camera1.all[[col.change[i]]] <- as.numeric(camera1.all[[col.change[i]]])
1542823124005:camera2.all[[col.change[i]]] <- as.numeric(camera2.all[[col.change[i]]])
1542823124008:}
1542823171831:summary(camera1.all)
1542823172017:summary(camera2.all)
1542823213872:camera1.all
1542823218408:camera1.all[1]
1542823226152:camera1.all[2:15]
1542823306082:for (i in 2:15)
1542823306089:{
1542823306095:camera1.all[i] <- as.numeric(camera1.all[i])
1542823306101:camera2.all[i] <- as.numeric(camera2.all[i])
1542823306159:}
1542823350868:as.numeric(camera1.all[2])
1542823372675:camera1.all[ Mon.In]
1542823390178:summary(camera1.all)
1542823390380:summary(camera2.all)
1542823426443:camera1.all$Mon.In
1542823452333:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542823495149:col.change <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542823505280:col.change
1542823511682:col.change[1]
1542823567596:for (i in 1:length(col.change))
1542823567600:{
1542823567603:camera1.all$col.change[i] <- as.numeric(camera1.all$col.change[i])
1542823567606:camera2.all$col.change[i] <- as.numeric(camera2.all$col.change[i])
1542823567609:}
1542823574407:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542823574618:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542823574834:summary(camera1.all)
1542823575195:summary(camera2.all)
1542823602558:length(col.change)
1542823623005:col.change <- c('Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542823630976:for (i in 1:length(col.change))
1542823630979:{
1542823630981:camera1.all$col.change[i] <- as.numeric(camera1.all$col.change[i])
1542823630983:camera2.all$col.change[i] <- as.numeric(camera2.all$col.change[i])
1542823630986:}
1542823647721:summary(camera1.all)
1542823648044:summary(camera2.all)
1542823705847:col.change <- c('Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542823705861:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542823705868:for (i in 1:length(col.change))
1542823705925:{
1542823705932:camera1.all[col.change[i]] <- as.numeric(camera1.all[col.change[i]])
1542823705938:camera2.all[col.change[i]] <- as.numeric(camera2.all[col.change[i]])
1542823705944:}
1542823730534:as.numeric(camera1.all[col.change[2]])
1542823748851:as.numeric(camera1.all[Mon.Out])
1542823764103:camera1.all$Mon.Out
1542823776192:as.numeric(camera1.all$Mon.Out)
1542823812394:camera1.all$col.change[4]
1542823822723:camera1.all$[col.change[4]]
1542823835380:camera1.all[col.change[4]]
1542823848998:as.numeric(camera1.all[col.change[4]])
1542826155260:camera1.all
1542826161741:summary(camera1.all)
1542826177444:camera1.all$Mon.Out <- as.numeric(camera1.all$Mon.Out)
1542826181197:summary(camera1.all)
1542826256975:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542826257058:camera1.all$Mon.Out <- as.numeric(camera1.all$Mon.Out)
1542826257084:camera1.all$Mon.In <- as.numeric(camera1.all$Tue.In)
1542826257107:camera1.all$Mon.Out <- as.numeric(camera1.all$Tue.Out)
1542826257130:camera1.all$Mon.In <- as.numeric(camera1.all$Wed.In)
1542826257151:camera1.all$Mon.Out <- as.numeric(camera1.all$Wed.Out)
1542826257173:camera1.all$Mon.In <- as.numeric(camera1.all$Thurs.In)
1542826257196:camera1.all$Mon.Out <- as.numeric(camera1.all$Thurs.Out)
1542826257218:camera1.all$Mon.In <- as.numeric(camera1.all$Fri.In)
1542826257240:camera1.all$Mon.Out <- as.numeric(camera1.all$Fri.Out)
1542826257262:camera1.all$Mon.In <- as.numeric(camera1.all$Sat.In)
1542826257286:camera1.all$Mon.Out <- as.numeric(camera1.all$Sat.Out)
1542826257309:camera1.all$Mon.In <- as.numeric(camera1.all$Sun.In)
1542826257332:camera1.all$Mon.Out <- as.numeric(camera1.all$Sun.Out)
1542826301315:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542826301505:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542826313225:summary(camera1.all)
1542826313444:summary(camera2.all)
1542826365696:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542826365757:camera1.all$Mon.Out <- as.numeric(camera1.all$Mon.Out)
1542826365800:camera1.all$Tue.In <- as.numeric(camera1.all$Tue.In)
1542826365822:camera1.all$Tue.Out <- as.numeric(camera1.all$Tue.Out)
1542826365843:camera1.all$Wed.In <- as.numeric(camera1.all$Wed.In)
1542826365864:camera1.all$Wed.Out <- as.numeric(camera1.all$Wed.Out)
1542826365883:camera1.all$Thurs.In <- as.numeric(camera1.all$Thurs.In)
1542826365903:camera1.all$Thurs.Out <- as.numeric(camera1.all$Thurs.Out)
1542826365923:camera1.all$Fri.In <- as.numeric(camera1.all$Fri.In)
1542826365948:camera1.all$Fri.Out <- as.numeric(camera1.all$Fri.Out)
1542826365969:camera1.all$Sat.In <- as.numeric(camera1.all$Sat.In)
1542826365988:camera1.all$Sat.Out <- as.numeric(camera1.all$Sat.Out)
1542826366006:camera1.all$Sun.In <- as.numeric(camera1.all$Sun.In)
1542826366023:camera1.all$Sun.Out <- as.numeric(camera1.all$Sun.Out)
1542826373354:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542826373500:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542826373514:summary(camera1.all)
1542826373825:summary(camera2.all)
1542826970160:knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE, message=FALSE)
1542826970162:options(digits=2)
1542826970225:camera1.all
1542826981690:camera1.all$Sun.Out <- as.numeric(camera1.all$Sun.Out)
1542826990784:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542826990899:download.file(url.footfall, 'footfall_ods.ods')
1542826991811:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542826997135:library(devtools)
1542826997554:library(readr)
1542826997632:library(ggplot2)
1542826997694:library(ggmap)
1542826997753:devtools::install_github('hadley/ggplot2')
1542826998950:devtools::install_github('dkahle/ggmap')
1542826999663:library(rnoaa)
1542827000141:library(httr)
1542827000150:library(plyr)
1542827000158:library(jsonlite)
1542827000221:library(dplyr)
1542827000249:library(readODS)
1542827000320:library(knitr)
1542827000329:library(hms)
1542827000337:library(lubridate)
1542827019696:url.footfall <- 'https://data.smartdublin.ie/dataset/8204be0a-6348-459e-96e9-65bb75600ec3/resource/384fe47a-2f25-4f52-8fc5-8e61899951e9/download/pedestrianfootfall2013.ods'
1542827019700:download.file(url.footfall, 'footfall_ods.ods')
1542827020332:sheet.names <- ods_sheets('pedestrianfootfall2013.ods')
1542827023191:#getting list of camera locations
1542827023194:camera.locations <- read_ods('pedestrianfootfall2013.ods',sheet.names[1])[1]
1542827027559:colnames(camera.locations) <- c('Loc')
1542827027563:camera.locations %>% filter(., grepl("Entrance Name:", Loc, fixed = TRUE))
1542827032475:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542827032480:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542827032484:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542827032494:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542827032506:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542827032516:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542827032525:for(week.i in 1:length(sheet.names))
1542827032527:{
1542827032532:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542827032535:if (ncol(f1)==15)
1542827032537:{
1542827032539:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542827032541:} else {
1542827032542:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542827032544:}
1542827032546:f1 <- select(f1, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542827032550:camera1.row <- which(grepl(camera1.name, f1$Time))
1542827032552:camera2.row <- which(grepl(camera2.name, f1$Time))
1542827032554:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542827032556:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542827032559:camera1.all <- rbind(camera1.all, camera1.slice)
1542827032561:camera2.all <- rbind(camera2.all, camera2.slice)
1542827032565:#print(week.i)
1542827032569:f1 <- NULL
1542827032571:}
1542827250228:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542827250457:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542827250472:camera1.all$Mon.Out <- as.numeric(camera1.all$Mon.Out)
1542827250539:camera1.all$Tue.In <- as.numeric(camera1.all$Tue.In)
1542827250593:camera1.all$Tue.Out <- as.numeric(camera1.all$Tue.Out)
1542827250601:camera1.all$Wed.In <- as.numeric(camera1.all$Wed.In)
1542827250616:camera1.all$Wed.Out <- as.numeric(camera1.all$Wed.Out)
1542827250632:camera1.all$Thurs.In <- as.numeric(camera1.all$Thurs.In)
1542827250647:camera1.all$Thurs.Out <- as.numeric(camera1.all$Thurs.Out)
1542827250773:camera1.all$Fri.In <- as.numeric(camera1.all$Fri.In)
1542827250849:camera1.all$Fri.Out <- as.numeric(camera1.all$Fri.Out)
1542827250995:camera1.all$Sat.In <- as.numeric(camera1.all$Sat.In)
1542827251026:camera1.all$Sat.Out <- as.numeric(camera1.all$Sat.Out)
1542827251026:camera1.all$Sun.In <- as.numeric(camera1.all$Sun.In)
1542827251053:camera1.all$Sun.Out <- as.numeric(camera1.all$Sun.Out)
1542827251176:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542827251260:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542827251311:summary(camera1.all)
1542827251385:summary(camera2.all)
1542827258818:camera1.all
1542827402002:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542827402003:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542827402006:camera1.all$Mon.Out <- as.numeric(camera1.all$Mon.Out)
1542827402022:camera1.all$Tue.In <- as.numeric(camera1.all$Tue.In)
1542827402037:camera1.all$Tue.Out <- as.numeric(camera1.all$Tue.Out)
1542827402051:camera1.all$Wed.In <- as.numeric(camera1.all$Wed.In)
1542827402073:camera1.all$Wed.Out <- as.numeric(camera1.all$Wed.Out)
1542827402084:camera1.all$Thurs.In <- as.numeric(camera1.all$Thurs.In)
1542827402097:camera1.all$Thurs.Out <- as.numeric(camera1.all$Thurs.Out)
1542827402108:camera1.all$Fri.In <- as.numeric(camera1.all$Fri.In)
1542827402119:camera1.all$Fri.Out <- as.numeric(camera1.all$Fri.Out)
1542827402130:camera1.all$Sat.In <- as.numeric(camera1.all$Sat.In)
1542827402142:camera1.all$Sat.Out <- as.numeric(camera1.all$Sat.Out)
1542827402153:camera1.all$Sun.In <- as.numeric(camera1.all$Sun.In)
1542827402164:camera1.all$Sun.Out <- as.numeric(camera1.all$Sun.Out)
1542827402177:camera2.all$Mon.In <- as.numeric(camera2.all$Mon.In)
1542827402181:camera2.all$Mon.Out <- as.numeric(camera2.all$Mon.Out)
1542827402184:camera2.all$Tue.In <- as.numeric(camera2.all$Tue.In)
1542827402187:camera2.all$Tue.Out <- as.numeric(camera2.all$Tue.Out)
1542827402191:camera2.all$Wed.In <- as.numeric(camera2.all$Wed.In)
1542827402195:camera2.all$Wed.Out <- as.numeric(camera2.all$Wed.Out)
1542827402198:camera2.all$Thurs.In <- as.numeric(camera2.all$Thurs.In)
1542827402201:camera2.all$Thurs.Out <- as.numeric(camera2.all$Thurs.Out)
1542827402216:camera2.all$Fri.In <- as.numeric(camera2.all$Fri.In)
1542827402231:camera2.all$Fri.Out <- as.numeric(camera2.all$Fri.Out)
1542827402254:camera2.all$Sat.In <- as.numeric(camera2.all$Sat.In)
1542827402268:camera2.all$Sat.Out <- as.numeric(camera2.all$Sat.Out)
1542827402281:camera2.all$Sun.In <- as.numeric(camera2.all$Sun.In)
1542827402293:camera2.all$Sun.Out <- as.numeric(camera2.all$Sun.Out)
1542827402457:# there was inconsistency in sheet naming so fixing this
1542827402459:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542827402472:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542827423468:summary(camera1.all)
1542827423548:summary(camera2.all)
1542827630127:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542827630255:camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542827723191:ambient.sound.url <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542827723195:download.file(ambient.sound.url, destfile = 'ambient_sound.zip')
1542827731528:unzip('ambient_sound.zip', exdir = './ambient_sound')
1542827742817:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542827742819:months <- format(ISOdate(2013,1:12,1),"%B")
1542827742829:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542827743037:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542827743043:for (i in 1:12)
1542827743045:{
1542827743048:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542827743050:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542827743053:date.i$year <- '2013'
1542827743055:date.i$month.char <- months[i]
1542827743057:if(nchar(as.character(i))==1)
1542827743059:{
1542827743060:date.i$month.num <- paste('0', i, sep='')
1542827743062:} else {
1542827743064:date.i$month.num <- i
1542827743066:}
1542827743070:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542827743075:dates.df <- rbind(dates.df, date.i)
1542827743078:date.i <- NULL
1542827743080:}
1542827743105:dates.df
1542827749068:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542827749073:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542827749079:for (i.month in 1:nrow(dates.df))
1542827749081:{
1542827749083:for (i.day in 1:dates.df$day[i.month])
1542827749086:{
1542827749090:if(nchar(as.character(i.day))==1)
1542827749092:{
1542827749094:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542827749096:} else {
1542827749099:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542827749101:}
1542827749106:if (!file.exists(sound.file)) next
1542827749109:sound.read <- read.table(sound.file)
1542827749111:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542827749114:sound.all <- rbind.data.frame(sound.all, sound.df)
1542827749117:sound.df<- NULL
1542827749119:}
1542827749121:}
1542827754145:sound.all
1542827762600:sound.tidy <- sound.all
1542827762603:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542827762685:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542827762731:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542827762770:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542827763404:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542827763480:sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_'))
1542827763510:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542827763588:sound.tidy.all <- sound.tidy.summary[2:5]
1542827763599:sound.tidy.all
1542827778065:sound.tidy <- sound.all
1542827778068:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542827778206:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542827778257:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542827778291:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542827778930:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542827779006:#sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_'))
1542827779009:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542827779140:sound.tidy.all <- sound.tidy.summary[2:5]
1542827804164:sound.tidy <- sound.all
1542827804167:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542827804351:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542827804395:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542827804660:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542827805257:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542827805380:#sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_'))
1542827805383:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542827805468:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542827805605:sound.tidy.all <- sound.tidy.summary[2:5]
1542827805613:sound.tidy.all
1542827932101:?gsub
1542828199002:gsub('_', '_0', camera1.slice$Time)
1542828240879:#
1542828240882:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542828240885:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542828240889:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542828241036:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542828241046:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542828241055:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542828241063:for(week.i in 1:length(sheet.names))
1542828241065:{
1542828241070:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542828241074:if (ncol(f1)==15)
1542828241076:{
1542828241078:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542828241080:} else {
1542828241082:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542828241084:}
1542828241087:f1 <- select(f1, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542828241090:camera1.row <- which(grepl(camera1.name, f1$Time))
1542828241091:camera2.row <- which(grepl(camera2.name, f1$Time))
1542828241093:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542828241095:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542828241100:if(nchar(Time)==6)
1542828241102:{
1542828241104:gsub('_', '_0', camera1.slice$Week)
1542828241105:gsub('_', '_0', camera2.slice$Week)
1542828241107:}
1542828241110:camera1.all <- rbind(camera1.all, camera1.slice)
1542828241112:camera2.all <- rbind(camera2.all, camera2.slice)
1542828241116:f1 <- NULL
1542828241118:}
1542828429412:camera1.all$Week <- gsub('Week_1', 'Week_01', camera1.all$Week)
1542828429412:camera1.all$Week <- gsub('Week_2', 'Week_02', camera1.all$Week)
1542828429593:camera1.all$Week <- gsub('Week_3', 'Week_03', camera1.all$Week)
1542828429602:camera1.all$Week <- gsub('Week_4', 'Week_04', camera1.all$Week)
1542828429611:camera1.all$Week <- gsub('Week_5', 'Week_05', camera1.all$Week)
1542828429620:camera1.all$Week <- gsub('Week_6', 'Week_06', camera1.all$Week)
1542828429628:camera1.all$Week <- gsub('Week_7', 'Week_07', camera1.all$Week)
1542828429636:camera1.all$Week <- gsub('Week_8', 'Week_08', camera1.all$Week)
1542828429645:camera1.all$Week <- gsub('Week_9', 'Week_09', camera1.all$Week)
1542828429653:camera2.all$Week <- gsub('Week_1', 'Week_01', camera2.all$Week)
1542828429662:camera2.all$Week <- gsub('Week_2', 'Week_02', camera2.all$Week)
1542828429671:camera2.all$Week <- gsub('Week_3', 'Week_03', camera2.all$Week)
1542828429680:camera2.all$Week <- gsub('Week_4', 'Week_04', camera2.all$Week)
1542828429689:camera2.all$Week <- gsub('Week_5', 'Week_05', camera2.all$Week)
1542828429697:camera2.all$Week <- gsub('Week_6', 'Week_06', camera2.all$Week)
1542828429705:camera2.all$Week <- gsub('Week_7', 'Week_07', camera2.all$Week)
1542828429714:camera2.all$Week <- gsub('Week_8', 'Week_08', camera2.all$Week)
1542828429723:camera2.all$Week <- gsub('Week_9', 'Week_09', camera2.all$Week)
1542828439548:camera1.all
1542828444442:#
1542828444442:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542828444442:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542828444442:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542828444457:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542828444581:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542828444591:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542828444600:for(week.i in 1:length(sheet.names))
1542828444602:{
1542828444607:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542828444612:if (ncol(f1)==15)
1542828444614:{
1542828444616:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542828444618:} else {
1542828444621:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542828444623:}
1542828444625:f1 <- select(f1, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542828444729:camera1.row <- which(grepl(camera1.name, f1$Time))
1542828444731:camera2.row <- which(grepl(camera2.name, f1$Time))
1542828444734:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542828444736:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542828444739:camera1.all <- rbind(camera1.all, camera1.slice)
1542828444741:camera2.all <- rbind(camera2.all, camera2.slice)
1542828444745:f1 <- NULL
1542828444747:}
1542828732368:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542828732370:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542828732386:camera1.all$Mon.Out <- as.numeric(camera1.all$Mon.Out)
1542828732393:camera1.all$Tue.In <- as.numeric(camera1.all$Tue.In)
1542828732530:camera1.all$Tue.Out <- as.numeric(camera1.all$Tue.Out)
1542828732545:camera1.all$Wed.In <- as.numeric(camera1.all$Wed.In)
1542828732559:camera1.all$Wed.Out <- as.numeric(camera1.all$Wed.Out)
1542828732573:camera1.all$Thurs.In <- as.numeric(camera1.all$Thurs.In)
1542828732587:camera1.all$Thurs.Out <- as.numeric(camera1.all$Thurs.Out)
1542828732605:camera1.all$Fri.In <- as.numeric(camera1.all$Fri.In)
1542828732625:camera1.all$Fri.Out <- as.numeric(camera1.all$Fri.Out)
1542828732638:camera1.all$Sat.In <- as.numeric(camera1.all$Sat.In)
1542828732803:camera1.all$Sat.Out <- as.numeric(camera1.all$Sat.Out)
1542828732816:camera1.all$Sun.In <- as.numeric(camera1.all$Sun.In)
1542828732829:camera1.all$Sun.Out <- as.numeric(camera1.all$Sun.Out)
1542828732841:camera2.all$Mon.In <- as.numeric(camera2.all$Mon.In)
1542828732845:camera2.all$Mon.Out <- as.numeric(camera2.all$Mon.Out)
1542828732849:camera2.all$Tue.In <- as.numeric(camera2.all$Tue.In)
1542828732852:camera2.all$Tue.Out <- as.numeric(camera2.all$Tue.Out)
1542828732856:camera2.all$Wed.In <- as.numeric(camera2.all$Wed.In)
1542828732859:camera2.all$Wed.Out <- as.numeric(camera2.all$Wed.Out)
1542828732862:camera2.all$Thurs.In <- as.numeric(camera2.all$Thurs.In)
1542828732865:camera2.all$Thurs.Out <- as.numeric(camera2.all$Thurs.Out)
1542828732880:camera2.all$Fri.In <- as.numeric(camera2.all$Fri.In)
1542828732896:camera2.all$Fri.Out <- as.numeric(camera2.all$Fri.Out)
1542828733017:camera2.all$Sat.In <- as.numeric(camera2.all$Sat.In)
1542828733144:camera2.all$Sat.Out <- as.numeric(camera2.all$Sat.Out)
1542828733144:camera2.all$Sun.In <- as.numeric(camera2.all$Sun.In)
1542828733214:camera2.all$Sun.Out <- as.numeric(camera2.all$Sun.Out)
1542828733240:# there was inconsistency in sheet naming so fixing this
1542828733240:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542828733240:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542828733256:camera1.all$Week <- gsub('Week_1', 'Week_01', camera1.all$Week)
1542828733276:camera1.all$Week <- gsub('Week_2', 'Week_02', camera1.all$Week)
1542828733283:camera1.all$Week <- gsub('Week_3', 'Week_03', camera1.all$Week)
1542828733411:camera1.all$Week <- gsub('Week_4', 'Week_04', camera1.all$Week)
1542828733425:camera1.all$Week <- gsub('Week_5', 'Week_05', camera1.all$Week)
1542828733566:camera1.all$Week <- gsub('Week_6', 'Week_06', camera1.all$Week)
1542828733566:camera1.all$Week <- gsub('Week_7', 'Week_07', camera1.all$Week)
1542828733633:camera1.all$Week <- gsub('Week_8', 'Week_08', camera1.all$Week)
1542828733633:camera1.all$Week <- gsub('Week_9', 'Week_09', camera1.all$Week)
1542828733713:camera2.all$Week <- gsub('Week_1', 'Week_01', camera2.all$Week)
1542828733846:camera2.all$Week <- gsub('Week_2', 'Week_02', camera2.all$Week)
1542828733870:camera2.all$Week <- gsub('Week_3', 'Week_03', camera2.all$Week)
1542828733882:camera2.all$Week <- gsub('Week_4', 'Week_04', camera2.all$Week)
1542828733948:camera2.all$Week <- gsub('Week_5', 'Week_05', camera2.all$Week)
1542828734000:camera2.all$Week <- gsub('Week_6', 'Week_06', camera2.all$Week)
1542828734066:camera2.all$Week <- gsub('Week_7', 'Week_07', camera2.all$Week)
1542828734146:camera2.all$Week <- gsub('Week_8', 'Week_08', camera2.all$Week)
1542828734197:camera2.all$Week <- gsub('Week_9', 'Week_09', camera2.all$Week)
1542828734272:camera1.all
1542828750588:summary(camera1.all)
1542828750887:summary(camera2.all)
1542828754883:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542828754888:camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542829075976:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542829075978:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542829075991:camera1.all$Mon.Out <- as.numeric(camera1.all$Mon.Out)
1542829076003:camera1.all$Tue.In <- as.numeric(camera1.all$Tue.In)
1542829076015:camera1.all$Tue.Out <- as.numeric(camera1.all$Tue.Out)
1542829076028:camera1.all$Wed.In <- as.numeric(camera1.all$Wed.In)
1542829076040:camera1.all$Wed.Out <- as.numeric(camera1.all$Wed.Out)
1542829076052:camera1.all$Thurs.In <- as.numeric(camera1.all$Thurs.In)
1542829076063:camera1.all$Thurs.Out <- as.numeric(camera1.all$Thurs.Out)
1542829076075:camera1.all$Fri.In <- as.numeric(camera1.all$Fri.In)
1542829076087:camera1.all$Fri.Out <- as.numeric(camera1.all$Fri.Out)
1542829076100:camera1.all$Sat.In <- as.numeric(camera1.all$Sat.In)
1542829076124:camera1.all$Sat.Out <- as.numeric(camera1.all$Sat.Out)
1542829076137:camera1.all$Sun.In <- as.numeric(camera1.all$Sun.In)
1542829076150:camera1.all$Sun.Out <- as.numeric(camera1.all$Sun.Out)
1542829076163:camera2.all$Mon.In <- as.numeric(camera2.all$Mon.In)
1542829076177:camera2.all$Mon.Out <- as.numeric(camera2.all$Mon.Out)
1542829076289:camera2.all$Tue.In <- as.numeric(camera2.all$Tue.In)
1542829076301:camera2.all$Tue.Out <- as.numeric(camera2.all$Tue.Out)
1542829076314:camera2.all$Wed.In <- as.numeric(camera2.all$Wed.In)
1542829076325:camera2.all$Wed.Out <- as.numeric(camera2.all$Wed.Out)
1542829076337:camera2.all$Thurs.In <- as.numeric(camera2.all$Thurs.In)
1542829076349:camera2.all$Thurs.Out <- as.numeric(camera2.all$Thurs.Out)
1542829076363:camera2.all$Fri.In <- as.numeric(camera2.all$Fri.In)
1542829076375:camera2.all$Fri.Out <- as.numeric(camera2.all$Fri.Out)
1542829076390:camera2.all$Sat.In <- as.numeric(camera2.all$Sat.In)
1542829076402:camera2.all$Sat.Out <- as.numeric(camera2.all$Sat.Out)
1542829076420:camera2.all$Sun.In <- as.numeric(camera2.all$Sun.In)
1542829076432:camera2.all$Sun.Out <- as.numeric(camera2.all$Sun.Out)
1542829076444:# there was inconsistency in sheet naming so fixing this
1542829076447:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542829076463:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542829076475:camera1.all$Week <- gsub('Week_1\\>', 'Week_01', camera1.all$Week)
1542829076487:camera1.all$Week <- gsub('Week_2\\>', 'Week_02', camera1.all$Week)
1542829076499:camera1.all$Week <- gsub('Week_3\\>', 'Week_03', camera1.all$Week)
1542829076512:camera1.all$Week <- gsub('Week_4\\>', 'Week_04', camera1.all$Week)
1542829076524:camera1.all$Week <- gsub('Week_5\\>', 'Week_05', camera1.all$Week)
1542829076536:camera1.all$Week <- gsub('Week_6\\>', 'Week_06', camera1.all$Week)
1542829076555:camera1.all$Week <- gsub('Week_7\\>', 'Week_07', camera1.all$Week)
1542829076569:camera1.all$Week <- gsub('Week_8\\>', 'Week_08', camera1.all$Week)
1542829076582:camera1.all$Week <- gsub('Week_9\\>', 'Week_09', camera1.all$Week)
1542829076595:camera2.all$Week <- gsub('Week_1\\>', 'Week_01', camera2.all$Week)
1542829076607:camera2.all$Week <- gsub('Week_2\\>', 'Week_02', camera2.all$Week)
1542829076618:camera2.all$Week <- gsub('Week_3\\>', 'Week_03', camera2.all$Week)
1542829076631:camera2.all$Week <- gsub('Week_4\\>', 'Week_04', camera2.all$Week)
1542829076643:camera2.all$Week <- gsub('Week_5\\>', 'Week_05', camera2.all$Week)
1542829076655:camera2.all$Week <- gsub('Week_6\\>', 'Week_06', camera2.all$Week)
1542829076667:camera2.all$Week <- gsub('Week_7\\>', 'Week_07', camera2.all$Week)
1542829076679:camera2.all$Week <- gsub('Week_8\\>', 'Week_08', camera2.all$Week)
1542829076726:camera2.all$Week <- gsub('Week_9\\>', 'Week_09', camera2.all$Week)
1542829076738:camera1.all
1542829081850:summary(camera1.all)
1542829081992:summary(camera2.all)
1542829085658:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542829085723:camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542829186692:#
1542829186694:camera1.name <- 'Entrance Name: Capel St at Mullen'
1542829186698:camera2.name <- 'Entrance Name: Grafton St at M&S'
1542829186701:camera1.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542829186710:colnames(camera1.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542829186719:camera2.all <- data.frame(matrix(ncol = 15, nrow = 0))
1542829186727:colnames(camera2.all) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542829186785:for(week.i in 1:length(sheet.names))
1542829186788:{
1542829186793:f1 <- read_ods('pedestrianfootfall2013.ods',sheet.names[week.i])
1542829186796:if (ncol(f1)==15)
1542829186798:{
1542829186800:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out')
1542829186803:} else {
1542829186805:colnames(f1) <- c('Time', 'Mon.In', 'Mon.Out', 'Tue.In', 'Tue.Out', 'Wed.In', 'Wed.Out', 'Thurs.In', 'Thurs.Out', 'Fri.In', 'Fri.Out', 'Sat.In', 'Sat.Out', 'Sun.In', 'Sun.Out', 'unknown1', 'unknown2', 'unknown3')
1542829186807:}
1542829186809:f1 <- select(f1, Time, Mon.In, Mon.Out, Tue.In, Tue.Out, Wed.In, Wed.Out, Thurs.In, Thurs.Out, Fri.In, Fri.Out, Sat.In, Sat.Out, Sun.In, Sun.Out)
1542829186813:camera1.row <- which(grepl(camera1.name, f1$Time))
1542829186815:camera2.row <- which(grepl(camera2.name, f1$Time))
1542829186817:camera1.slice <- slice(f1, (camera1.row+3):(camera1.row+26)) %>% mutate(Week=sheet.names[week.i])
1542829186819:camera2.slice <- slice(f1, (camera2.row+3):(camera2.row+26)) %>% mutate(Week=sheet.names[week.i])
1542829186822:camera1.all <- rbind(camera1.all, camera1.slice)
1542829186824:camera2.all <- rbind(camera2.all, camera2.slice)
1542829186828:f1 <- NULL
1542829186829:}
1542829419439:#all fields are character (they contained some text before using split), so must change all numeric characters to numeric
1542829419441:camera1.all$Mon.In <- as.numeric(camera1.all$Mon.In)
1542829419609:camera1.all$Mon.Out <- as.numeric(camera1.all$Mon.Out)
1542829419625:camera1.all$Tue.In <- as.numeric(camera1.all$Tue.In)
1542829419640:camera1.all$Tue.Out <- as.numeric(camera1.all$Tue.Out)
1542829419655:camera1.all$Wed.In <- as.numeric(camera1.all$Wed.In)
1542829419669:camera1.all$Wed.Out <- as.numeric(camera1.all$Wed.Out)
1542829419683:camera1.all$Thurs.In <- as.numeric(camera1.all$Thurs.In)
1542829419695:camera1.all$Thurs.Out <- as.numeric(camera1.all$Thurs.Out)
1542829419709:camera1.all$Fri.In <- as.numeric(camera1.all$Fri.In)
1542829419725:camera1.all$Fri.Out <- as.numeric(camera1.all$Fri.Out)
1542829419738:camera1.all$Sat.In <- as.numeric(camera1.all$Sat.In)
1542829419750:camera1.all$Sat.Out <- as.numeric(camera1.all$Sat.Out)
1542829419763:camera1.all$Sun.In <- as.numeric(camera1.all$Sun.In)
1542829419775:camera1.all$Sun.Out <- as.numeric(camera1.all$Sun.Out)
1542829419786:camera2.all$Mon.In <- as.numeric(camera2.all$Mon.In)
1542829419790:camera2.all$Mon.Out <- as.numeric(camera2.all$Mon.Out)
1542829419793:camera2.all$Tue.In <- as.numeric(camera2.all$Tue.In)
1542829419797:camera2.all$Tue.Out <- as.numeric(camera2.all$Tue.Out)
1542829419800:camera2.all$Wed.In <- as.numeric(camera2.all$Wed.In)
1542829419803:camera2.all$Wed.Out <- as.numeric(camera2.all$Wed.Out)
1542829419807:camera2.all$Thurs.In <- as.numeric(camera2.all$Thurs.In)
1542829419810:camera2.all$Thurs.Out <- as.numeric(camera2.all$Thurs.Out)
1542829419825:camera2.all$Fri.In <- as.numeric(camera2.all$Fri.In)
1542829419839:camera2.all$Fri.Out <- as.numeric(camera2.all$Fri.Out)
1542829420121:camera2.all$Sat.In <- as.numeric(camera2.all$Sat.In)
1542829420189:camera2.all$Sat.Out <- as.numeric(camera2.all$Sat.Out)
1542829420203:camera2.all$Sun.In <- as.numeric(camera2.all$Sun.In)
1542829420215:camera2.all$Sun.Out <- as.numeric(camera2.all$Sun.Out)
1542829420226:# there was inconsistency in sheet naming so fixing this
1542829420228:camera1.all$Week <- gsub('Sheet13', 'Week_13', camera1.all$Week)
1542829420239:camera2.all$Week <- gsub('Sheet13', 'Week_13', camera2.all$Week)
1542829420251:camera1.all$Week <- gsub('Week_1\\>', 'Week_01', camera1.all$Week)
1542829420364:camera1.all$Week <- gsub('Week_2\\>', 'Week_02', camera1.all$Week)
1542829420377:camera1.all$Week <- gsub('Week_3\\>', 'Week_03', camera1.all$Week)
1542829420440:camera1.all$Week <- gsub('Week_4\\>', 'Week_04', camera1.all$Week)
1542829420502:camera1.all$Week <- gsub('Week_5\\>', 'Week_05', camera1.all$Week)
1542829420568:camera1.all$Week <- gsub('Week_6\\>', 'Week_06', camera1.all$Week)
1542829420630:camera1.all$Week <- gsub('Week_7\\>', 'Week_07', camera1.all$Week)
1542829420693:camera1.all$Week <- gsub('Week_8\\>', 'Week_08', camera1.all$Week)
1542829420758:camera1.all$Week <- gsub('Week_9\\>', 'Week_09', camera1.all$Week)
1542829420820:camera2.all$Week <- gsub('Week_1\\>', 'Week_01', camera2.all$Week)
1542829420882:camera2.all$Week <- gsub('Week_2\\>', 'Week_02', camera2.all$Week)
1542829420944:camera2.all$Week <- gsub('Week_3\\>', 'Week_03', camera2.all$Week)
1542829421006:camera2.all$Week <- gsub('Week_4\\>', 'Week_04', camera2.all$Week)
1542829421069:camera2.all$Week <- gsub('Week_5\\>', 'Week_05', camera2.all$Week)
1542829421132:camera2.all$Week <- gsub('Week_6\\>', 'Week_06', camera2.all$Week)
1542829421196:camera2.all$Week <- gsub('Week_7\\>', 'Week_07', camera2.all$Week)
1542829421259:camera2.all$Week <- gsub('Week_8\\>', 'Week_08', camera2.all$Week)
1542829421380:camera2.all$Week <- gsub('Week_9\\>', 'Week_09', camera2.all$Week)
1542829421411:camera1.all
1542829434908:summary(camera1.all)
1542829435049:summary(camera2.all)
1542829441035:camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542829441049:camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542829456721:ambient.sound.url <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542829456724:download.file(ambient.sound.url, destfile = 'ambient_sound.zip')
1542829457533:unzip('ambient_sound.zip', exdir = './ambient_sound')
1542829460316:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542829460318:months <- format(ISOdate(2013,1:12,1),"%B")
1542829460323:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542829460328:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542829460333:for (i in 1:12)
1542829460335:{
1542829460337:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542829460340:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542829460495:date.i$year <- '2013'
1542829460497:date.i$month.char <- months[i]
1542829460500:if(nchar(as.character(i))==1)
1542829460502:{
1542829460606:date.i$month.num <- paste('0', i, sep='')
1542829460608:} else {
1542829460611:date.i$month.num <- i
1542829460613:}
1542829460616:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542829460620:dates.df <- rbind(dates.df, date.i)
1542829460626:date.i <- NULL
1542829460628:}
1542829460650:dates.df
1542829466004:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542829466010:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542829466015:for (i.month in 1:nrow(dates.df))
1542829466017:{
1542829466020:for (i.day in 1:dates.df$day[i.month])
1542829466022:{
1542829466026:if(nchar(as.character(i.day))==1)
1542829466028:{
1542829466030:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542829466032:} else {
1542829466034:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542829466036:}
1542829466041:if (!file.exists(sound.file)) next
1542829466044:sound.read <- read.table(sound.file)
1542829466046:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542829466049:sound.all <- rbind.data.frame(sound.all, sound.df)
1542829466054:sound.df<- NULL
1542829466056:}
1542829466058:}
1542829470642:sound.all
1542829476004:sound.tidy <- sound.all
1542829476007:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542829476141:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542829476187:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542829476223:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542829476848:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542829476972:#sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_'))
1542829476975:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542829477006:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542829477136:sound.tidy.all <- sound.tidy.summary[2:5]
1542829477147:sound.tidy.all
1542829481255:sound.split <- split(sound.tidy.all, sound.tidy.all$day.Week)
1542829519099:#sound.split <-
1542829519225:split(sound.tidy.all, sound.tidy.all$day.Week)
1542829528878:#sound.split <-
1542829528880:sound.tidy.all
1542829537690:#sound.split <-
1542829537692:sound.tidy.all$day.Week
1542829543501:#sound.split <-
1542829543504:sound.tidy.all
1542829562564:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542829562701:sound.split
1542829562916:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542829562934:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542829562941:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542829562949:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542829562956:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542829562964:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542829562971:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542829562983:sound.new <- sound.mon %>% inner_join(sound.tue, by=c('Week', 'hour')) %>% left_join(sound.wed, by=c('Week', 'hour')) %>% left_join(sound.thurs, by=c('Week', 'hour')) %>% left_join(sound.fri, by=c('Week', 'hour')) %>% left_join(sound.sat, by=c('Week', 'hour')) %>% left_join(sound.sun, by=c('Week', 'hour'))
1542829572375:sound.new
1542829666474:sound.new <- sound.mon %>% left_join(sound.tue, by=c('Week', 'hour')) %>% left_join(sound.wed, by=c('Week', 'hour')) %>% left_join(sound.thurs, by=c('Week', 'hour')) %>% left_join(sound.fri, by=c('Week', 'hour')) %>% left_join(sound.sat, by=c('Week', 'hour')) %>% left_join(sound.sun, by=c('Week', 'hour'))
1542829674532:sound.new
1542829685378:sound.mon
1542829694727:sound.tue
1542829773616:?outer
1542829785699:sound.new <- sound.mon %>% outer(sound.tue, by=c('Week', 'hour')) #%>% left_join(sound.wed, by=c('Week', 'hour')) %>% left_join(sound.thurs, by=c('Week', 'hour')) %>% left_join(sound.fri, by=c('Week', 'hour')) %>% left_join(sound.sat, by=c('Week', 'hour')) %>% left_join(sound.sun, by=c('Week', 'hour'))
1542829838753:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) #%>% left_join(sound.wed, by=c('Week', 'hour')) %>% left_join(sound.thurs, by=c('Week', 'hour')) %>% left_join(sound.fri, by=c('Week', 'hour')) %>% left_join(sound.sat, by=c('Week', 'hour')) %>% left_join(sound.sun, by=c('Week', 'hour'))
1542829841145:sound.new
1542829901921:full_join(sound.mon, sound.tue, by=c('Week', 'hour'))
1542829920681:full_join(sound.tue, sound.mon, by=c('Week', 'hour'))
1542830005036:merge(sound.mon, sound.tue, by=c('Week', 'hour'), all=TRUE)
1542830026945:sound.mon
1542830027076:sound.tue
1542830027096:merge(sound.mon, sound.tue, by=c('Week', 'hour'), all=TRUE)
1542830093220:full_join(sound.tue, sound.mon, by=c('Week', 'hour'))
1542830103594:full_join(sound.mon, sound.tue, by=c('Week', 'hour'))
1542830125936:full_join(sound.mon, sound.tue, by=c('Week', 'hour')) %>% select(Week), %>% distinct()
1542830134027:full_join(sound.mon, sound.tue, by=c('Week', 'hour')) %>% select(Week) %>% distinct()
1542830186458:?order_by
1542830210110:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour'))
1542830218215:sound.new %>% select(Week) %>% distinct()
1542830266312:sound.new %>% select(Week) %>% distinct() %>% order(Week)
1542830276798:sound.new %>% select(Week) %>% distinct() %>% order_by(Week)
1542830325653:sound.new %>% select(Week) %>% distinct() %>% arrange(Week)
1542830359035:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week)
1542830359052:sound.new
1542830379955:sound.mon
1542830420908:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% arrange(Week)
1542830420919:#%>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week)
1542830420921:sound.mon
1542830421043:sound.tue
1542830421063:sound.new
1542830447997:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) #%>% arrange(Week)
1542830494471:sound.mon
1542830494559:sound.tue
1542830494640:sound.new
1542830508482:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) #%>% arrange(Week)
1542830508498:sound.new
1542830544492:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% arrange(Week)
1542830544604:sound.new
1542830565138:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) #%>% arrange(Week)
1542830565146:sound.new
1542830609374:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% arrange(Week)
1542830609384:sound.new
1542830624800:sound.mon
1542830624925:sound.tue
1542830640200:sound.mon %>% arrange(Week)
1542830640325:sound.tue %>% arrange(Week)
1542830677865:sound.new
1542830695007:sound.mon %>% arrange(Week)
1542830695130:sound.tue %>% arrange(Week)
1542830695149:sound.new %>% arrange(Week)
1542830719916:sound.mon %>% arrange(Week, hour)
1542830720040:sound.tue %>% arrange(Week, hour)
1542830720061:sound.new %>% arrange(Week, hour)
1542830772331:sound.split
1542830796057:sound.split %>% arrange(Week, hour)
1542830813467:sound.split
1542830813640:sound.split$Monday %>% arrange(Week, hour)
1542830828169:sound.split$Tuesday %>% arrange(Week, hour)
1542830836688:sound.split$Wednesday %>% arrange(Week, hour)
1542831388415:sound.tidy <- sound.all
1542831388415:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542831388459:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542831388605:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542831388643:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542831389313:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542831389381:#sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_'))
1542831389383:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%v"), sep='_')
1542831389521:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542831389675:sound.tidy.all <- sound.tidy.summary[2:5]
1542831389675:sound.tidy.all
1542831625504:sound.tidy <- sound.all
1542831625508:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542831625687:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542831625736:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542831625773:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542831626411:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542831626433:#sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%W"), sep='_'))
1542831626436:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%v"), sep='_')
1542831626571:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542831626653:sound.tidy.all <- sound.tidy.summary[2:5]
1542831626662:sound.tidy.all
1542831639408:sound.tidy <- sound.all
1542831639411:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542831639548:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542831639693:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542831639731:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542831640356:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542831640379:#sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%W"), sep='_'))
1542831640382:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%W"), sep='_')
1542831640412:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542831640489:sound.tidy.all <- sound.tidy.summary[2:5]
1542831640497:sound.tidy.all
1542831708414:sound.tidy <- sound.all
1542831708418:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542831708452:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542831708498:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542831708540:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542831709162:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542831709235:#sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%W"), sep='_'))
1542831709237:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%G"), sep='_')
1542831709369:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542831709448:sound.tidy.all <- sound.tidy.summary[2:5]
1542831709457:sound.tidy.all
1542831737970:sound.tidy <- sound.all
1542831737973:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542831738109:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542831738154:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542831738293:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542831738966:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542831739040:#sound.tidy.summary$Week <- gsub('_0', '_', paste('Week', strftime(sound.tidy.summary$date.sound, "%W"), sep='_'))
1542831739043:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%U"), sep='_')
1542831739175:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542831739253:sound.tidy.all <- sound.tidy.summary[2:5]
1542831739261:sound.tidy.all
1542831806495:strftime(sound.tidy.summary$date.sound, "%U")
1542831812908:strftime(sound.tidy.summary$date.sound, "%W")
1542831821600:strftime(sound.tidy.summary$date.sound, "%W") -1
1542831847787:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%W"), sep='_')
1542831852851:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%W"), sep='_')
1542831852894:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542831852921:sound.tidy.all <- sound.tidy.summary[2:5]
1542831852929:sound.tidy.all
1542831890255:sound.tidy <- sound.all
1542831890258:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542831890292:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542831890335:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542831890370:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542831891025:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542831891105:#strftime(sound.tidy.summary$date.sound, "%W") -1
1542831891108:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542831891247:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542831891381:sound.tidy.all <- sound.tidy.summary[2:5]
1542831891395:sound.tidy.all
1542831927443:sound.tidy <- sound.all
1542831927447:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542831927482:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542831927527:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542831927564:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542831928165:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542831928186:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542831928266:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542831928294:sound.tidy.all <- sound.tidy.summary[2:5]
1542831928304:sound.tidy.all
1542831943908:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542831944044:sound.split
1542831944207:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542831944215:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542831944222:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542831944234:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542831944240:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542831944249:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542831944255:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542831944267:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% arrange(Week)
1542831944275:sound.new
1542831944300:#%>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week)
1542831944303:sound.mon %>% arrange(Week, hour)
1542831944323:sound.tue %>% arrange(Week, hour)
1542831944344:sound.new %>% arrange(Week, hour)
1542831995072:sound.tue %>% arrange(Week, hour)
1542832043652:sound.tidy.all %>% filter(Week=='Week_01') %>% arrange(day.week, hour)
1542832098227:sound.tidy.all %>% filter(Week=='Week_01', day.week=='Monday') %>% arrange(day.week, hour)
1542832121499:sound.tidy
1542832229218:sound.tidy.all
1542832256777:sound.tidy.all %>% arrange(Week)
1542832301913:sound.tidy.summary
1542832318789:sound.tidy <- sound.all
1542832318793:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542832318828:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542832318874:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542832319010:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542832319632:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542832319654:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542832319681:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542832319816:sound.tidy.all <- sound.tidy.summary[1:5]
1542832319869:sound.tidy.all %>% arrange(Week)
1542832319953:sound.tidy.all %>% filter(Week=='Week_01', day.week=='Monday') %>% arrange(day.week, hour)
1542833065248:sheet.names
1542833131816:sound.tidy
1542833163331:filter(sound.tidy, date.sound=='2013-01-01')
1542833180962:filter(sound.tidy, date.sound!='2013-01-01')
1542833199208:filter(sound.tidy, date.sound!='2013-01-01' & date.sound!='2013-01-02')
1542833263583:sound.tidy <- filter(sound.all, date.sound!='2013-12-29' & date.sound!='2013-12-30' & date.sound!='2013-12-31')
1542833263589:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542833263634:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542833263683:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542833263719:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542833264385:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542833264413:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542833264441:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542833264469:sound.tidy.all <- sound.tidy.summary[1:5]
1542833264573:sound.tidy.all %>% arrange(Week)
1542833264607:sound.tidy.all %>% filter(Week=='Week_01', day.week=='Monday') %>% arrange(day.week, hour)
1542833297426:sound.tidy <- filter(sound.all, date.sound!='2013-12-29' & date.sound!='2013-12-30' & date.sound!='2013-12-31')
1542833297431:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542833297568:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542833297612:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542833297653:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542833298338:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542833298415:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542833298498:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542833298577:sound.tidy.all <- sound.tidy.summary[1:5]
1542833298781:sound.tidy.all %>% arrange(Week)
1542833308739:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542833308969:sound.split
1542833309183:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542833309217:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542833309599:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542833309789:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542833309823:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542833309856:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542833309891:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542833309929:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% arrange(Week)
1542833309968:sound.new
1542833310005:#%>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week)
1542833310007:sound.mon %>% arrange(Week, hour)
1542833310034:sound.tue %>% arrange(Week, hour)
1542833310061:sound.new %>% arrange(Week, hour)
1542833369801:sound.tidy <- filter(sound.all, !(date.sound='2013-12-29' & date.sound='2013-12-30' & date.sound='2013-12-31'))
1542833411803:sound.tidy <- filter(sound.all, date.sound!='2013-01-01' & date.sound!='2013-01-02' & date.sound!='2013-01-03')
1542833411809:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542833411845:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542833411891:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542833411927:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542833412609:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542833412682:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542833412763:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542833412791:sound.tidy.all <- sound.tidy.summary[1:5]
1542833412845:sound.tidy.all %>% arrange(Week)
1542833430519:sound.tidy <- filter(sound.all, (date.sound!='2013-01-01' & date.sound!='2013-01-02' & date.sound!='2013-01-03'))
1542833430524:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542833430560:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542833430609:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542833430650:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542833431271:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542833431345:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542833431424:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542833431452:sound.tidy.all <- sound.tidy.summary[1:5]
1542833431505:sound.tidy.all %>% arrange(Week)
1542833481819:dates.df[12]
1542833490551:dates.df[,12]
1542833494581:dates.df
1542833541454:months
1542833585613:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542833585615:months <- format(ISOdate(2013,1:12,1),"%B")
1542833585620:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542833585625:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542833585630:for (i in 1:12)
1542833585632:{
1542833585635:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542833585637:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542833585641:date.i$year <- '2013'
1542833585643:date.i$month.char <- months[i]
1542833585645:if(nchar(as.character(i))==1)
1542833585647:{
1542833585649:date.i$month.num <- paste('0', i, sep='')
1542833585651:} else {
1542833585653:date.i$month.num <- i
1542833585655:}
1542833585660:if(months=='December')
1542833585662:{
1542833585665:date.i$day = 28
1542833585667:} else {
1542833585669:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542833585671:}
1542833585673:dates.df <- rbind(dates.df, date.i)
1542833585676:date.i <- NULL
1542833585678:}
1542833585703:dates.df
1542833623050:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542833623052:months <- format(ISOdate(2013,1:12,1),"%B")
1542833623057:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542833623063:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542833623068:for (i in 1:12)
1542833623070:{
1542833623072:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542833623075:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542833623181:date.i$year <- '2013'
1542833623184:date.i$month.char <- months[i]
1542833623187:if(nchar(as.character(i))==1)
1542833623189:{
1542833623191:date.i$month.num <- paste('0', i, sep='')
1542833623193:} else {
1542833623195:date.i$month.num <- i
1542833623197:}
1542833623199:if(months[i]=='December')
1542833623202:{
1542833623204:date.i$day = 28
1542833623206:} else {
1542833623208:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542833623210:}
1542833623212:dates.df <- rbind(dates.df, date.i)
1542833623215:date.i <- NULL
1542833623217:}
1542833623240:dates.df
1542833653426:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542833653431:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542833653436:for (i.month in 1:nrow(dates.df))
1542833653438:{
1542833653440:for (i.day in 1:dates.df$day[i.month])
1542833653442:{
1542833653446:if(nchar(as.character(i.day))==1)
1542833653448:{
1542833653450:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542833653453:} else {
1542833653455:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542833653457:}
1542833653462:if (!file.exists(sound.file)) next
1542833653465:sound.read <- read.table(sound.file)
1542833653467:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542833653470:sound.all <- rbind.data.frame(sound.all, sound.df)
1542833653474:sound.df<- NULL
1542833653476:}
1542833653478:}
1542833657920:sound.all
1542833666392:sound.tidy <- sound.all
1542833666396:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542833666532:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542833666574:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542833666610:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542833667208:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542833667281:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542833667358:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542833667391:sound.tidy.all <- sound.tidy.summary[1:5]
1542833667447:sound.tidy.all %>% arrange(Week)
1542833673362:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542833673588:sound.split
1542833673973:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542833674006:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542833674038:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542833674074:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542833674105:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542833674136:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542833674167:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542833674203:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% arrange(Week)
1542833674239:sound.new
1542833674275:#%>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week)
1542833674278:sound.mon %>% arrange(Week, hour)
1542833674304:sound.tue %>% arrange(Week, hour)
1542833674331:sound.new %>% arrange(Week, hour)
1542833743706:sound.tidy <- sound.all
1542833743710:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542833743743:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542833743789:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542833743827:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542833744428:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542833744452:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542833744480:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542833744509:sound.tidy.all <- sound.tidy.summary[2:5]
1542833744518:sound.tidy.all %>% arrange(Week)
1542833749956:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542833749990:sound.split
1542833750151:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542833750158:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542833750166:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542833750172:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542833750179:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542833750187:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542833750194:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542833750206:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% arrange(Week)
1542833750214:sound.new
1542833750341:#%>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week)
1542833750343:sound.mon %>% arrange(Week, hour)
1542833750364:sound.tue %>% arrange(Week, hour)
1542833750385:sound.new %>% arrange(Week, hour)
1542833787892:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542833788028:sound.split
1542833788199:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542833788206:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542833788213:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542833788220:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542833788228:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542833788236:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542833788242:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542833788254:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week, hour)
1542833788269:sound.new
1542833888306:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542833888341:sound.split
1542833888511:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542833888518:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542833888525:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542833888532:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542833888539:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542833888546:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542833888554:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542833888565:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week, hour)
1542833888582:sound.new
1542833896401:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542833896436:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542833896444:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542833896451:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542833896458:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542833896465:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542833896574:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542833896582:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542833896593:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week, hour)
1542833896612:sound.new
1542833915112:ambient.sound.url <- 'https://data.smartdublin.ie/dataset/a52fbbe2-1bff-4897-84af-34945f6fc8de/resource/30cb9275-f9fb-432a-af48-0a5f7ab462a4/download/chancerypark2013.zip'
1542833915116:download.file(ambient.sound.url, destfile = 'ambient_sound.zip')
1542833915994:unzip('ambient_sound.zip', exdir = './ambient_sound')
1542833917987:# I need to loop through all dates in the year to pull out each text file. Here I create a df of all required components
1542833917990:months <- format(ISOdate(2013,1:12,1),"%B")
1542833917995:dates.df <- data.frame(matrix(ncol = 4, nrow = 0))
1542833918000:colnames(dates.df) <- c('year', 'month.char', 'month.num', 'day')
1542833918005:for (i in 1:12)
1542833918008:{
1542833918010:date.i <- data.frame(matrix(ncol = 4, nrow = 1))
1542833918012:colnames(date.i) <- c('year', 'month.char', 'month.num', 'day')
1542833918168:date.i$year <- '2013'
1542833918171:date.i$month.char <- months[i]
1542833918174:if(nchar(as.character(i))==1)
1542833918178:{
1542833918181:date.i$month.num <- paste('0', i, sep='')
1542833918184:} else {
1542833918189:date.i$month.num <- i
1542833918192:}
1542833918203:if(months[i]=='December')
1542833918205:{
1542833918207:date.i$day = 28 #the last 3 days of the year are excluded from the footfall dataset
1542833918210:} else {
1542833918212:date.i$day <- as.Date(paste('2013','-', i ,'-01', sep=''), '%Y-%m-%d') %>% days_in_month()
1542833918214:}
1542833918217:dates.df <- rbind(dates.df, date.i)
1542833918221:date.i <- NULL
1542833918223:}
1542833922737:sound.all <- data.frame(matrix(ncol = 4, nrow = 0))
1542833922743:colnames(sound.all) <- c('week', 'day.week', 'hour', 'mean.noise.level')
1542833922748:for (i.month in 1:nrow(dates.df))
1542833922750:{
1542833922752:for (i.day in 1:dates.df$day[i.month])
1542833922755:{
1542833922758:if(nchar(as.character(i.day))==1)
1542833922760:{
1542833922763:sound.file <- paste('ambient_sound/',dates.df$year[i.month], '/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-0', i.day, 'T00-00-00.txt', sep='')
1542833922764:} else {
1542833922767:sound.file <- paste('ambient_sound/2013/', dates.df$month.char[i.month], '/DCC-NOISE-001011-2013-', dates.df$month.num[i.month], '-', i.day, 'T00-00-00.txt', sep='')
1542833922769:}
1542833922775:if (!file.exists(sound.file)) next
1542833922777:sound.read <- read.table(sound.file)
1542833922779:sound.df <- sound.read %>% select(date.sound=V1, time=V2, noise.level=V3)
1542833922782:sound.all <- rbind.data.frame(sound.all, sound.df)
1542833922786:sound.df<- NULL
1542833922788:}
1542833922790:}
1542833934081:sound.tidy <- sound.all
1542833934084:sound.tidy$time <-  gsub(",","", sound.tidy$time)
1542833934219:sound.tidy$noise.level <-  as.numeric(gsub(",","", sound.tidy$noise.level))
1542833934263:sound.tidy$date.sound <-  as.Date(sound.tidy$date.sound, format='%d/%m/%Y')
1542833934298:sound.tidy$hour <- format(strptime(sound.tidy$time,format='%H:%M:%S'), "%k")
1542833935009:sound.tidy.summary <- sound.tidy %>% group_by(date.sound, hour) %>% summarise(mean.noise.level=mean(noise.level))
1542833935184:sound.tidy.summary$Week <- paste('Week', strftime(sound.tidy.summary$date.sound, "%V"), sep='_')
1542833935261:sound.tidy.summary$day.week <- format(as.Date(sound.tidy.summary$date.sound), "%A")
1542833935339:sound.tidy.all <- sound.tidy.summary[2:5]
1542833937927:sound.split <- split(sound.tidy.all, sound.tidy.all$day.week)
1542833938114:sound.mon <- sound.split$Monday %>% select(., Week, hour, mon.noise=mean.noise.level)
1542833938122:sound.tue <- sound.split$Tuesday %>% select(Week, hour, tue.noise=mean.noise.level)
1542833938129:sound.wed <- sound.split$Wednesday %>% select(Week, hour, wed.noise=mean.noise.level)
1542833938292:sound.thurs <- sound.split$Thursday %>% select(Week, hour, thurs.noise=mean.noise.level)
1542833938300:sound.fri <- sound.split$Friday %>% select(Week, hour, fri.noise=mean.noise.level)
1542833938307:sound.sat <- sound.split$Saturday %>% select(Week, hour, sat.noise=mean.noise.level)
1542833938316:sound.sun <- sound.split$Sunday %>% select(Week, hour, sun.noise=mean.noise.level)
1542833938328:sound.new <- sound.mon %>% full_join(sound.tue, by=c('Week', 'hour')) %>% full_join(sound.wed, by=c('Week', 'hour')) %>% full_join(sound.thurs, by=c('Week', 'hour')) %>% full_join(sound.fri, by=c('Week', 'hour')) %>% full_join(sound.sat, by=c('Week', 'hour')) %>% full_join(sound.sun, by=c('Week', 'hour')) %>% arrange(Week, hour)
1542833938344:sound.new
1542834351634:camera1.sum.week <- camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542834351648:camera2.sum.week <- camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542834351763:colSums(camera1.sum.week[Mon.In:Sun.Out], na.rm = TRUE)
1542834363190:camera1.sum.week <- camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542834363304:camera2.sum.week <- camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542834363318:colSums(camera1.sum.week['Mon.In':'Sun.Out'], na.rm = TRUE)
1542834376624:camera1.sum.week['Mon.In':'Sun.Out']
1542834388284:camera1.sum.week <- camera1.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542834388398:camera2.sum.week <- camera2.all %>% group_by(Week) %>% summarise_if(., is.numeric, sum)
1542834388411:camera1.sum.week
1542834388423:camera1.sum.week['Mon.In':'Sun.Out']
1542834412380:camera1.sum.week[2:15]
1542834455156:colSums(camera1.sum.week[2:15], na.rm = TRUE)
1542834470664:rowSums(camera1.sum.week[2:15], na.rm = TRUE)
1542834618097:sum(camera1.sum.week[2:15])
1542834676561:camera1.sum.week
1542834687896:camera1.sum.week %>% group_by(Week) %>% mutate(sum())
1542834694213:camera1.sum.week %>% group_by(Week) %>% mutate(x=sum())
1542913369252:x<-1542545075124
1542913369270:as.POSIXct(Sys.Date())+x/1000
1542913369289:#[1] "2013-03-07 16:01:59 PST" "2013-03-07 16:04:06 PST" "2013-03-07 16:04:27 PST"
1542913369298:format( as.POSIXct(Sys.Date())+x/1000, "%M:%S")
1542913369317:#[1] "01:59" "04:06" "04:27"
