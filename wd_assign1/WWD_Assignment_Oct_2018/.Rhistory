summary(aov.anx.fatigue)
round(summary(aov.anx.fatigue)[[1]][1,2]/summary(aov.anx.fatigue)[[1]][2,2], 3)
sleep.survey.full <- as.data.frame(read.spss("sleep5ED.sav")) #read in the dataset
sleep.survey<-select(sleep.survey.full, id, anxiety, trubslep, trubstay, qualslp, ess, fatigue, depress) #select variables of interest
panderOptions('table.split.table', Inf)
var.desc <- "
Concept                             |Variable Name |Statistical Type  | Possible Values
Anxiety Level                       |anxiety       |Scale             | Range from 0=no anxiety to 21=severe anxiety
Trouble falling asleep?             |trubslep      |Nominal           | 1=yes 2=no
Trouble staying asleep?             |trubstay      |Nominal           | 1=yes 2=no
Quality of Sleep                    |qualslp       |Ordinal           | 1=very poor, 2=poor, 3=fair, 4=good, 5=very good, 6=excellent
Sleepiness Level                    |ess           |Scale             | Range from 0=low to 24=high daytime sleepiness
Rate level of fatigue over last week|fatigue       |Ordinal           | 1=not at all 10=to a great extent
Depression Level                    |depress       |Scale             | Range from 0=no depression to 21=severe depression
"
var.desc.df <- read.delim(textConnection(var.desc),header=FALSE,sep="|",strip.white=TRUE,stringsAsFactors=FALSE)
names(var.desc.df) <- unname(as.list(var.desc.df[1,])) # put headers on
var.desc.df <- var.desc.df[-1,] # remove first row
row.names(var.desc.df)<-NULL
pander(var.desc.df, style = 'rmarkdown')
len.tot <- count(sleep.survey)[[1]] #number of surveys
bar <- ggplot(sleep.survey, aes(fatigue, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "Black") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Level of Fatigue", y = "HADS Anxiety Score", title="Figure 14: Anxiety Level by Fatigue Felt in Previous Month")
detach("package:knitr", unload=TRUE)
knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE)
len.tot <- count(sleep.survey)[[1]] #number of surveys
?count
??count
library(dplyr)
#library(foreign)
#library(car)
#library(gmodels)
#library(pander)
#library(ggplot2)
#library(psych)
#library(semTools)
#library(plyr)
#library(userfriendlyscience)
#library(knitr)
sleep.survey.full <- as.data.frame(read.spss("sleep5ED.sav")) #read in the dataset
library(foreign)
library(dplyr)
#library(car)
#library(gmodels)
#library(pander)
#library(ggplot2)
#library(psych)
#library(semTools)
#library(plyr)
#library(userfriendlyscience)
#library(knitr)
sleep.survey.full <- as.data.frame(read.spss("sleep5ED.sav")) #read in the dataset
sleep.survey<-select(sleep.survey.full, id, anxiety, trubslep, trubstay, qualslp, ess, fatigue, depress) #select variables of interest
panderOptions('table.split.table', Inf)
library(foreign)
library(dplyr)
library(pander)
#library(car)
#library(gmodels)
#library(ggplot2)
#library(psych)
#library(semTools)
#library(plyr)
#library(userfriendlyscience)
#library(knitr)
sleep.survey.full <- as.data.frame(read.spss("sleep5ED.sav")) #read in the dataset
sleep.survey<-select(sleep.survey.full, id, anxiety, trubslep, trubstay, qualslp, ess, fatigue, depress) #select variables of interest
panderOptions('table.split.table', Inf)
var.desc <- "
Concept                             |Variable Name |Statistical Type  | Possible Values
Anxiety Level                       |anxiety       |Scale             | Range from 0=no anxiety to 21=severe anxiety
Trouble falling asleep?             |trubslep      |Nominal           | 1=yes 2=no
Trouble staying asleep?             |trubstay      |Nominal           | 1=yes 2=no
Quality of Sleep                    |qualslp       |Ordinal           | 1=very poor, 2=poor, 3=fair, 4=good, 5=very good, 6=excellent
Sleepiness Level                    |ess           |Scale             | Range from 0=low to 24=high daytime sleepiness
Rate level of fatigue over last week|fatigue       |Ordinal           | 1=not at all 10=to a great extent
Depression Level                    |depress       |Scale             | Range from 0=no depression to 21=severe depression
"
var.desc.df <- read.delim(textConnection(var.desc),header=FALSE,sep="|",strip.white=TRUE,stringsAsFactors=FALSE)
names(var.desc.df) <- unname(as.list(var.desc.df[1,])) # put headers on
var.desc.df <- var.desc.df[-1,] # remove first row
row.names(var.desc.df)<-NULL
pander(var.desc.df, style = 'rmarkdown')
len.tot <- count(sleep.survey)[[1]] #number of surveys
num.na.anxiety <- sum(is.na(sleep.survey$anxiety)) #number of null values in anxiety
num.anx <- len.tot - num.na.anxiety #number of non-null values in anxiety
range.anx <- range(sleep.survey$anxiety, na.rm = TRUE) #range of anxiety values excluding nulls
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
library(foreign)
library(dplyr)
library(pander)
library(ggplot2)
#library(car)
#library(gmodels)
#library(psych)
#library(semTools)
#library(plyr)
#library(userfriendlyscience)
#library(knitr)
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$anxiety))
gg <- gg + labs(x="HADS Anxiety Level")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$anxiety, na.rm=TRUE), sd=sd(sleep.survey$anxiety, na.rm=TRUE)))
gg+ggtitle('Figure 1: Distribution HADS Anxiety')
qqnorm(sleep.survey$anxiety, main="Figure 2: QQPlot of HADS Anxiety Score")
qqline(sleep.survey$anxiety, col=2)
tpskew.anx<-semTools::skew(sleep.survey$anxiety)
tpkurt.anx<-semTools::kurtosis(sleep.survey$anxiety)
scale.anx <-  scale(sleep.survey$anxiety)
range.scale.anx <- round(range(scale.anx, na.rm = TRUE), 2)
hist(scale.anx, breaks = 30, col='mediumorchid2', xlim=range(-3.35, 3.35), xlab='Scaled Anxiety Score', main='Figure 3: Histogram of Scaled Anxiety Score')
abline(v=c(-3.29, 3.29), col='red', lwd = 2)
num.trubslep <- summary(sleep.survey$trubslep)
perc.trubslep <- round(100*num.trubslep/len.tot, 2)
table.trubslep <- rbind(num.trubslep, perc.trubslep)
plot(sleep.survey$trubslep, main='Figure 4: Histogram of Trouble Falling Asleep', col='mediumorchid2', xlab='Trouble Falling Asleep', ylab='Number of Responses')
psych::describeBy(sleep.survey$anxiety, sleep.survey$trubslep)
num.trubstay <- summary(sleep.survey$trubstay)
perc.trubstay <- round(100*num.trubstay/len.tot, 2)
table.trubstay <- rbind(num.trubstay, perc.trubstay)
plot(sleep.survey$trubstay, main='Figure 6: Histogram of Trouble Staying Asleep', col='mediumorchid2', xlab='Trouble Staying Asleep', ylab='Number of Responses')
psych::describeBy(sleep.survey$anxiety, sleep.survey$trubstay)
bar <- ggplot(sleep.survey, aes(trubstay, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "mediumorchid2") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Trouble Falling Asleep", y = "HADS Anxiety Score", title="Figure 7: Anxiety Level by Trouble Staying Asleep")
num.qual <- summary(sleep.survey$qualslp)
perc.qual <- round(100*num.qual/len.tot, 2)
table.qual <- rbind(num.qual, perc.qual)
table.qual
plot(sleep.survey$qualslp, main='Figure 8: Histogram of Quality of Sleep', col='mediumorchid2', xlab='Reported Quality of Sleep', ylab='Number of Responses')
desc.anx.qual <- psych::describeBy(sleep.survey$anxiety, sleep.survey$qualslp)
desc.anx.qual
bar <- ggplot(sleep.survey, aes(qualslp, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "Black") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Quality of Sleep", y = "HADS Anxiety Score", title="Figure 9: Anxiety Level by Quality of Sleep")
num.na.ess <- sum(is.na(sleep.survey$ess))
num.ess <- len.tot - num.na.ess
range.ess <- range(sleep.survey$ess, na.rm = TRUE)
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$ess))
gg <- gg + labs(x="Epworth Sleepiness Scale")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$ess, na.rm=TRUE), sd=sd(sleep.survey$ess, na.rm=TRUE)))
gg+ggtitle('Figure 10: Distribution Epworth Sleepiness Scale')
qqnorm(sleep.survey$ess, main="Figure 11: QQPlot of Epworth Sleepiness Scale")
qqline(sleep.survey$ess, col=2)
tpskew.ess<-semTools::skew(sleep.survey$ess)
tpkurt.ess<-semTools::kurtosis(sleep.survey$ess)
scale.ess <-  scale(sleep.survey$ess)
range.scale.ess <- round(range(scale.ess, na.rm = TRUE), 2)
hist(scale.ess, breaks = 20, col='mediumorchid2', xlim=range(-3.35, 3.35), xlab='Scaled ESS Score', main='Figure 12: Histogram of Scaled ESS Score')
abline(v=c(-3.29, 3.29), col='red', lwd = 2)
is.na.fatigue <- sum(is.na(sleep.survey$fatigue)) #number of NAs
sum.fatigue <- sleep.survey %>% count(fatigue) #Number of each response
hist(sleep.survey$fatigue, breaks = 10, col='mediumorchid2', xlab='Fatigue felt in previous Month', main='Figure 13: Histogram of Fatigue felt in Previous Month', ylab='Number of Responses')
desc.anx.fatigue <- psych::describeBy(sleep.survey$anxiety, sleep.survey$fatigue)
desc.anx.fatigue
bar <- ggplot(sleep.survey, aes(fatigue, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "Black") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Level of Fatigue", y = "HADS Anxiety Score", title="Figure 14: Anxiety Level by Fatigue Felt in Previous Month")
num.na.depress <- sum(is.na(sleep.survey$depress))
num.depress <- len.tot - num.na.depress
range.depress <- range(sleep.survey$depress, na.rm = TRUE)
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$depress))
gg <- gg + labs(x="Epworth Sleepiness Scale")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$depress, na.rm=TRUE), sd=sd(sleep.survey$depress, na.rm=TRUE)))
gg+ggtitle('Figure 15: Distribution HADS Depression')
qqnorm(sleep.survey$depress, main="Figure 16: QQPlot of HADS Depression Score")
qqline(sleep.survey$depress, col=2)
tpskew.depress<-semTools::skew(sleep.survey$depress)
tpkurt.depress<-semTools::kurtosis(sleep.survey$depress)
library(foreign)
library(dplyr)
library(pander)
library(ggplot2)
library(psych)
library(semTools)
#library(car)
#library(gmodels)
#library(plyr)
#library(userfriendlyscience)
#library(knitr)
knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE)
sleep.survey.full <- as.data.frame(read.spss("sleep5ED.sav")) #read in the dataset
sleep.survey<-select(sleep.survey.full, id, anxiety, trubslep, trubstay, qualslp, ess, fatigue, depress) #select variables of interest
panderOptions('table.split.table', Inf)
var.desc <- "
Concept                             |Variable Name |Statistical Type  | Possible Values
Anxiety Level                       |anxiety       |Scale             | Range from 0=no anxiety to 21=severe anxiety
Trouble falling asleep?             |trubslep      |Nominal           | 1=yes 2=no
Trouble staying asleep?             |trubstay      |Nominal           | 1=yes 2=no
Quality of Sleep                    |qualslp       |Ordinal           | 1=very poor, 2=poor, 3=fair, 4=good, 5=very good, 6=excellent
Sleepiness Level                    |ess           |Scale             | Range from 0=low to 24=high daytime sleepiness
Rate level of fatigue over last week|fatigue       |Ordinal           | 1=not at all 10=to a great extent
Depression Level                    |depress       |Scale             | Range from 0=no depression to 21=severe depression
"
var.desc.df <- read.delim(textConnection(var.desc),header=FALSE,sep="|",strip.white=TRUE,stringsAsFactors=FALSE)
names(var.desc.df) <- unname(as.list(var.desc.df[1,])) # put headers on
var.desc.df <- var.desc.df[-1,] # remove first row
row.names(var.desc.df)<-NULL
pander(var.desc.df, style = 'rmarkdown')
len.tot <- count(sleep.survey)[[1]] #number of surveys
num.na.anxiety <- sum(is.na(sleep.survey$anxiety)) #number of null values in anxiety
num.anx <- len.tot - num.na.anxiety #number of non-null values in anxiety
range.anx <- range(sleep.survey$anxiety, na.rm = TRUE) #range of anxiety values excluding nulls
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$anxiety))
gg <- gg + labs(x="HADS Anxiety Level")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$anxiety, na.rm=TRUE), sd=sd(sleep.survey$anxiety, na.rm=TRUE)))
gg+ggtitle('Figure 1: Distribution HADS Anxiety')
qqnorm(sleep.survey$anxiety, main="Figure 2: QQPlot of HADS Anxiety Score")
qqline(sleep.survey$anxiety, col=2)
tpskew.anx<-semTools::skew(sleep.survey$anxiety)
tpkurt.anx<-semTools::kurtosis(sleep.survey$anxiety)
scale.anx <-  scale(sleep.survey$anxiety)
range.scale.anx <- round(range(scale.anx, na.rm = TRUE), 2)
hist(scale.anx, breaks = 30, col='mediumorchid2', xlim=range(-3.35, 3.35), xlab='Scaled Anxiety Score', main='Figure 3: Histogram of Scaled Anxiety Score')
abline(v=c(-3.29, 3.29), col='red', lwd = 2)
num.trubslep <- summary(sleep.survey$trubslep)
perc.trubslep <- round(100*num.trubslep/len.tot, 2)
table.trubslep <- rbind(num.trubslep, perc.trubslep)
plot(sleep.survey$trubslep, main='Figure 4: Histogram of Trouble Falling Asleep', col='mediumorchid2', xlab='Trouble Falling Asleep', ylab='Number of Responses')
psych::describeBy(sleep.survey$anxiety, sleep.survey$trubslep)
bar <- ggplot(sleep.survey, aes(trubslep, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "mediumorchid2") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Trouble Falling Asleep", y = "HADS Anxiety Score", title="Figure 5: Anxiety Level by Trouble Falling Asleep")
num.trubstay <- summary(sleep.survey$trubstay)
perc.trubstay <- round(100*num.trubstay/len.tot, 2)
table.trubstay <- rbind(num.trubstay, perc.trubstay)
plot(sleep.survey$trubstay, main='Figure 6: Histogram of Trouble Staying Asleep', col='mediumorchid2', xlab='Trouble Staying Asleep', ylab='Number of Responses')
psych::describeBy(sleep.survey$anxiety, sleep.survey$trubstay)
bar <- ggplot(sleep.survey, aes(trubstay, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "mediumorchid2") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Trouble Falling Asleep", y = "HADS Anxiety Score", title="Figure 7: Anxiety Level by Trouble Staying Asleep")
num.qual <- summary(sleep.survey$qualslp)
perc.qual <- round(100*num.qual/len.tot, 2)
table.qual <- rbind(num.qual, perc.qual)
table.qual
plot(sleep.survey$qualslp, main='Figure 8: Histogram of Quality of Sleep', col='mediumorchid2', xlab='Reported Quality of Sleep', ylab='Number of Responses')
desc.anx.qual <- psych::describeBy(sleep.survey$anxiety, sleep.survey$qualslp)
desc.anx.qual
bar <- ggplot(sleep.survey, aes(qualslp, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "Black") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Quality of Sleep", y = "HADS Anxiety Score", title="Figure 9: Anxiety Level by Quality of Sleep")
num.na.ess <- sum(is.na(sleep.survey$ess))
num.ess <- len.tot - num.na.ess
range.ess <- range(sleep.survey$ess, na.rm = TRUE)
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$ess))
gg <- gg + labs(x="Epworth Sleepiness Scale")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$ess, na.rm=TRUE), sd=sd(sleep.survey$ess, na.rm=TRUE)))
gg+ggtitle('Figure 10: Distribution Epworth Sleepiness Scale')
qqnorm(sleep.survey$ess, main="Figure 11: QQPlot of Epworth Sleepiness Scale")
qqline(sleep.survey$ess, col=2)
tpskew.ess<-semTools::skew(sleep.survey$ess)
tpkurt.ess<-semTools::kurtosis(sleep.survey$ess)
scale.ess <-  scale(sleep.survey$ess)
range.scale.ess <- round(range(scale.ess, na.rm = TRUE), 2)
hist(scale.ess, breaks = 20, col='mediumorchid2', xlim=range(-3.35, 3.35), xlab='Scaled ESS Score', main='Figure 12: Histogram of Scaled ESS Score')
abline(v=c(-3.29, 3.29), col='red', lwd = 2)
is.na.fatigue <- sum(is.na(sleep.survey$fatigue)) #number of NAs
sum.fatigue <- sleep.survey %>% count(fatigue) #Number of each response
hist(sleep.survey$fatigue, breaks = 10, col='mediumorchid2', xlab='Fatigue felt in previous Month', main='Figure 13: Histogram of Fatigue felt in Previous Month', ylab='Number of Responses')
desc.anx.fatigue <- psych::describeBy(sleep.survey$anxiety, sleep.survey$fatigue)
desc.anx.fatigue
bar <- ggplot(sleep.survey, aes(fatigue, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "Black") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Level of Fatigue", y = "HADS Anxiety Score", title="Figure 14: Anxiety Level by Fatigue Felt in Previous Month")
num.na.depress <- sum(is.na(sleep.survey$depress))
num.depress <- len.tot - num.na.depress
range.depress <- range(sleep.survey$depress, na.rm = TRUE)
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$depress))
gg <- gg + labs(x="Epworth Sleepiness Scale")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$depress, na.rm=TRUE), sd=sd(sleep.survey$depress, na.rm=TRUE)))
gg+ggtitle('Figure 15: Distribution HADS Depression')
qqnorm(sleep.survey$depress, main="Figure 16: QQPlot of HADS Depression Score")
qqline(sleep.survey$depress, col=2)
tpskew.depress<-semTools::skew(sleep.survey$depress)
tpkurt.depress<-semTools::kurtosis(sleep.survey$depress)
scale.depress <-  scale(sleep.survey$depress)
range.scale.depress <- round(range(scale.depress, na.rm = TRUE), 2)
hist(scale.depress, breaks = 20, col='mediumorchid2', xlim=range(-3.35, 3.35), xlab='Scaled HADS Depression Score', main='Figure 17: Histogram of Scaled HADS Depression  Score')
abline(v=c(-3.29, 3.29), col='red', lwd = 2)
lev.anx.fall <- leveneTest(anxiety ~ trubslep, data = sleep.survey)
??leveneTest
library(foreign)
library(dplyr)
library(pander)
library(ggplot2)
library(psych)
library(semTools)
library(car)
#library(gmodels)
#library(plyr)
#library(userfriendlyscience)
#library(knitr)
knitr::opts_chunk$set(echo = TRUE, include=TRUE, warning=FALSE)
sleep.survey.full <- as.data.frame(read.spss("sleep5ED.sav")) #read in the dataset
sleep.survey<-select(sleep.survey.full, id, anxiety, trubslep, trubstay, qualslp, ess, fatigue, depress) #select variables of interest
panderOptions('table.split.table', Inf)
var.desc <- "
Concept                             |Variable Name |Statistical Type  | Possible Values
Anxiety Level                       |anxiety       |Scale             | Range from 0=no anxiety to 21=severe anxiety
Trouble falling asleep?             |trubslep      |Nominal           | 1=yes 2=no
Trouble staying asleep?             |trubstay      |Nominal           | 1=yes 2=no
Quality of Sleep                    |qualslp       |Ordinal           | 1=very poor, 2=poor, 3=fair, 4=good, 5=very good, 6=excellent
Sleepiness Level                    |ess           |Scale             | Range from 0=low to 24=high daytime sleepiness
Rate level of fatigue over last week|fatigue       |Ordinal           | 1=not at all 10=to a great extent
Depression Level                    |depress       |Scale             | Range from 0=no depression to 21=severe depression
"
var.desc.df <- read.delim(textConnection(var.desc),header=FALSE,sep="|",strip.white=TRUE,stringsAsFactors=FALSE)
names(var.desc.df) <- unname(as.list(var.desc.df[1,])) # put headers on
var.desc.df <- var.desc.df[-1,] # remove first row
row.names(var.desc.df)<-NULL
pander(var.desc.df, style = 'rmarkdown')
len.tot <- count(sleep.survey)[[1]] #number of surveys
num.na.anxiety <- sum(is.na(sleep.survey$anxiety)) #number of null values in anxiety
num.anx <- len.tot - num.na.anxiety #number of non-null values in anxiety
range.anx <- range(sleep.survey$anxiety, na.rm = TRUE) #range of anxiety values excluding nulls
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$anxiety))
gg <- gg + labs(x="HADS Anxiety Level")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$anxiety, na.rm=TRUE), sd=sd(sleep.survey$anxiety, na.rm=TRUE)))
gg+ggtitle('Figure 1: Distribution HADS Anxiety')
qqnorm(sleep.survey$anxiety, main="Figure 2: QQPlot of HADS Anxiety Score")
qqline(sleep.survey$anxiety, col=2)
tpskew.anx<-semTools::skew(sleep.survey$anxiety)
tpkurt.anx<-semTools::kurtosis(sleep.survey$anxiety)
scale.anx <-  scale(sleep.survey$anxiety)
range.scale.anx <- round(range(scale.anx, na.rm = TRUE), 2)
hist(scale.anx, breaks = 30, col='mediumorchid2', xlim=range(-3.35, 3.35), xlab='Scaled Anxiety Score', main='Figure 3: Histogram of Scaled Anxiety Score')
abline(v=c(-3.29, 3.29), col='red', lwd = 2)
num.trubslep <- summary(sleep.survey$trubslep)
perc.trubslep <- round(100*num.trubslep/len.tot, 2)
table.trubslep <- rbind(num.trubslep, perc.trubslep)
plot(sleep.survey$trubslep, main='Figure 4: Histogram of Trouble Falling Asleep', col='mediumorchid2', xlab='Trouble Falling Asleep', ylab='Number of Responses')
psych::describeBy(sleep.survey$anxiety, sleep.survey$trubslep)
bar <- ggplot(sleep.survey, aes(trubslep, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "mediumorchid2") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Trouble Falling Asleep", y = "HADS Anxiety Score", title="Figure 5: Anxiety Level by Trouble Falling Asleep")
num.trubstay <- summary(sleep.survey$trubstay)
perc.trubstay <- round(100*num.trubstay/len.tot, 2)
table.trubstay <- rbind(num.trubstay, perc.trubstay)
plot(sleep.survey$trubstay, main='Figure 6: Histogram of Trouble Staying Asleep', col='mediumorchid2', xlab='Trouble Staying Asleep', ylab='Number of Responses')
psych::describeBy(sleep.survey$anxiety, sleep.survey$trubstay)
bar <- ggplot(sleep.survey, aes(trubstay, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "mediumorchid2") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Trouble Falling Asleep", y = "HADS Anxiety Score", title="Figure 7: Anxiety Level by Trouble Staying Asleep")
num.qual <- summary(sleep.survey$qualslp)
perc.qual <- round(100*num.qual/len.tot, 2)
table.qual <- rbind(num.qual, perc.qual)
table.qual
plot(sleep.survey$qualslp, main='Figure 8: Histogram of Quality of Sleep', col='mediumorchid2', xlab='Reported Quality of Sleep', ylab='Number of Responses')
desc.anx.qual <- psych::describeBy(sleep.survey$anxiety, sleep.survey$qualslp)
desc.anx.qual
bar <- ggplot(sleep.survey, aes(qualslp, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "Black") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Quality of Sleep", y = "HADS Anxiety Score", title="Figure 9: Anxiety Level by Quality of Sleep")
num.na.ess <- sum(is.na(sleep.survey$ess))
num.ess <- len.tot - num.na.ess
range.ess <- range(sleep.survey$ess, na.rm = TRUE)
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$ess))
gg <- gg + labs(x="Epworth Sleepiness Scale")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$ess, na.rm=TRUE), sd=sd(sleep.survey$ess, na.rm=TRUE)))
gg+ggtitle('Figure 10: Distribution Epworth Sleepiness Scale')
qqnorm(sleep.survey$ess, main="Figure 11: QQPlot of Epworth Sleepiness Scale")
qqline(sleep.survey$ess, col=2)
tpskew.ess<-semTools::skew(sleep.survey$ess)
tpkurt.ess<-semTools::kurtosis(sleep.survey$ess)
scale.ess <-  scale(sleep.survey$ess)
range.scale.ess <- round(range(scale.ess, na.rm = TRUE), 2)
hist(scale.ess, breaks = 20, col='mediumorchid2', xlim=range(-3.35, 3.35), xlab='Scaled ESS Score', main='Figure 12: Histogram of Scaled ESS Score')
abline(v=c(-3.29, 3.29), col='red', lwd = 2)
is.na.fatigue <- sum(is.na(sleep.survey$fatigue)) #number of NAs
sum.fatigue <- sleep.survey %>% count(fatigue) #Number of each response
hist(sleep.survey$fatigue, breaks = 10, col='mediumorchid2', xlab='Fatigue felt in previous Month', main='Figure 13: Histogram of Fatigue felt in Previous Month', ylab='Number of Responses')
desc.anx.fatigue <- psych::describeBy(sleep.survey$anxiety, sleep.survey$fatigue)
desc.anx.fatigue
bar <- ggplot(sleep.survey, aes(fatigue, anxiety))
bar + stat_summary(fun.y = mean, geom = "bar", fill = "mediumorchid2", colour = "Black") + stat_summary(fun.data = mean_cl_normal, geom = "pointrange") + labs(x = "Level of Fatigue", y = "HADS Anxiety Score", title="Figure 14: Anxiety Level by Fatigue Felt in Previous Month")
num.na.depress <- sum(is.na(sleep.survey$depress))
num.depress <- len.tot - num.na.depress
range.depress <- range(sleep.survey$depress, na.rm = TRUE)
theme_update(plot.title = element_text(hjust = 0.5, face="bold"))
gg <- ggplot(sleep.survey, aes(x=sleep.survey$depress))
gg <- gg + labs(x="Epworth Sleepiness Scale")
gg <- gg + geom_histogram(binwidth=1, colour="black", aes(y=..density.., fill=..count..))
gg <- gg + scale_fill_gradient("Count", low="gray96", high="darkviolet")
gg <- gg + stat_function(fun=dnorm, color="red", size=1, args=list(mean=mean(sleep.survey$depress, na.rm=TRUE), sd=sd(sleep.survey$depress, na.rm=TRUE)))
gg+ggtitle('Figure 15: Distribution HADS Depression')
qqnorm(sleep.survey$depress, main="Figure 16: QQPlot of HADS Depression Score")
qqline(sleep.survey$depress, col=2)
tpskew.depress<-semTools::skew(sleep.survey$depress)
tpkurt.depress<-semTools::kurtosis(sleep.survey$depress)
scale.depress <-  scale(sleep.survey$depress)
range.scale.depress <- round(range(scale.depress, na.rm = TRUE), 2)
hist(scale.depress, breaks = 20, col='mediumorchid2', xlim=range(-3.35, 3.35), xlab='Scaled HADS Depression Score', main='Figure 17: Histogram of Scaled HADS Depression  Score')
abline(v=c(-3.29, 3.29), col='red', lwd = 2)
lev.anx.fall <- leveneTest(anxiety ~ trubslep, data = sleep.survey)
lev.anx.fall
ttest.anx.fall <- t.test(anxiety ~ trubslep, var.equal = FALSE, data = sleep.survey, paired = FALSE)
ttest.anx.fall
d.fall <-  2*ttest.anx.fall[[1]]/sqrt(ttest.anx.fall[[2]]) #Cohen's d
lev.anx.stay <- leveneTest(anxiety ~ trubstay, data = sleep.survey)
lev.anx.stay
ttest.anx.stay <- t.test(anxiety ~ trubstay, var.equal = TRUE, data = sleep.survey, paired = FALSE)
ttest.anx.stay
d.stay <-  2*ttest.anx.stay[[1]]/sqrt(ttest.anx.stay[[2]])
aov.anx.qual <- aov(sleep.survey$anxiety ~ sleep.survey$qualslp, data = sleep.survey)
summary(aov.anx.qual)
bar.anx.qual <- bartlett.test(sleep.survey$anxiety, sleep.survey$qualslp)
bar.anx.qual
posthoc.qual <- oneway(x = sleep.survey$qualslp, y = sleep.survey$anxiety, posthoc = 'Tukey')
library(foreign)
library(dplyr)
library(pander)
library(ggplot2)
library(psych)
library(semTools)
library(car)
library(userfriendlyscience)
#library(gmodels)
#library(plyr)
#library(knitr)
knitr::opts_chunk$set(echo = TRUE)
prop_read <- read_tsv('dublin property trends.txt')
library('ggplot2')
library('rnoaa')
employ_read <- read_delim('dublin employment trends.txt', ':')
knitr::opts_chunk$set(echo = TRUE)
library('ggplot2')
library('rnoaa')
employ_read <- read_delim('dublin employment trends.txt', ':')
?read.delim
library('utils')
library('ggplot2')
library('rnoaa')
employ_read <- read_delim('dublin employment trends.txt', ':')
?read.delim
employ_read <- read.delim('dublin employment trends.txt', ':')
?read_delim
??read_delim
library('readr')
library('ggplot2')
library('rnoaa')
employ_read <- read_delim('dublin employment trends.txt', ':')
qplot(data = employ_read , x = Time , y = Employment, geom = 'line', xlab = "Quarterly Figures", ylab = "Trend", main = "Dublin Employment Trends Per Sector: 2006???2016") + facet_grid ( .~ Sector)
employ.read <- read_delim('dublin employment trends.txt', ':')
qplot(data = employ.read , x = Time , y = Employment, geom = 'line', xlab = "Quarterly Figures", ylab = "Trend", main = "Dublin Employment Trends Per Sector: 2006???2016") + facet_grid ( .~ Sector)
prop.read <- read_tsv('dublin property trends.txt')
qplot(data = prop.read , x = Time , y = Trend, geom = 'line', colour = Category, xlab = "Time", ylab = "Trend", main = "Dublin Property Trends: 2007 - 2016")
library('httr')
library('plyr')
library('jsonlite')
stations <- GET('https://api.jcdecaux.com/vls/v1/stations?apiKey=174980a157364085f718726daecb380b7aeaf5b4')
http_type(stations)
stations.df <- jsonlite::fromJSON(content(stations, "text"), simplifyVector = TRUE)
count(stations.df, vars = 'contract_name')
?qplot
qplot(bike_stands, available_bike_stands, bike.df)
bike <- GET('https://api.jcdecaux.com/vls/v1/stations?contract=Dublin&apiKey=174980a157364085f718726daecb380b7aeaf5b4')
http_type(bike)
bike.df <- jsonlite::fromJSON(content(bike, "text"), simplifyVector = TRUE)
bike.df
qplot(bike_stands, available_bike_stands, bike.df)
str(bike.df)
qplot(bike_stands, available_bike_stands,data = bike.df)
qplot(bike_stands, available_bike_stands, status, data = bike.df)
qplot(bike_stands, name, data = bike.df)
qplot(bike_stands, name, data = bike.df, colour = available_bike_stands)
bike <- GET('https://api.jcdecaux.com/vls/v1/stations?contract=Vilnius&apiKey=174980a157364085f718726daecb380b7aeaf5b4')
http_type(bike)
bike.df <- jsonlite::fromJSON(content(bike, "text"), simplifyVector = TRUE)
bike.df
str(bike.df)
qplot(bike_stands, name, data = bike.df, colour = available_bike_stands)
qplot(bike_stands, name, data = bike.df, colour = available_bikes)
qplot(available_bikes, name, data = bike.df, colour = status)
qplot(available_bikes, name, data = bike.df, colour = available_bike_stands)
str(bike.df)
qplot(available_bikes, name, data = bike.df, colour = status)
bike <- GET('https://api.jcdecaux.com/vls/v1/stations?contract=Santander&apiKey=174980a157364085f718726daecb380b7aeaf5b4')
http_type(bike)
bike.df <- jsonlite::fromJSON(content(bike, "text"), simplifyVector = TRUE)
bike.df
str(bike.df)
qplot(available_bikes, name, data = bike.df, colour = status)
head(bike.df)
bike.df[order(name),]
head(bike.df)
bike.df[order(bike.df$name),]
bike.df <- bike.df[order(bike.df$name),]
qplot(available_bikes, name, data = bike.df, colour = status)
qplot(available_bikes, name, data = bike.df[order(bike.df$name),] , colour = status)
?qplot
qplot(available_bikes, name, data = bike.df , colour = status)
qplot(available_bikes, name, data = bike.df , colour = status, with x = seq_along(y))
qplot(available_bikes, name, data = bike.df , colour = status)
unzip('DublinBus')
unzip('DublinBus.zip')
setwd("C:/Users/Kate/OneDrive/Documents/R/Working with Data/wd_assign1/WWD_Assignment_Oct_2018")
unzip('DublinBus.zip')
trips.read <- read_csv('googletransitdublinbusp20130315-1546\trips.txt')
trips.read <- read_csv('C:\Users\Kate\OneDrive\Documents\R\Working with Data\wd_assign1\WWD_Assignment_Oct_2018\trips.txt')
